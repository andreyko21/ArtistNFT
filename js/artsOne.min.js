/*! For license information please see artsOne.min.js.LICENSE.txt */
!function(){var e={755:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(r,i){"use strict";var s=[],o=Object.getPrototypeOf,a=s.slice,c=s.flat?function(e){return s.flat.call(e)}:function(e){return s.concat.apply([],e)},l=s.push,u=s.indexOf,h={},d=h.toString,f=h.hasOwnProperty,p=f.toString,g=p.call(Object),m={},y=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},_=r.document,w={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,s=(n=n||_).createElement("script");if(s.text=e,t)for(r in w)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&s.setAttribute(r,i);n.head.appendChild(s).parentNode.removeChild(s)}function T(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?h[d.call(e)]||"object":typeof e}var C="3.7.1",E=/HTML$/i,I=function(e,t){return new I.fn.init(e,t)};function S(e){var t=!!e&&"length"in e&&e.length,n=T(e);return!y(e)&&!v(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function k(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}I.fn=I.prototype={jquery:C,constructor:I,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=I.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return I.each(this,e)},map:function(e){return this.pushStack(I.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(I.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(I.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:s.sort,splice:s.splice},I.extend=I.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||y(o)||(o={}),a===c&&(o=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(l&&r&&(I.isPlainObject(r)||(i=Array.isArray(r)))?(n=o[t],s=i&&!Array.isArray(n)?[]:i||I.isPlainObject(n)?n:{},i=!1,o[t]=I.extend(l,s,r)):void 0!==r&&(o[t]=r));return o},I.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==d.call(e)||(t=o(e))&&("function"!=typeof(n=f.call(t,"constructor")&&t.constructor)||p.call(n)!==g))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(S(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r++];)n+=I.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(S(Object(e))?I.merge(n,"string"==typeof e?[e]:e):l.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!E.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,s=e.length,o=!n;i<s;i++)!t(e[i],i)!==o&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,o=[];if(S(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&o.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&o.push(i);return c(o)},guid:1,support:m}),"function"==typeof Symbol&&(I.fn[Symbol.iterator]=s[Symbol.iterator]),I.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){h["[object "+t+"]"]=t.toLowerCase()}));var N=s.pop,x=s.sort,A=s.splice,R="[\\x20\\t\\r\\n\\f]",P=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g");I.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var D=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function O(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}I.escapeSelector=function(e){return(e+"").replace(D,O)};var L=_,M=l;!function(){var e,t,n,i,o,c,l,h,d,p,g=M,y=I.expando,v=0,_=0,w=ee(),b=ee(),T=ee(),C=ee(),E=function(e,t){return e===t&&(o=!0),0},S="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",D="(?:\\\\[\\da-fA-F]{1,6}"+R+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",O="\\["+R+"*("+D+")(?:"+R+"*([*^$|!~]?=)"+R+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+D+"))|)"+R+"*\\]",F=":("+D+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",U=new RegExp(R+"+","g"),j=new RegExp("^"+R+"*,"+R+"*"),V=new RegExp("^"+R+"*([>+~]|"+R+")"+R+"*"),q=new RegExp(R+"|>"),B=new RegExp(F),H=new RegExp("^"+D+"$"),z={ID:new RegExp("^#("+D+")"),CLASS:new RegExp("^\\.("+D+")"),TAG:new RegExp("^("+D+"|[*])"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),bool:new RegExp("^(?:"+S+")$","i"),needsContext:new RegExp("^"+R+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+R+"*((?:-\\d)?\\d*)"+R+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,$=/^h\d$/i,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/[+~]/,Q=new RegExp("\\\\[\\da-fA-F]{1,6}"+R+"?|\\\\([^\\r\\n\\f])","g"),Y=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},X=function(){ce()},J=de((function(e){return!0===e.disabled&&k(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(s=a.call(L.childNodes),L.childNodes),s[L.childNodes.length].nodeType}catch(e){g={apply:function(e,t){M.apply(e,a.call(t))},call:function(e){M.apply(e,a.call(arguments,1))}}}function Z(e,t,n,r){var i,s,o,a,l,u,f,p=t&&t.ownerDocument,v=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==v&&9!==v&&11!==v)return n;if(!r&&(ce(t),t=t||c,h)){if(11!==v&&(l=K.exec(e)))if(i=l[1]){if(9===v){if(!(o=t.getElementById(i)))return n;if(o.id===i)return g.call(n,o),n}else if(p&&(o=p.getElementById(i))&&Z.contains(t,o)&&o.id===i)return g.call(n,o),n}else{if(l[2])return g.apply(n,t.getElementsByTagName(e)),n;if((i=l[3])&&t.getElementsByClassName)return g.apply(n,t.getElementsByClassName(i)),n}if(!(C[e+" "]||d&&d.test(e))){if(f=e,p=t,1===v&&(q.test(e)||V.test(e))){for((p=G.test(e)&&ae(t.parentNode)||t)==t&&m.scope||((a=t.getAttribute("id"))?a=I.escapeSelector(a):t.setAttribute("id",a=y)),s=(u=ue(e)).length;s--;)u[s]=(a?"#"+a:":scope")+" "+he(u[s]);f=u.join(",")}try{return g.apply(n,p.querySelectorAll(f)),n}catch(t){C(e,!0)}finally{a===y&&t.removeAttribute("id")}}}return ve(e.replace(P,"$1"),t,n,r)}function ee(){var e=[];return function n(r,i){return e.push(r+" ")>t.cacheLength&&delete n[e.shift()],n[r+" "]=i}}function te(e){return e[y]=!0,e}function ne(e){var t=c.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function re(e){return function(t){return k(t,"input")&&t.type===e}}function ie(e){return function(t){return(k(t,"input")||k(t,"button"))&&t.type===e}}function se(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&J(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function oe(e){return te((function(t){return t=+t,te((function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function ce(e){var n,r=e?e.ownerDocument||e:L;return r!=c&&9===r.nodeType&&r.documentElement?(l=(c=r).documentElement,h=!I.isXMLDoc(c),p=l.matches||l.webkitMatchesSelector||l.msMatchesSelector,l.msMatchesSelector&&L!=c&&(n=c.defaultView)&&n.top!==n&&n.addEventListener("unload",X),m.getById=ne((function(e){return l.appendChild(e).id=I.expando,!c.getElementsByName||!c.getElementsByName(I.expando).length})),m.disconnectedMatch=ne((function(e){return p.call(e,"*")})),m.scope=ne((function(){return c.querySelectorAll(":scope")})),m.cssHas=ne((function(){try{return c.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),m.getById?(t.filter.ID=function(e){var t=e.replace(Q,Y);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(Q,Y);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n,r,i,s=t.getElementById(e);if(s){if((n=s.getAttributeNode("id"))&&n.value===e)return[s];for(i=t.getElementsByName(e),r=0;s=i[r++];)if((n=s.getAttributeNode("id"))&&n.value===e)return[s]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&h)return t.getElementsByClassName(e)},d=[],ne((function(e){var t;l.appendChild(e).innerHTML="<a id='"+y+"' href='' disabled='disabled'></a><select id='"+y+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+R+"*(?:value|"+S+")"),e.querySelectorAll("[id~="+y+"-]").length||d.push("~="),e.querySelectorAll("a#"+y+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=c.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),l.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=c.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+R+"*name"+R+"*="+R+"*(?:''|\"\")")})),m.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),E=function(e,t){if(e===t)return o=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!m.sortDetached&&t.compareDocumentPosition(e)===n?e===c||e.ownerDocument==L&&Z.contains(L,e)?-1:t===c||t.ownerDocument==L&&Z.contains(L,t)?1:i?u.call(i,e)-u.call(i,t):0:4&n?-1:1)},c):c}for(e in Z.matches=function(e,t){return Z(e,null,null,t)},Z.matchesSelector=function(e,t){if(ce(e),h&&!C[t+" "]&&(!d||!d.test(t)))try{var n=p.call(e,t);if(n||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){C(t,!0)}return Z(t,c,null,[e]).length>0},Z.contains=function(e,t){return(e.ownerDocument||e)!=c&&ce(e),I.contains(e,t)},Z.attr=function(e,n){(e.ownerDocument||e)!=c&&ce(e);var r=t.attrHandle[n.toLowerCase()],i=r&&f.call(t.attrHandle,n.toLowerCase())?r(e,n,!h):void 0;return void 0!==i?i:e.getAttribute(n)},Z.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},I.uniqueSort=function(e){var t,n=[],r=0,s=0;if(o=!m.sortStable,i=!m.sortStable&&a.call(e,0),x.call(e,E),o){for(;t=e[s++];)t===e[s]&&(r=n.push(s));for(;r--;)A.call(e,n[r],1)}return i=null,e},I.fn.uniqueSort=function(){return this.pushStack(I.uniqueSort(a.apply(this)))},t=I.expr={cacheLength:50,createPseudo:te,match:z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Q,Y),e[3]=(e[3]||e[4]||e[5]||"").replace(Q,Y),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Z.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Z.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return z.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&B.test(n)&&(t=ue(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Q,Y).toLowerCase();return"*"===e?function(){return!0}:function(e){return k(e,t)}},CLASS:function(e){var t=w[e+" "];return t||(t=new RegExp("(^|"+R+")"+e+"("+R+"|$)"))&&w(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=Z.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var l,u,h,d,f,p=s!==o?"nextSibling":"previousSibling",g=t.parentNode,m=a&&t.nodeName.toLowerCase(),_=!c&&!a,w=!1;if(g){if(s){for(;p;){for(h=t;h=h[p];)if(a?k(h,m):1===h.nodeType)return!1;f=p="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&_){for(w=(d=(l=(u=g[y]||(g[y]={}))[e]||[])[0]===v&&l[1])&&l[2],h=d&&g.childNodes[d];h=++d&&h&&h[p]||(w=d=0)||f.pop();)if(1===h.nodeType&&++w&&h===t){u[e]=[v,d,w];break}}else if(_&&(w=d=(l=(u=t[y]||(t[y]={}))[e]||[])[0]===v&&l[1]),!1===w)for(;(h=++d&&h&&h[p]||(w=d=0)||f.pop())&&(!(a?k(h,m):1===h.nodeType)||!++w||(_&&((u=h[y]||(h[y]={}))[e]=[v,w]),h!==t)););return(w-=i)===r||w%r==0&&w/r>=0}}},PSEUDO:function(e,n){var r,i=t.pseudos[e]||t.setFilters[e.toLowerCase()]||Z.error("unsupported pseudo: "+e);return i[y]?i(n):i.length>1?(r=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var r,s=i(e,n),o=s.length;o--;)e[r=u.call(e,s[o])]=!(t[r]=s[o])})):function(e){return i(e,0,r)}):i}},pseudos:{not:te((function(e){var t=[],n=[],r=ye(e.replace(P,"$1"));return r[y]?te((function(e,t,n,i){for(var s,o=r(e,null,i,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))})):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return Z(e,t).length>0}})),contains:te((function(e){return e=e.replace(Q,Y),function(t){return(t.textContent||I.text(t)).indexOf(e)>-1}})),lang:te((function(e){return H.test(e||"")||Z.error("unsupported lang: "+e),e=e.replace(Q,Y).toLowerCase(),function(t){var n;do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===l},focus:function(e){return e===function(){try{return c.activeElement}catch(e){}}()&&c.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:se(!1),disabled:se(!0),checked:function(e){return k(e,"input")&&!!e.checked||k(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return $.test(e.nodeName)},input:function(e){return W.test(e.nodeName)},button:function(e){return k(e,"input")&&"button"===e.type||k(e,"button")},text:function(e){var t;return k(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,t){return[t-1]})),eq:oe((function(e,t,n){return[n<0?n+t:n]})),even:oe((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:oe((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:oe((function(e,t,n){var r;for(r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:oe((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=re(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=ie(e);function le(){}function ue(e,n){var r,i,s,o,a,c,l,u=b[e+" "];if(u)return n?0:u.slice(0);for(a=e,c=[],l=t.preFilter;a;){for(o in r&&!(i=j.exec(a))||(i&&(a=a.slice(i[0].length)||a),c.push(s=[])),r=!1,(i=V.exec(a))&&(r=i.shift(),s.push({value:r,type:i[0].replace(P," ")}),a=a.slice(r.length)),t.filter)!(i=z[o].exec(a))||l[o]&&!(i=l[o](i))||(r=i.shift(),s.push({value:r,type:o,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?Z.error(e):b(e,c).slice(0)}function he(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function de(e,t,n){var r=t.dir,i=t.next,s=i||r,o=n&&"parentNode"===s,a=_++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i);return!1}:function(t,n,c){var l,u,h=[v,a];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(u=t[y]||(t[y]={}),i&&k(t,i))t=t[r]||t;else{if((l=u[s])&&l[0]===v&&l[1]===a)return h[2]=l[2];if(u[s]=h,h[2]=e(t,n,c))return!0}return!1}}function fe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function pe(e,t,n,r,i){for(var s,o=[],a=0,c=e.length,l=null!=t;a<c;a++)(s=e[a])&&(n&&!n(s,r,i)||(o.push(s),l&&t.push(a)));return o}function ge(e,t,n,r,i,s){return r&&!r[y]&&(r=ge(r)),i&&!i[y]&&(i=ge(i,s)),te((function(s,o,a,c){var l,h,d,f,p=[],m=[],y=o.length,v=s||function(e,t,n){for(var r=0,i=t.length;r<i;r++)Z(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),_=!e||!s&&t?v:pe(v,p,e,a,c);if(n?n(_,f=i||(s?e:y||r)?[]:o,a,c):f=_,r)for(l=pe(f,m),r(l,[],a,c),h=l.length;h--;)(d=l[h])&&(f[m[h]]=!(_[m[h]]=d));if(s){if(i||e){if(i){for(l=[],h=f.length;h--;)(d=f[h])&&l.push(_[h]=d);i(null,f=[],l,c)}for(h=f.length;h--;)(d=f[h])&&(l=i?u.call(s,d):p[h])>-1&&(s[l]=!(o[l]=d))}}else f=pe(f===o?f.splice(y,f.length):f),i?i(null,o,f,c):g.apply(o,f)}))}function me(e){for(var r,i,s,o=e.length,a=t.relative[e[0].type],c=a||t.relative[" "],l=a?1:0,h=de((function(e){return e===r}),c,!0),d=de((function(e){return u.call(r,e)>-1}),c,!0),f=[function(e,t,i){var s=!a&&(i||t!=n)||((r=t).nodeType?h(e,t,i):d(e,t,i));return r=null,s}];l<o;l++)if(i=t.relative[e[l].type])f=[de(fe(f),i)];else{if((i=t.filter[e[l].type].apply(null,e[l].matches))[y]){for(s=++l;s<o&&!t.relative[e[s].type];s++);return ge(l>1&&fe(f),l>1&&he(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(P,"$1"),i,l<s&&me(e.slice(l,s)),s<o&&me(e=e.slice(s)),s<o&&he(e))}f.push(i)}return fe(f)}function ye(e,r){var i,s=[],o=[],a=T[e+" "];if(!a){for(r||(r=ue(e)),i=r.length;i--;)(a=me(r[i]))[y]?s.push(a):o.push(a);a=T(e,function(e,r){var i=r.length>0,s=e.length>0,o=function(o,a,l,u,d){var f,p,m,y=0,_="0",w=o&&[],b=[],T=n,C=o||s&&t.find.TAG("*",d),E=v+=null==T?1:Math.random()||.1,S=C.length;for(d&&(n=a==c||a||d);_!==S&&null!=(f=C[_]);_++){if(s&&f){for(p=0,a||f.ownerDocument==c||(ce(f),l=!h);m=e[p++];)if(m(f,a||c,l)){g.call(u,f);break}d&&(v=E)}i&&((f=!m&&f)&&y--,o&&w.push(f))}if(y+=_,i&&_!==y){for(p=0;m=r[p++];)m(w,b,a,l);if(o){if(y>0)for(;_--;)w[_]||b[_]||(b[_]=N.call(u));b=pe(b)}g.apply(u,b),d&&!o&&b.length>0&&y+r.length>1&&I.uniqueSort(u)}return d&&(v=E,n=T),w};return i?te(o):o}(o,s)),a.selector=e}return a}function ve(e,n,r,i){var s,o,a,c,l,u="function"==typeof e&&e,d=!i&&ue(e=u.selector||e);if(r=r||[],1===d.length){if((o=d[0]=d[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===n.nodeType&&h&&t.relative[o[1].type]){if(!(n=(t.find.ID(a.matches[0].replace(Q,Y),n)||[])[0]))return r;u&&(n=n.parentNode),e=e.slice(o.shift().value.length)}for(s=z.needsContext.test(e)?0:o.length;s--&&(a=o[s],!t.relative[c=a.type]);)if((l=t.find[c])&&(i=l(a.matches[0].replace(Q,Y),G.test(o[0].type)&&ae(n.parentNode)||n))){if(o.splice(s,1),!(e=i.length&&he(o)))return g.apply(r,i),r;break}}return(u||ye(e,d))(i,n,!h,r,!n||G.test(e)&&ae(n.parentNode)||n),r}le.prototype=t.filters=t.pseudos,t.setFilters=new le,m.sortStable=y.split("").sort(E).join("")===y,ce(),m.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(c.createElement("fieldset"))})),I.find=Z,I.expr[":"]=I.expr.pseudos,I.unique=I.uniqueSort,Z.compile=ye,Z.select=ve,Z.setDocument=ce,Z.tokenize=ue,Z.escape=I.escapeSelector,Z.getText=I.text,Z.isXML=I.isXMLDoc,Z.selectors=I.expr,Z.support=I.support,Z.uniqueSort=I.uniqueSort}();var F=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&I(e).is(n))break;r.push(e)}return r},U=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},j=I.expr.match.needsContext,V=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function q(e,t,n){return y(t)?I.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?I.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?I.grep(e,(function(e){return u.call(t,e)>-1!==n})):I.filter(t,e,n)}I.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?I.find.matchesSelector(r,e)?[r]:[]:I.find.matches(e,I.grep(t,(function(e){return 1===e.nodeType})))},I.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(I(e).filter((function(){for(t=0;t<r;t++)if(I.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)I.find(e,i[t],n);return r>1?I.uniqueSort(n):n},filter:function(e){return this.pushStack(q(this,e||[],!1))},not:function(e){return this.pushStack(q(this,e||[],!0))},is:function(e){return!!q(this,"string"==typeof e&&j.test(e)?I(e):e||[],!1).length}});var B,H=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(I.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||B,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:H.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof I?t[0]:t,I.merge(this,I.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:_,!0)),V.test(r[1])&&I.isPlainObject(t))for(r in t)y(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=_.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):y(e)?void 0!==n.ready?n.ready(e):e(I):I.makeArray(e,this)}).prototype=I.fn,B=I(_);var z=/^(?:parents|prev(?:Until|All))/,W={children:!0,contents:!0,next:!0,prev:!0};function $(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}I.fn.extend({has:function(e){var t=I(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(I.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,s=[],o="string"!=typeof e&&I(e);if(!j.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&I.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?I.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?u.call(I(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(I.uniqueSort(I.merge(this.get(),I(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),I.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return F(e,"parentNode")},parentsUntil:function(e,t,n){return F(e,"parentNode",n)},next:function(e){return $(e,"nextSibling")},prev:function(e){return $(e,"previousSibling")},nextAll:function(e){return F(e,"nextSibling")},prevAll:function(e){return F(e,"previousSibling")},nextUntil:function(e,t,n){return F(e,"nextSibling",n)},prevUntil:function(e,t,n){return F(e,"previousSibling",n)},siblings:function(e){return U((e.parentNode||{}).firstChild,e)},children:function(e){return U(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(k(e,"template")&&(e=e.content||e),I.merge([],e.childNodes))}},(function(e,t){I.fn[e]=function(n,r){var i=I.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=I.filter(r,i)),this.length>1&&(W[e]||I.uniqueSort(i),z.test(e)&&i.reverse()),this.pushStack(i)}}));var K=/[^\x20\t\r\n\f]+/g;function G(e){return e}function Q(e){throw e}function Y(e,t,n,r){var i;try{e&&y(i=e.promise)?i.call(e).done(t).fail(n):e&&y(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}I.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return I.each(e.match(K)||[],(function(e,n){t[n]=!0})),t}(e):I.extend({},e);var t,n,r,i,s=[],o=[],a=-1,c=function(){for(i=i||e.once,r=t=!0;o.length;a=-1)for(n=o.shift();++a<s.length;)!1===s[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=s.length,n=!1);e.memory||(n=!1),t=!1,i&&(s=n?[]:"")},l={add:function(){return s&&(n&&!t&&(a=s.length-1,o.push(n)),function t(n){I.each(n,(function(n,r){y(r)?e.unique&&l.has(r)||s.push(r):r&&r.length&&"string"!==T(r)&&t(r)}))}(arguments),n&&!t&&c()),this},remove:function(){return I.each(arguments,(function(e,t){for(var n;(n=I.inArray(t,s,n))>-1;)s.splice(n,1),n<=a&&a--})),this},has:function(e){return e?I.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return i=o=[],s=n="",this},disabled:function(){return!s},lock:function(){return i=o=[],n||t||(s=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},I.extend({Deferred:function(e){var t=[["notify","progress",I.Callbacks("memory"),I.Callbacks("memory"),2],["resolve","done",I.Callbacks("once memory"),I.Callbacks("once memory"),0,"resolved"],["reject","fail",I.Callbacks("once memory"),I.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return I.Deferred((function(n){I.each(t,(function(t,r){var i=y(e[r[4]])&&e[r[4]];s[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&y(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,i){var s=0;function o(e,t,n,i){return function(){var a=this,c=arguments,l=function(){var r,l;if(!(e<s)){if((r=n.apply(a,c))===t.promise())throw new TypeError("Thenable self-resolution");l=r&&("object"==typeof r||"function"==typeof r)&&r.then,y(l)?i?l.call(r,o(s,t,G,i),o(s,t,Q,i)):(s++,l.call(r,o(s,t,G,i),o(s,t,Q,i),o(s,t,G,t.notifyWith))):(n!==G&&(a=void 0,c=[r]),(i||t.resolveWith)(a,c))}},u=i?l:function(){try{l()}catch(r){I.Deferred.exceptionHook&&I.Deferred.exceptionHook(r,u.error),e+1>=s&&(n!==Q&&(a=void 0,c=[r]),t.rejectWith(a,c))}};e?u():(I.Deferred.getErrorHook?u.error=I.Deferred.getErrorHook():I.Deferred.getStackHook&&(u.error=I.Deferred.getStackHook()),r.setTimeout(u))}}return I.Deferred((function(r){t[0][3].add(o(0,r,y(i)?i:G,r.notifyWith)),t[1][3].add(o(0,r,y(e)?e:G)),t[2][3].add(o(0,r,y(n)?n:Q))})).promise()},promise:function(e){return null!=e?I.extend(e,i):i}},s={};return I.each(t,(function(e,r){var o=r[2],a=r[5];i[r[1]]=o.add,a&&o.add((function(){n=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(r[3].fire),s[r[0]]=function(){return s[r[0]+"With"](this===s?void 0:this,arguments),this},s[r[0]+"With"]=o.fireWith})),i.promise(s),e&&e.call(s,s),s},when:function(e){var t=arguments.length,n=t,r=Array(n),i=a.call(arguments),s=I.Deferred(),o=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?a.call(arguments):n,--t||s.resolveWith(r,i)}};if(t<=1&&(Y(e,s.done(o(n)).resolve,s.reject,!t),"pending"===s.state()||y(i[n]&&i[n].then)))return s.then();for(;n--;)Y(i[n],o(n),s.reject);return s.promise()}});var X=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;I.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&X.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},I.readyException=function(e){r.setTimeout((function(){throw e}))};var J=I.Deferred();function Z(){_.removeEventListener("DOMContentLoaded",Z),r.removeEventListener("load",Z),I.ready()}I.fn.ready=function(e){return J.then(e).catch((function(e){I.readyException(e)})),this},I.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--I.readyWait:I.isReady)||(I.isReady=!0,!0!==e&&--I.readyWait>0||J.resolveWith(_,[I]))}}),I.ready.then=J.then,"complete"===_.readyState||"loading"!==_.readyState&&!_.documentElement.doScroll?r.setTimeout(I.ready):(_.addEventListener("DOMContentLoaded",Z),r.addEventListener("load",Z));var ee=function(e,t,n,r,i,s,o){var a=0,c=e.length,l=null==n;if("object"===T(n))for(a in i=!0,n)ee(e,t,a,n[a],!0,s,o);else if(void 0!==r&&(i=!0,y(r)||(o=!0),l&&(o?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(I(e),n)})),t))for(;a<c;a++)t(e[a],n,o?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):c?t(e[0],n):s},te=/^-ms-/,ne=/-([a-z])/g;function re(e,t){return t.toUpperCase()}function ie(e){return e.replace(te,"ms-").replace(ne,re)}var se=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=I.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},se(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[ie(t)]=n;else for(r in t)i[ie(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ie(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(ie):(t=ie(t))in r?[t]:t.match(K)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||I.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!I.isEmptyObject(t)}};var ae=new oe,ce=new oe,le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ue=/[A-Z]/g;function he(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ue,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:le.test(e)?JSON.parse(e):e)}(n)}catch(e){}ce.set(e,t,n)}else n=void 0;return n}I.extend({hasData:function(e){return ce.hasData(e)||ae.hasData(e)},data:function(e,t,n){return ce.access(e,t,n)},removeData:function(e,t){ce.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),I.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(i=ce.get(s),1===s.nodeType&&!ae.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=ie(r.slice(5)),he(s,r,i[r]));ae.set(s,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){ce.set(this,e)})):ee(this,(function(t){var n;if(s&&void 0===t)return void 0!==(n=ce.get(s,e))||void 0!==(n=he(s,e))?n:void 0;this.each((function(){ce.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){ce.remove(this,e)}))}}),I.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ae.get(e,t),n&&(!r||Array.isArray(n)?r=ae.access(e,t,I.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=I.queue(e,t),r=n.length,i=n.shift(),s=I._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,(function(){I.dequeue(e,t)}),s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:I.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),I.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?I.queue(this[0],e):void 0===t?this:this.each((function(){var n=I.queue(this,e,t);I._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&I.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){I.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=I.Deferred(),s=this,o=this.length,a=function(){--r||i.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=ae.get(s[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var de=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fe=new RegExp("^(?:([+-])=|)("+de+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],ge=_.documentElement,me=function(e){return I.contains(e.ownerDocument,e)},ye={composed:!0};ge.getRootNode&&(me=function(e){return I.contains(e.ownerDocument,e)||e.getRootNode(ye)===e.ownerDocument});var ve=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&me(e)&&"none"===I.css(e,"display")};function _e(e,t,n,r){var i,s,o=20,a=r?function(){return r.cur()}:function(){return I.css(e,t,"")},c=a(),l=n&&n[3]||(I.cssNumber[t]?"":"px"),u=e.nodeType&&(I.cssNumber[t]||"px"!==l&&+c)&&fe.exec(I.css(e,t));if(u&&u[3]!==l){for(c/=2,l=l||u[3],u=+c||1;o--;)I.style(e,t,u+l),(1-s)*(1-(s=a()/c||.5))<=0&&(o=0),u/=s;u*=2,I.style(e,t,u+l),n=n||[]}return n&&(u=+u||+c||0,i=n[1]?u+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=u,r.end=i)),i}var we={};function be(e){var t,n=e.ownerDocument,r=e.nodeName,i=we[r];return i||(t=n.body.appendChild(n.createElement(r)),i=I.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),we[r]=i,i)}function Te(e,t){for(var n,r,i=[],s=0,o=e.length;s<o;s++)(r=e[s]).style&&(n=r.style.display,t?("none"===n&&(i[s]=ae.get(r,"display")||null,i[s]||(r.style.display="")),""===r.style.display&&ve(r)&&(i[s]=be(r))):"none"!==n&&(i[s]="none",ae.set(r,"display",n)));for(s=0;s<o;s++)null!=i[s]&&(e[s].style.display=i[s]);return e}I.fn.extend({show:function(){return Te(this,!0)},hide:function(){return Te(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?I(this).show():I(this).hide()}))}});var Ce,Ee,Ie=/^(?:checkbox|radio)$/i,Se=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ke=/^$|^module$|\/(?:java|ecma)script/i;Ce=_.createDocumentFragment().appendChild(_.createElement("div")),(Ee=_.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),Ce.appendChild(Ee),m.checkClone=Ce.cloneNode(!0).cloneNode(!0).lastChild.checked,Ce.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!Ce.cloneNode(!0).lastChild.defaultValue,Ce.innerHTML="<option></option>",m.option=!!Ce.lastChild;var Ne={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function xe(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&k(e,t)?I.merge([e],n):n}function Ae(e,t){for(var n=0,r=e.length;n<r;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}Ne.tbody=Ne.tfoot=Ne.colgroup=Ne.caption=Ne.thead,Ne.th=Ne.td,m.option||(Ne.optgroup=Ne.option=[1,"<select multiple='multiple'>","</select>"]);var Re=/<|&#?\w+;/;function Pe(e,t,n,r,i){for(var s,o,a,c,l,u,h=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((s=e[f])||0===s)if("object"===T(s))I.merge(d,s.nodeType?[s]:s);else if(Re.test(s)){for(o=o||h.appendChild(t.createElement("div")),a=(Se.exec(s)||["",""])[1].toLowerCase(),c=Ne[a]||Ne._default,o.innerHTML=c[1]+I.htmlPrefilter(s)+c[2],u=c[0];u--;)o=o.lastChild;I.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(t.createTextNode(s));for(h.textContent="",f=0;s=d[f++];)if(r&&I.inArray(s,r)>-1)i&&i.push(s);else if(l=me(s),o=xe(h.appendChild(s),"script"),l&&Ae(o),n)for(u=0;s=o[u++];)ke.test(s.type||"")&&n.push(s);return h}var De=/^([^.]*)(?:\.(.+)|)/;function Oe(){return!0}function Le(){return!1}function Me(e,t,n,r,i,s){var o,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)Me(e,a,n,r,t[a],s);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Le;else if(!i)return e;return 1===s&&(o=i,i=function(e){return I().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=I.guid++)),e.each((function(){I.event.add(this,t,i,r,n)}))}function Fe(e,t,n){n?(ae.set(e,t,!1),I.event.add(e,t,{namespace:!1,handler:function(e){var n,r=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(r)(I.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),ae.set(this,t,r),this[t](),n=ae.get(this,t),ae.set(this,t,!1),r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else r&&(ae.set(this,t,I.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Oe)}})):void 0===ae.get(e,t)&&I.event.add(e,t,Oe)}I.event={global:{},add:function(e,t,n,r,i){var s,o,a,c,l,u,h,d,f,p,g,m=ae.get(e);if(se(e))for(n.handler&&(n=(s=n).handler,i=s.selector),i&&I.find.matchesSelector(ge,i),n.guid||(n.guid=I.guid++),(c=m.events)||(c=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(t){return void 0!==I&&I.event.triggered!==t.type?I.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(K)||[""]).length;l--;)f=g=(a=De.exec(t[l])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=I.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,h=I.event.special[f]||{},u=I.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&I.expr.match.needsContext.test(i),namespace:p.join(".")},s),(d=c[f])||((d=c[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,r,p,o)||e.addEventListener&&e.addEventListener(f,o)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,u):d.push(u),I.event.global[f]=!0)},remove:function(e,t,n,r,i){var s,o,a,c,l,u,h,d,f,p,g,m=ae.hasData(e)&&ae.get(e);if(m&&(c=m.events)){for(l=(t=(t||"").match(K)||[""]).length;l--;)if(f=g=(a=De.exec(t[l])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=I.event.special[f]||{},d=c[f=(r?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)u=d[s],!i&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||r&&r!==u.selector&&("**"!==r||!u.selector)||(d.splice(s,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,m.handle)||I.removeEvent(e,f,m.handle),delete c[f])}else for(f in c)I.event.remove(e,f+t[l],n,r,!0);I.isEmptyObject(c)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,s,o,a=new Array(arguments.length),c=I.event.fix(e),l=(ae.get(this,"events")||Object.create(null))[c.type]||[],u=I.event.special[c.type]||{};for(a[0]=c,t=1;t<arguments.length;t++)a[t]=arguments[t];if(c.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,c)){for(o=I.event.handlers.call(this,c,l),t=0;(i=o[t++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,n=0;(s=i.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==s.namespace&&!c.rnamespace.test(s.namespace)||(c.handleObj=s,c.data=s.data,void 0!==(r=((I.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,a))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,i,s,o,a=[],c=t.delegateCount,l=e.target;if(c&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(s=[],o={},n=0;n<c;n++)void 0===o[i=(r=t[n]).selector+" "]&&(o[i]=r.needsContext?I(i,this).index(l)>-1:I.find(i,this,null,[l]).length),o[i]&&s.push(r);s.length&&a.push({elem:l,handlers:s})}return l=this,c<t.length&&a.push({elem:l,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(I.Event.prototype,e,{enumerable:!0,configurable:!0,get:y(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[I.expando]?e:new I.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Ie.test(t.type)&&t.click&&k(t,"input")&&Fe(t,"click",!0),!1},trigger:function(e){var t=this||e;return Ie.test(t.type)&&t.click&&k(t,"input")&&Fe(t,"click"),!0},_default:function(e){var t=e.target;return Ie.test(t.type)&&t.click&&k(t,"input")&&ae.get(t,"click")||k(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},I.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},I.Event=function(e,t){if(!(this instanceof I.Event))return new I.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Oe:Le,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&I.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[I.expando]=!0},I.Event.prototype={constructor:I.Event,isDefaultPrevented:Le,isPropagationStopped:Le,isImmediatePropagationStopped:Le,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Oe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Oe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Oe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},I.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},I.event.addProp),I.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(_.documentMode){var n=ae.get(this,"handle"),r=I.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,n(e),r.target===r.currentTarget&&n(r)}else I.event.simulate(t,e.target,I.event.fix(e))}I.event.special[e]={setup:function(){var r;if(Fe(this,e,!0),!_.documentMode)return!1;(r=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(r||0)+1)},trigger:function(){return Fe(this,e),!0},teardown:function(){var e;if(!_.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},I.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=_.documentMode?this:r,s=ae.get(i,t);s||(_.documentMode?this.addEventListener(t,n):r.addEventListener(e,n,!0)),ae.set(i,t,(s||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=_.documentMode?this:r,s=ae.get(i,t)-1;s?ae.set(i,t,s):(_.documentMode?this.removeEventListener(t,n):r.removeEventListener(e,n,!0),ae.remove(i,t))}}})),I.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){I.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||I.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}})),I.fn.extend({on:function(e,t,n,r){return Me(this,e,t,n,r)},one:function(e,t,n,r){return Me(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,I(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Le),this.each((function(){I.event.remove(this,e,n,t)}))}});var Ue=/<script|<style|<link/i,je=/checked\s*(?:[^=]|=\s*.checked.)/i,Ve=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function qe(e,t){return k(e,"table")&&k(11!==t.nodeType?t:t.firstChild,"tr")&&I(e).children("tbody")[0]||e}function Be(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function He(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function ze(e,t){var n,r,i,s,o,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(i in ae.remove(t,"handle events"),a)for(n=0,r=a[i].length;n<r;n++)I.event.add(t,i,a[i][n]);ce.hasData(e)&&(s=ce.access(e),o=I.extend({},s),ce.set(t,o))}}function We(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ie.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function $e(e,t,n,r){t=c(t);var i,s,o,a,l,u,h=0,d=e.length,f=d-1,p=t[0],g=y(p);if(g||d>1&&"string"==typeof p&&!m.checkClone&&je.test(p))return e.each((function(i){var s=e.eq(i);g&&(t[0]=p.call(this,i,s.html())),$e(s,t,n,r)}));if(d&&(s=(i=Pe(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(a=(o=I.map(xe(i,"script"),Be)).length;h<d;h++)l=i,h!==f&&(l=I.clone(l,!0,!0),a&&I.merge(o,xe(l,"script"))),n.call(e[h],l,h);if(a)for(u=o[o.length-1].ownerDocument,I.map(o,He),h=0;h<a;h++)l=o[h],ke.test(l.type||"")&&!ae.access(l,"globalEval")&&I.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?I._evalUrl&&!l.noModule&&I._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},u):b(l.textContent.replace(Ve,""),l,u))}return e}function Ke(e,t,n){for(var r,i=t?I.filter(t,e):e,s=0;null!=(r=i[s]);s++)n||1!==r.nodeType||I.cleanData(xe(r)),r.parentNode&&(n&&me(r)&&Ae(xe(r,"script")),r.parentNode.removeChild(r));return e}I.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,s,o,a=e.cloneNode(!0),c=me(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||I.isXMLDoc(e)))for(o=xe(a),r=0,i=(s=xe(e)).length;r<i;r++)We(s[r],o[r]);if(t)if(n)for(s=s||xe(e),o=o||xe(a),r=0,i=s.length;r<i;r++)ze(s[r],o[r]);else ze(e,a);return(o=xe(a,"script")).length>0&&Ae(o,!c&&xe(e,"script")),a},cleanData:function(e){for(var t,n,r,i=I.event.special,s=0;void 0!==(n=e[s]);s++)if(se(n)){if(t=n[ae.expando]){if(t.events)for(r in t.events)i[r]?I.event.remove(n,r):I.removeEvent(n,r,t.handle);n[ae.expando]=void 0}n[ce.expando]&&(n[ce.expando]=void 0)}}}),I.fn.extend({detach:function(e){return Ke(this,e,!0)},remove:function(e){return Ke(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?I.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return $e(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,e).appendChild(e)}))},prepend:function(){return $e(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=qe(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return $e(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return $e(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(I.cleanData(xe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return I.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ue.test(e)&&!Ne[(Se.exec(e)||["",""])[1].toLowerCase()]){e=I.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(I.cleanData(xe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return $e(this,arguments,(function(t){var n=this.parentNode;I.inArray(this,e)<0&&(I.cleanData(xe(this)),n&&n.replaceChild(t,this))}),e)}}),I.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){I.fn[e]=function(e){for(var n,r=[],i=I(e),s=i.length-1,o=0;o<=s;o++)n=o===s?this:this.clone(!0),I(i[o])[t](n),l.apply(r,n.get());return this.pushStack(r)}}));var Ge=new RegExp("^("+de+")(?!px)[a-z%]+$","i"),Qe=/^--/,Ye=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},Xe=function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=s[i];return r},Je=new RegExp(pe.join("|"),"i");function Ze(e,t,n){var r,i,s,o,a=Qe.test(t),c=e.style;return(n=n||Ye(e))&&(o=n.getPropertyValue(t)||n[t],a&&o&&(o=o.replace(P,"$1")||void 0),""!==o||me(e)||(o=I.style(e,t)),!m.pixelBoxStyles()&&Ge.test(o)&&Je.test(t)&&(r=c.width,i=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=o,o=n.width,c.width=r,c.minWidth=i,c.maxWidth=s)),void 0!==o?o+"":o}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ge.appendChild(l).appendChild(u);var e=r.getComputedStyle(u);n="1%"!==e.top,c=12===t(e.marginLeft),u.style.right="60%",o=36===t(e.right),i=36===t(e.width),u.style.position="absolute",s=12===t(u.offsetWidth/3),ge.removeChild(l),u=null}}function t(e){return Math.round(parseFloat(e))}var n,i,s,o,a,c,l=_.createElement("div"),u=_.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,I.extend(m,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,t,n,i;return null==a&&(e=_.createElement("table"),t=_.createElement("tr"),n=_.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",ge.appendChild(e).appendChild(t).appendChild(n),i=r.getComputedStyle(t),a=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,ge.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],nt=_.createElement("div").style,rt={};function it(e){return I.cssProps[e]||rt[e]||(e in nt?e:rt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=tt.length;n--;)if((e=tt[n]+t)in nt)return e}(e)||e)}var st=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function ct(e,t,n){var r=fe.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function lt(e,t,n,r,i,s){var o="width"===t?1:0,a=0,c=0,l=0;if(n===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(l+=I.css(e,n+pe[o],!0,i)),r?("content"===n&&(c-=I.css(e,"padding"+pe[o],!0,i)),"margin"!==n&&(c-=I.css(e,"border"+pe[o]+"Width",!0,i))):(c+=I.css(e,"padding"+pe[o],!0,i),"padding"!==n?c+=I.css(e,"border"+pe[o]+"Width",!0,i):a+=I.css(e,"border"+pe[o]+"Width",!0,i));return!r&&s>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-c-a-.5))||0),c+l}function ut(e,t,n){var r=Ye(e),i=(!m.boxSizingReliable()||n)&&"border-box"===I.css(e,"boxSizing",!1,r),s=i,o=Ze(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ge.test(o)){if(!n)return o;o="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&k(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===I.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===I.css(e,"boxSizing",!1,r),(s=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+lt(e,t,n||(i?"border":"content"),s,r,o)+"px"}function ht(e,t,n,r,i){return new ht.prototype.init(e,t,n,r,i)}I.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,a=ie(t),c=Qe.test(t),l=e.style;if(c||(t=it(a)),o=I.cssHooks[t]||I.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(i=o.get(e,!1,r))?i:l[t];"string"==(s=typeof n)&&(i=fe.exec(n))&&i[1]&&(n=_e(e,t,i),s="number"),null!=n&&n==n&&("number"!==s||c||(n+=i&&i[3]||(I.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(c?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,s,o,a=ie(t);return Qe.test(t)||(t=it(a)),(o=I.cssHooks[t]||I.cssHooks[a])&&"get"in o&&(i=o.get(e,!0,n)),void 0===i&&(i=Ze(e,t,r)),"normal"===i&&t in at&&(i=at[t]),""===n||n?(s=parseFloat(i),!0===n||isFinite(s)?s||0:i):i}}),I.each(["height","width"],(function(e,t){I.cssHooks[t]={get:function(e,n,r){if(n)return!st.test(I.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ut(e,t,r):Xe(e,ot,(function(){return ut(e,t,r)}))},set:function(e,n,r){var i,s=Ye(e),o=!m.scrollboxSize()&&"absolute"===s.position,a=(o||r)&&"border-box"===I.css(e,"boxSizing",!1,s),c=r?lt(e,t,r,a,s):0;return a&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(s[t])-lt(e,t,"border",!1,s)-.5)),c&&(i=fe.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=I.css(e,t)),ct(0,n,c)}}})),I.cssHooks.marginLeft=et(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ze(e,"marginLeft"))||e.getBoundingClientRect().left-Xe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),I.each({margin:"",padding:"",border:"Width"},(function(e,t){I.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+pe[r]+t]=s[r]||s[r-2]||s[0];return i}},"margin"!==e&&(I.cssHooks[e+t].set=ct)})),I.fn.extend({css:function(e,t){return ee(this,(function(e,t,n){var r,i,s={},o=0;if(Array.isArray(t)){for(r=Ye(e),i=t.length;o<i;o++)s[t[o]]=I.css(e,t[o],!1,r);return s}return void 0!==n?I.style(e,t,n):I.css(e,t)}),e,t,arguments.length>1)}}),I.Tween=ht,ht.prototype={constructor:ht,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||I.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(I.cssNumber[n]?"":"px")},cur:function(){var e=ht.propHooks[this.prop];return e&&e.get?e.get(this):ht.propHooks._default.get(this)},run:function(e){var t,n=ht.propHooks[this.prop];return this.options.duration?this.pos=t=I.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ht.propHooks._default.set(this),this}},ht.prototype.init.prototype=ht.prototype,ht.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=I.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){I.fx.step[e.prop]?I.fx.step[e.prop](e):1!==e.elem.nodeType||!I.cssHooks[e.prop]&&null==e.elem.style[it(e.prop)]?e.elem[e.prop]=e.now:I.style(e.elem,e.prop,e.now+e.unit)}}},ht.propHooks.scrollTop=ht.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},I.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},I.fx=ht.prototype.init,I.fx.step={};var dt,ft,pt=/^(?:toggle|show|hide)$/,gt=/queueHooks$/;function mt(){ft&&(!1===_.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(mt):r.setTimeout(mt,I.fx.interval),I.fx.tick())}function yt(){return r.setTimeout((function(){dt=void 0})),dt=Date.now()}function vt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=pe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function _t(e,t,n){for(var r,i=(wt.tweeners[t]||[]).concat(wt.tweeners["*"]),s=0,o=i.length;s<o;s++)if(r=i[s].call(n,t,e))return r}function wt(e,t,n){var r,i,s=0,o=wt.prefilters.length,a=I.Deferred().always((function(){delete c.elem})),c=function(){if(i)return!1;for(var t=dt||yt(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),s=0,o=l.tweens.length;s<o;s++)l.tweens[s].run(r);return a.notifyWith(e,[l,r,n]),r<1&&o?n:(o||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:I.extend({},t),opts:I.extend(!0,{specialEasing:{},easing:I.easing._default},n),originalProperties:t,originalOptions:n,startTime:dt||yt(),duration:n.duration,tweens:[],createTween:function(t,n){var r=I.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),u=l.props;for(function(e,t){var n,r,i,s,o;for(n in e)if(i=t[r=ie(n)],s=e[n],Array.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),(o=I.cssHooks[r])&&"expand"in o)for(n in s=o.expand(s),delete e[r],s)n in e||(e[n]=s[n],t[n]=i);else t[r]=i}(u,l.opts.specialEasing);s<o;s++)if(r=wt.prefilters[s].call(l,e,u,l.opts))return y(r.stop)&&(I._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return I.map(u,_t,l),y(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),I.fx.timer(I.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l}I.Animation=I.extend(wt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return _e(n.elem,e,fe.exec(t),n),n}]},tweener:function(e,t){y(e)?(t=e,e=["*"]):e=e.match(K);for(var n,r=0,i=e.length;r<i;r++)n=e[r],wt.tweeners[n]=wt.tweeners[n]||[],wt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,s,o,a,c,l,u,h="width"in t||"height"in t,d=this,f={},p=e.style,g=e.nodeType&&ve(e),m=ae.get(e,"fxshow");for(r in n.queue||(null==(o=I._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,I.queue(e,"fx").length||o.empty.fire()}))}))),t)if(i=t[r],pt.test(i)){if(delete t[r],s=s||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}f[r]=m&&m[r]||I.style(e,r)}if((c=!I.isEmptyObject(t))||!I.isEmptyObject(f))for(r in h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=m&&m.display)&&(l=ae.get(e,"display")),"none"===(u=I.css(e,"display"))&&(l?u=l:(Te([e],!0),l=e.style.display||l,u=I.css(e,"display"),Te([e]))),("inline"===u||"inline-block"===u&&null!=l)&&"none"===I.css(e,"float")&&(c||(d.done((function(){p.display=l})),null==l&&(u=p.display,l="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),c=!1,f)c||(m?"hidden"in m&&(g=m.hidden):m=ae.access(e,"fxshow",{display:l}),s&&(m.hidden=!g),g&&Te([e],!0),d.done((function(){for(r in g||Te([e]),ae.remove(e,"fxshow"),f)I.style(e,r,f[r])}))),c=_t(g?m[r]:0,r,d),r in m||(m[r]=c.start,g&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?wt.prefilters.unshift(e):wt.prefilters.push(e)}}),I.speed=function(e,t,n){var r=e&&"object"==typeof e?I.extend({},e):{complete:n||!n&&t||y(e)&&e,duration:e,easing:n&&t||t&&!y(t)&&t};return I.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in I.fx.speeds?r.duration=I.fx.speeds[r.duration]:r.duration=I.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){y(r.old)&&r.old.call(this),r.queue&&I.dequeue(this,r.queue)},r},I.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ve).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=I.isEmptyObject(e),s=I.speed(t,n,r),o=function(){var t=wt(this,I.extend({},e),s);(i||ae.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",s=I.timers,o=ae.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&gt.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));!t&&n||I.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=I.timers,o=r?r.length:0;for(n.finish=!0,I.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),I.each(["toggle","show","hide"],(function(e,t){var n=I.fn[t];I.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(vt(t,!0),e,r,i)}})),I.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){I.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),I.timers=[],I.fx.tick=function(){var e,t=0,n=I.timers;for(dt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||I.fx.stop(),dt=void 0},I.fx.timer=function(e){I.timers.push(e),I.fx.start()},I.fx.interval=13,I.fx.start=function(){ft||(ft=!0,mt())},I.fx.stop=function(){ft=null},I.fx.speeds={slow:600,fast:200,_default:400},I.fn.delay=function(e,t){return e=I.fx&&I.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var i=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(i)}}))},function(){var e=_.createElement("input"),t=_.createElement("select").appendChild(_.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=_.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var bt,Tt=I.expr.attrHandle;I.fn.extend({attr:function(e,t){return ee(this,I.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){I.removeAttr(this,e)}))}}),I.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===e.getAttribute?I.prop(e,t,n):(1===s&&I.isXMLDoc(e)||(i=I.attrHooks[t.toLowerCase()]||(I.expr.match.bool.test(t)?bt:void 0)),void 0!==n?null===n?void I.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=I.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&k(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(K);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),bt={set:function(e,t,n){return!1===t?I.removeAttr(e,n):e.setAttribute(n,n),n}},I.each(I.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=Tt[t]||I.find.attr;Tt[t]=function(e,t,r){var i,s,o=t.toLowerCase();return r||(s=Tt[o],Tt[o]=i,i=null!=n(e,t,r)?o:null,Tt[o]=s),i}}));var Ct=/^(?:input|select|textarea|button)$/i,Et=/^(?:a|area)$/i;function It(e){return(e.match(K)||[]).join(" ")}function St(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(K)||[]}I.fn.extend({prop:function(e,t){return ee(this,I.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[I.propFix[e]||e]}))}}),I.extend({prop:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&I.isXMLDoc(e)||(t=I.propFix[t]||t,i=I.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=I.find.attr(e,"tabindex");return t?parseInt(t,10):Ct.test(e.nodeName)||Et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(I.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),I.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){I.propFix[this.toLowerCase()]=this})),I.fn.extend({addClass:function(e){var t,n,r,i,s,o;return y(e)?this.each((function(t){I(this).addClass(e.call(this,t,St(this)))})):(t=kt(e)).length?this.each((function(){if(r=St(this),n=1===this.nodeType&&" "+It(r)+" "){for(s=0;s<t.length;s++)i=t[s],n.indexOf(" "+i+" ")<0&&(n+=i+" ");o=It(n),r!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var t,n,r,i,s,o;return y(e)?this.each((function(t){I(this).removeClass(e.call(this,t,St(this)))})):arguments.length?(t=kt(e)).length?this.each((function(){if(r=St(this),n=1===this.nodeType&&" "+It(r)+" "){for(s=0;s<t.length;s++)for(i=t[s];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");o=It(n),r!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,s,o=typeof e,a="string"===o||Array.isArray(e);return y(e)?this.each((function(n){I(this).toggleClass(e.call(this,n,St(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(n=kt(e),this.each((function(){if(a)for(s=I(this),i=0;i<n.length;i++)r=n[i],s.hasClass(r)?s.removeClass(r):s.addClass(r);else void 0!==e&&"boolean"!==o||((r=St(this))&&ae.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+It(St(n))+" ").indexOf(t)>-1)return!0;return!1}});var Nt=/\r/g;I.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=y(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,I(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=I.map(i,(function(e){return null==e?"":e+""}))),(t=I.valHooks[this.type]||I.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=I.valHooks[i.type]||I.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(Nt,""):null==n?"":n:void 0}}),I.extend({valHooks:{option:{get:function(e){var t=I.find.attr(e,"value");return null!=t?t:It(I.text(e))}},select:{get:function(e){var t,n,r,i=e.options,s=e.selectedIndex,o="select-one"===e.type,a=o?null:[],c=o?s+1:i.length;for(r=s<0?c:o?s:0;r<c;r++)if(((n=i[r]).selected||r===s)&&!n.disabled&&(!n.parentNode.disabled||!k(n.parentNode,"optgroup"))){if(t=I(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,s=I.makeArray(t),o=i.length;o--;)((r=i[o]).selected=I.inArray(I.valHooks.option.get(r),s)>-1)&&(n=!0);return n||(e.selectedIndex=-1),s}}}}),I.each(["radio","checkbox"],(function(){I.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=I.inArray(I(e).val(),t)>-1}},m.checkOn||(I.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var xt=r.location,At={guid:Date.now()},Rt=/\?/;I.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||I.error("Invalid XML: "+(n?I.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Pt=/^(?:focusinfocus|focusoutblur)$/,Dt=function(e){e.stopPropagation()};I.extend(I.event,{trigger:function(e,t,n,i){var s,o,a,c,l,u,h,d,p=[n||_],g=f.call(e,"type")?e.type:e,m=f.call(e,"namespace")?e.namespace.split("."):[];if(o=d=a=n=n||_,3!==n.nodeType&&8!==n.nodeType&&!Pt.test(g+I.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),l=g.indexOf(":")<0&&"on"+g,(e=e[I.expando]?e:new I.Event(g,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:I.makeArray(t,[e]),h=I.event.special[g]||{},i||!h.trigger||!1!==h.trigger.apply(n,t))){if(!i&&!h.noBubble&&!v(n)){for(c=h.delegateType||g,Pt.test(c+g)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||_)&&p.push(a.defaultView||a.parentWindow||r)}for(s=0;(o=p[s++])&&!e.isPropagationStopped();)d=o,e.type=s>1?c:h.bindType||g,(u=(ae.get(o,"events")||Object.create(null))[e.type]&&ae.get(o,"handle"))&&u.apply(o,t),(u=l&&o[l])&&u.apply&&se(o)&&(e.result=u.apply(o,t),!1===e.result&&e.preventDefault());return e.type=g,i||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),t)||!se(n)||l&&y(n[g])&&!v(n)&&((a=n[l])&&(n[l]=null),I.event.triggered=g,e.isPropagationStopped()&&d.addEventListener(g,Dt),n[g](),e.isPropagationStopped()&&d.removeEventListener(g,Dt),I.event.triggered=void 0,a&&(n[l]=a)),e.result}},simulate:function(e,t,n){var r=I.extend(new I.Event,n,{type:e,isSimulated:!0});I.event.trigger(r,null,t)}}),I.fn.extend({trigger:function(e,t){return this.each((function(){I.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return I.event.trigger(e,t,n,!0)}});var Ot=/\[\]$/,Lt=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Ft=/^(?:input|select|textarea|keygen)/i;function Ut(e,t,n,r){var i;if(Array.isArray(t))I.each(t,(function(t,i){n||Ot.test(e)?r(e,i):Ut(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==T(t))r(e,t);else for(i in t)Ut(e+"["+i+"]",t[i],n,r)}I.param=function(e,t){var n,r=[],i=function(e,t){var n=y(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!I.isPlainObject(e))I.each(e,(function(){i(this.name,this.value)}));else for(n in e)Ut(n,e[n],t,i);return r.join("&")},I.fn.extend({serialize:function(){return I.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=I.prop(this,"elements");return e?I.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!I(this).is(":disabled")&&Ft.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!Ie.test(e))})).map((function(e,t){var n=I(this).val();return null==n?null:Array.isArray(n)?I.map(n,(function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}})):{name:t.name,value:n.replace(Lt,"\r\n")}})).get()}});var jt=/%20/g,Vt=/#.*$/,qt=/([?&])_=[^&]*/,Bt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ht=/^(?:GET|HEAD)$/,zt=/^\/\//,Wt={},$t={},Kt="*/".concat("*"),Gt=_.createElement("a");function Qt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(K)||[];if(y(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Yt(e,t,n,r){var i={},s=e===$t;function o(a){var c;return i[a]=!0,I.each(e[a]||[],(function(e,a){var l=a(t,n,r);return"string"!=typeof l||s||i[l]?s?!(c=l):void 0:(t.dataTypes.unshift(l),o(l),!1)})),c}return o(t.dataTypes[0])||!i["*"]&&o("*")}function Xt(e,t){var n,r,i=I.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&I.extend(!0,e,r),e}Gt.href=xt.href,I.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":I.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Xt(Xt(e,I.ajaxSettings),t):Xt(I.ajaxSettings,e)},ajaxPrefilter:Qt(Wt),ajaxTransport:Qt($t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,s,o,a,c,l,u,h,d,f=I.ajaxSetup({},t),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?I(p):I.event,m=I.Deferred(),y=I.Callbacks("once memory"),v=f.statusCode||{},w={},b={},T="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(l){if(!o)for(o={};t=Bt.exec(s);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return l?s:null},setRequestHeader:function(e,t){return null==l&&(e=b[e.toLowerCase()]=b[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==l&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)C.always(e[C.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||T;return n&&n.abort(t),E(0,t),this}};if(m.promise(C),f.url=((e||f.url||xt.href)+"").replace(zt,xt.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(K)||[""],null==f.crossDomain){c=_.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Gt.protocol+"//"+Gt.host!=c.protocol+"//"+c.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=I.param(f.data,f.traditional)),Yt(Wt,f,t,C),l)return C;for(h in(u=I.event&&f.global)&&0==I.active++&&I.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ht.test(f.type),i=f.url.replace(Vt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(jt,"+")):(d=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Rt.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace(qt,"$1"),d=(Rt.test(i)?"&":"?")+"_="+At.guid+++d),f.url=i+d),f.ifModified&&(I.lastModified[i]&&C.setRequestHeader("If-Modified-Since",I.lastModified[i]),I.etag[i]&&C.setRequestHeader("If-None-Match",I.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&C.setRequestHeader("Content-Type",f.contentType),C.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Kt+"; q=0.01":""):f.accepts["*"]),f.headers)C.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,C,f)||l))return C.abort();if(T="abort",y.add(f.complete),C.done(f.success),C.fail(f.error),n=Yt($t,f,t,C)){if(C.readyState=1,u&&g.trigger("ajaxSend",[C,f]),l)return C;f.async&&f.timeout>0&&(a=r.setTimeout((function(){C.abort("timeout")}),f.timeout));try{l=!1,n.send(w,E)}catch(e){if(l)throw e;E(-1,e)}}else E(-1,"No Transport");function E(e,t,o,c){var h,d,_,w,b,T=t;l||(l=!0,a&&r.clearTimeout(a),n=void 0,s=c||"",C.readyState=e>0?4:0,h=e>=200&&e<300||304===e,o&&(w=function(e,t,n){for(var r,i,s,o,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){c.unshift(i);break}if(c[0]in n)s=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==c[0]&&c.unshift(s),n[s]}(f,C,o)),!h&&I.inArray("script",f.dataTypes)>-1&&I.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),w=function(e,t,n,r){var i,s,o,a,c,l={},u=e.dataTypes.slice();if(u[1])for(o in e.converters)l[o.toLowerCase()]=e.converters[o];for(s=u.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=s,s=u.shift())if("*"===s)s=c;else if("*"!==c&&c!==s){if(!(o=l[c+" "+s]||l["* "+s]))for(i in l)if((a=i.split(" "))[1]===s&&(o=l[c+" "+a[0]]||l["* "+a[0]])){!0===o?o=l[i]:!0!==l[i]&&(s=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+s}}}return{state:"success",data:t}}(f,w,C,h),h?(f.ifModified&&((b=C.getResponseHeader("Last-Modified"))&&(I.lastModified[i]=b),(b=C.getResponseHeader("etag"))&&(I.etag[i]=b)),204===e||"HEAD"===f.type?T="nocontent":304===e?T="notmodified":(T=w.state,d=w.data,h=!(_=w.error))):(_=T,!e&&T||(T="error",e<0&&(e=0))),C.status=e,C.statusText=(t||T)+"",h?m.resolveWith(p,[d,T,C]):m.rejectWith(p,[C,T,_]),C.statusCode(v),v=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[C,f,h?d:_]),y.fireWith(p,[C,T]),u&&(g.trigger("ajaxComplete",[C,f]),--I.active||I.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return I.get(e,t,n,"json")},getScript:function(e,t){return I.get(e,void 0,t,"script")}}),I.each(["get","post"],(function(e,t){I[t]=function(e,n,r,i){return y(n)&&(i=i||r,r=n,n=void 0),I.ajax(I.extend({url:e,type:t,dataType:i,data:n,success:r},I.isPlainObject(e)&&e))}})),I.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),I._evalUrl=function(e,t,n){return I.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){I.globalEval(e,t,n)}})},I.fn.extend({wrapAll:function(e){var t;return this[0]&&(y(e)&&(e=e.call(this[0])),t=I(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return y(e)?this.each((function(t){I(this).wrapInner(e.call(this,t))})):this.each((function(){var t=I(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=y(e);return this.each((function(n){I(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){I(this).replaceWith(this.childNodes)})),this}}),I.expr.pseudos.hidden=function(e){return!I.expr.pseudos.visible(e)},I.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},I.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var Jt={0:200,1223:204},Zt=I.ajaxSettings.xhr();m.cors=!!Zt&&"withCredentials"in Zt,m.ajax=Zt=!!Zt,I.ajaxTransport((function(e){var t,n;if(m.cors||Zt&&!e.crossDomain)return{send:function(i,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)a.setRequestHeader(o,i[o]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Jt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&r.setTimeout((function(){t&&n()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),I.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),I.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return I.globalEval(e),e}}}),I.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),I.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=I("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),_.head.appendChild(t[0])},abort:function(){n&&n()}}}));var en,tn=[],nn=/(=)\?(?=&|$)|\?\?/;I.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||I.expando+"_"+At.guid++;return this[e]=!0,e}}),I.ajaxPrefilter("json jsonp",(function(e,t,n){var i,s,o,a=!1!==e.jsonp&&(nn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(nn,"$1"+i):!1!==e.jsonp&&(e.url+=(Rt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||I.error(i+" was not called"),o[0]},e.dataTypes[0]="json",s=r[i],r[i]=function(){o=arguments},n.always((function(){void 0===s?I(r).removeProp(i):r[i]=s,e[i]&&(e.jsonpCallback=t.jsonpCallback,tn.push(i)),o&&y(s)&&s(o[0]),o=s=void 0})),"script"})),m.createHTMLDocument=((en=_.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===en.childNodes.length),I.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=_.implementation.createHTMLDocument("")).createElement("base")).href=_.location.href,t.head.appendChild(r)):t=_),s=!n&&[],(i=V.exec(e))?[t.createElement(i[1])]:(i=Pe([e],t,s),s&&s.length&&I(s).remove(),I.merge([],i.childNodes)));var r,i,s},I.fn.load=function(e,t,n){var r,i,s,o=this,a=e.indexOf(" ");return a>-1&&(r=It(e.slice(a)),e=e.slice(0,a)),y(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),o.length>0&&I.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){s=arguments,o.html(r?I("<div>").append(I.parseHTML(e)).find(r):e)})).always(n&&function(e,t){o.each((function(){n.apply(this,s||[e.responseText,t,e])}))}),this},I.expr.pseudos.animated=function(e){return I.grep(I.timers,(function(t){return e===t.elem})).length},I.offset={setOffset:function(e,t,n){var r,i,s,o,a,c,l=I.css(e,"position"),u=I(e),h={};"static"===l&&(e.style.position="relative"),a=u.offset(),s=I.css(e,"top"),c=I.css(e,"left"),("absolute"===l||"fixed"===l)&&(s+c).indexOf("auto")>-1?(o=(r=u.position()).top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(c)||0),y(t)&&(t=t.call(e,n,I.extend({},a))),null!=t.top&&(h.top=t.top-a.top+o),null!=t.left&&(h.left=t.left-a.left+i),"using"in t?t.using.call(e,h):u.css(h)}},I.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){I.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===I.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===I.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=I(e).offset()).top+=I.css(e,"borderTopWidth",!0),i.left+=I.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-I.css(r,"marginTop",!0),left:t.left-i.left-I.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===I.css(e,"position");)e=e.offsetParent;return e||ge}))}}),I.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;I.fn[e]=function(r){return ee(this,(function(e,r,i){var s;if(v(e)?s=e:9===e.nodeType&&(s=e.defaultView),void 0===i)return s?s[t]:e[r];s?s.scrollTo(n?s.pageXOffset:i,n?i:s.pageYOffset):e[r]=i}),e,r,arguments.length)}})),I.each(["top","left"],(function(e,t){I.cssHooks[t]=et(m.pixelPosition,(function(e,n){if(n)return n=Ze(e,t),Ge.test(n)?I(e).position()[t]+"px":n}))})),I.each({Height:"height",Width:"width"},(function(e,t){I.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){I.fn[r]=function(i,s){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===s?"margin":"border");return ee(this,(function(t,n,i){var s;return v(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===i?I.css(t,n,a):I.style(t,n,i,a)}),t,o?i:void 0,o)}}))})),I.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){I.fn[t]=function(e){return this.on(t,e)}})),I.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),I.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){I.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var rn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;I.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),y(e))return r=a.call(arguments,2),i=function(){return e.apply(t||this,r.concat(a.call(arguments)))},i.guid=e.guid=e.guid||I.guid++,i},I.holdReady=function(e){e?I.readyWait++:I.ready(!0)},I.isArray=Array.isArray,I.parseJSON=JSON.parse,I.nodeName=k,I.isFunction=y,I.isWindow=v,I.camelCase=ie,I.type=T,I.now=Date.now,I.isNumeric=function(e){var t=I.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},I.trim=function(e){return null==e?"":(e+"").replace(rn,"$1")},void 0===(n=function(){return I}.apply(t,[]))||(e.exports=n);var sn=r.jQuery,on=r.$;return I.noConflict=function(e){return r.$===I&&(r.$=on),e&&r.jQuery===I&&(r.jQuery=sn),I},void 0===i&&(r.jQuery=r.$=I),I}))}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=n(755);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(){r=function(){return n};var e,n={},i=Object.prototype,s=i.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof _?t:_,s=Object.create(i.prototype),a=new P(r||[]);return o(s,"_invoke",{value:N(e,n,a)}),s}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",y="completed",v={};function _(){}function w(){}function b(){}var T={};h(T,c,(function(){return this}));var C=Object.getPrototypeOf,E=C&&C(C(D([])));E&&E!==i&&s.call(E,c)&&(T=E);var I=b.prototype=_.prototype=Object.create(T);function S(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,n){function r(i,o,a,c){var l=f(e[i],e,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==t(h)&&s.call(h,"__await")?n.resolve(h.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):n.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(l.arg)}var i;o(this,"_invoke",{value:function(e,t){function s(){return new n((function(n,i){r(e,t,n,i)}))}return i=i?i.then(s,s):s()}})}function N(t,n,r){var i=p;return function(s,o){if(i===m)throw new Error("Generator is already running");if(i===y){if("throw"===s)throw o;return{value:e,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var c=x(a,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var l=f(t,n,r);if("normal"===l.type){if(i=r.done?y:g,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=y,r.method="throw",r.arg=l.arg)}}}function x(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var s=f(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,v;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function D(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,o=function t(){for(;++i<n.length;)if(s.call(n,i))return t.value=n[i],t.done=!1,t;return t.value=e,t.done=!0,t};return o.next=o}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=h(b,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,h(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},S(k.prototype),h(k.prototype,l,(function(){return this})),n.AsyncIterator=k,n.async=function(e,t,r,i,s){void 0===s&&(s=Promise);var o=new k(d(e,t,r,i),s);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(I),h(I,u,"Generator"),h(I,c,(function(){return this})),h(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=D,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),l=s.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},n}function i(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function s(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,s=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===t(s)?s:String(s)),i)}var s}var o=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.dropdown=e(".dropdown"),this.dropdownTrigger=this.dropdown.find(".dropdown__trigger"),this.dropdownContent=this.dropdown.find(".dropdown__content"),this.dropdownItem=this.dropdown.find(".dropdown__item"),this.BindEvents(),this.CheckScreenSize()}var n,o,a,c;return n=t,o=[{key:"BindEvents",value:function(){var t=this;this.dropdownTrigger.on("click",(function(){return t.ToggleDropDown()})),this.dropdownContent.on("click",".dropdown__item",(function(e){return t.SelectItem(e)})),e(window).on("resize",(function(){return t.CheckScreenSize()}))}},{key:"ToggleDropDown",value:function(){this.dropdown.toggleClass("dropdown_open")}},{key:"CheckScreenSize",value:function(){e(window).width()<=400?e(".menu__footer").append(this.dropdown):this.dropdown.insertAfter(".menu")}},{key:"SelectItem",value:(a=r().mark((function t(n){var i,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e(n.target),this.dropdownContent.find(i).remove(),s=this.dropdownTrigger.find(".dropdown__item"),this.dropdownTrigger.find(".dropdown__item").replaceWith(i),this.dropdownContent.append(s),this.ToggleDropDown();case 6:case"end":return t.stop()}}),t,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var s=a.apply(e,t);function o(e){i(s,n,r,o,c,"next",e)}function c(e){i(s,n,r,o,c,"throw",e)}o(void 0)}))},function(e){return c.apply(this,arguments)})}],o&&s(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===a(i)?i:String(i)),r)}var i}var l=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.burgerMenuButton=e(".burger-menu-button"),this.burgerMenu=e(".menu"),this.BindEvents(),this.dropDown=new o}var n,r;return n=t,(r=[{key:"BindEvents",value:function(){var e=this;this.burgerMenuButton.click((function(){return e.ToggleBurgerMenu()}))}},{key:"ToggleBurgerMenu",value:function(){this.burgerMenuButton.toggleClass("burger-menu-button_open"),this.burgerMenu.hasClass("menu_open")?this.burgerMenu.fadeOut(300):this.burgerMenu.fadeIn(300),this.burgerMenu.toggleClass("menu_open")}}])&&c(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();const u=function(e,t){if(!e)throw h(t)},h=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},d=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},f={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(d(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new p;const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class p extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const g=function(e){const t=d(e);return f.encodeByteArray(t,!0)},m=function(e){return g(e).replace(/\./g,"")},y=function(e){try{return f.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function v(e){return _(void 0,e)}function _(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=_(e[n],t[n]));return e}const w=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&y(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},b=e=>{var t,n;return null===(n=null===(t=w())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},T=e=>{const t=b(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},C=()=>{var e;return null===(e=w())||void 0===e?void 0:e.config},E=e=>{var t;return null===(t=w())||void 0===t?void 0:t[`_${e}`]};class I{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function S(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[m(JSON.stringify({alg:"none",type:"JWT"})),m(JSON.stringify(s)),""].join(".")}function k(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function N(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(k())}function x(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class A extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,A.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(P,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new A(r,o,n)}}const P=/\{\$([^}]+)}/g;function D(e){return JSON.parse(e)}function O(e){return JSON.stringify(e)}const L=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=D(y(s[0])||""),n=D(y(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function U(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function j(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function V(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(q(n)&&q(s)){if(!V(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function q(e){return null!==e&&"object"==typeof e}function B(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function H(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function z(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class W{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class ${constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=K),void 0===r.error&&(r.error=K),void 0===r.complete&&(r.complete=K);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function K(){}const G=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Q(e){return e&&e._delegate?e._delegate:e}class Y{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const X="[DEFAULT]";class J{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new I;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:X})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=X){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=X){return this.instances.has(e)}getOptions(e=X){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===X?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=X){return this.component?this.component.multipleInstances?e:X:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Z{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new J(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ee=[];var te,ne;(ne=te||(te={}))[ne.DEBUG=0]="DEBUG",ne[ne.VERBOSE=1]="VERBOSE",ne[ne.INFO=2]="INFO",ne[ne.WARN=3]="WARN",ne[ne.ERROR=4]="ERROR",ne[ne.SILENT=5]="SILENT";const re={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},ie=te.INFO,se={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},oe=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=se[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class ae{constructor(e){this.name=e,this._logLevel=ie,this._logHandler=oe,this._userLogHandler=null,ee.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?re[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...e),this._logHandler(this,te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...e),this._logHandler(this,te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,te.INFO,...e),this._logHandler(this,te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,te.WARN,...e),this._logHandler(this,te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...e),this._logHandler(this,te.ERROR,...e)}}const ce=(e,t)=>t.some((t=>e instanceof t));let le,ue;const he=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=new WeakMap,ge=new WeakMap;let me={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return de.get(e);if("objectStoreNames"===t)return e.objectStoreNames||fe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ve(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function ye(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ue||(ue=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(_e(this),e),ve(he.get(this))}:function(...e){return ve(t.apply(_e(this),e))}:function(e,...n){const r=t.call(_e(this),e,...n);return fe.set(r,e.sort?e.sort():[e]),ve(r)}:(e instanceof IDBTransaction&&function(e){if(de.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));de.set(e,t)}(e),ce(e,le||(le=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,me):e);var t}function ve(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ve(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&he.set(t,e)})).catch((()=>{})),ge.set(t,e),t}(e);if(pe.has(e))return pe.get(e);const t=ye(e);return t!==e&&(pe.set(e,t),ge.set(t,e)),t}const _e=e=>ge.get(e),we=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],Te=new Map;function Ce(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Te.get(t))return Te.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=be.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!we.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return Te.set(t,s),s}var Ee;Ee=me,me={...Ee,get:(e,t,n)=>Ce(e,t)||Ee.get(e,t,n),has:(e,t)=>!!Ce(e,t)||Ee.has(e,t)};class Ie{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Se="@firebase/app",ke="0.9.19",Ne=new ae("@firebase/app"),xe="[DEFAULT]",Ae={[Se]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Re=new Map,Pe=new Map;function De(e,t){try{e.container.addComponent(t)}catch(n){Ne.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Oe(e){const t=e.name;if(Pe.has(t))return Ne.debug(`There were multiple attempts to register component ${t}.`),!1;Pe.set(t,e);for(const t of Re.values())De(t,e);return!0}function Le(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Me=new R("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Fe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Y("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Me.create("app-deleted",{appName:this._name})}}const Ue="10.4.0";function je(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:xe,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Me.create("bad-app-name",{appName:String(i)});if(n||(n=C()),!n)throw Me.create("no-options");const s=Re.get(i);if(s){if(V(n,s.options)&&V(r,s.config))return s;throw Me.create("duplicate-app",{appName:i})}const o=new Z(i);for(const e of Pe.values())o.addComponent(e);const a=new Fe(n,r,o);return Re.set(i,a),a}function Ve(e=xe){const t=Re.get(e);if(!t&&e===xe&&C())return je();if(!t)throw Me.create("no-app",{appName:e});return t}function qe(e,t,n){var r;let i=null!==(r=Ae[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ne.warn(e.join(" "))}Oe(new Y(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Be="firebase-heartbeat-database",He=1,ze="firebase-heartbeat-store";let We=null;function $e(){return We||(We=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=ve(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(ve(o.result),e.oldVersion,e.newVersion,ve(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(Be,He,{upgrade:(e,t)=>{0===t&&e.createObjectStore(ze)}}).catch((e=>{throw Me.create("idb-open",{originalErrorMessage:e.message})}))),We}async function Ke(e,t){try{const n=(await $e()).transaction(ze,"readwrite"),r=n.objectStore(ze);await r.put(t,Ge(e)),await n.done}catch(e){if(e instanceof A)Ne.warn(e.message);else{const t=Me.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});Ne.warn(t.message)}}}function Ge(e){return`${e.name}!${e.options.appId}`}class Qe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Xe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Ye();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Ye(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Je(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Je(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=m(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Ye(){return(new Date).toISOString().substring(0,10)}class Xe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await $e();return await t.transaction(ze).objectStore(ze).get(Ge(e))}catch(e){if(e instanceof A)Ne.warn(e.message);else{const t=Me.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});Ne.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Je(e){return m(JSON.stringify({version:2,heartbeats:e})).length}Oe(new Y("platform-logger",(e=>new Ie(e)),"PRIVATE")),Oe(new Y("heartbeat",(e=>new Qe(e)),"PRIVATE")),qe(Se,ke,""),qe(Se,ke,"esm2017"),qe("fire-js","");var Ze,et="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},tt={},nt=nt||{},rt=et||self;function it(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function st(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var ot="closure_uid_"+(1e9*Math.random()>>>0),at=0;function ct(e,t,n){return e.call.apply(e.bind,arguments)}function lt(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function ut(e,t,n){return(ut=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ct:lt).apply(null,arguments)}function ht(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function dt(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function ft(){this.s=this.s,this.o=this.o}ft.prototype.s=!1,ft.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,ot)&&e[ot]||(e[ot]=++at))},ft.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const pt=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function gt(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function mt(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(it(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function yt(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}yt.prototype.h=function(){this.defaultPrevented=!0};var vt=function(){if(!rt.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{rt.addEventListener("test",(()=>{}),t),rt.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function _t(e){return/^[\s\xa0]*$/.test(e)}function wt(){var e=rt.navigator;return e&&(e=e.userAgent)?e:""}function bt(e){return-1!=wt().indexOf(e)}function Tt(e){return Tt[" "](e),e}Tt[" "]=function(){};var Ct,Et,It,St=bt("Opera"),kt=bt("Trident")||bt("MSIE"),Nt=bt("Edge"),xt=Nt||kt,At=bt("Gecko")&&!(-1!=wt().toLowerCase().indexOf("webkit")&&!bt("Edge"))&&!(bt("Trident")||bt("MSIE"))&&!bt("Edge"),Rt=-1!=wt().toLowerCase().indexOf("webkit")&&!bt("Edge");function Pt(){var e=rt.document;return e?e.documentMode:void 0}e:{var Dt="",Ot=(Et=wt(),At?/rv:([^\);]+)(\)|;)/.exec(Et):Nt?/Edge\/([\d\.]+)/.exec(Et):kt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Et):Rt?/WebKit\/(\S+)/.exec(Et):St?/(?:Version)[ \/]?(\S+)/.exec(Et):void 0);if(Ot&&(Dt=Ot?Ot[1]:""),kt){var Lt=Pt();if(null!=Lt&&Lt>parseFloat(Dt)){Ct=String(Lt);break e}}Ct=Dt}rt.document&&kt?It=Pt()||parseInt(Ct,10)||void 0:It=void 0;var Mt=It;function Ft(e,t){if(yt.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(At){e:{try{Tt(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Ut[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Ft.$.h.call(this)}}dt(Ft,yt);var Ut={2:"touch",3:"pen",4:"mouse"};Ft.prototype.h=function(){Ft.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var jt="closure_listenable_"+(1e6*Math.random()|0),Vt=0;function qt(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Vt,this.fa=this.ia=!1}function Bt(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Ht(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function zt(e){const t={};for(const n in e)t[n]=e[n];return t}const Wt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $t(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<Wt.length;t++)n=Wt[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Kt(e){this.src=e,this.g={},this.h=0}function Gt(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=pt(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Bt(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Qt(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}Kt.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Qt(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new qt(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var Yt="closure_lm_"+(1e6*Math.random()|0),Xt={};function Jt(e,t,n,r,i){if(r&&r.once)return en(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Jt(e,t[s],n,r,i);return null}return n=cn(n),e&&e[jt]?e.O(t,n,st(r)?!!r.capture:!!r,i):Zt(e,t,n,!1,r,i)}function Zt(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=st(i)?!!i.capture:!!i,a=on(e);if(a||(e[Yt]=a=new Kt(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){const e=sn;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)vt||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(rn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function en(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)en(e,t[s],n,r,i);return null}return n=cn(n),e&&e[jt]?e.P(t,n,st(r)?!!r.capture:!!r,i):Zt(e,t,n,!0,r,i)}function tn(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)tn(e,t[s],n,r,i);else r=st(r)?!!r.capture:!!r,n=cn(n),e&&e[jt]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Qt(s=e.g[t],n,r,i))&&(Bt(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=on(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Qt(t,n,r,i)),(n=-1<e?t[e]:null)&&nn(n))}function nn(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[jt])Gt(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(rn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=on(t))?(Gt(n,e),0==n.h&&(n.src=null,t[Yt]=null)):Bt(e)}}}function rn(e){return e in Xt?Xt[e]:Xt[e]="on"+e}function sn(e,t){if(e.fa)e=!0;else{t=new Ft(t,this);var n=e.listener,r=e.la||e.src;e.ia&&nn(e),e=n.call(r,t)}return e}function on(e){return(e=e[Yt])instanceof Kt?e:null}var an="__closure_events_fn_"+(1e9*Math.random()>>>0);function cn(e){return"function"==typeof e?e:(e[an]||(e[an]=function(t){return e.handleEvent(t)}),e[an])}function ln(){ft.call(this),this.i=new Kt(this),this.S=this,this.J=null}function un(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new yt(t,e);else if(t instanceof yt)t.target=t.target||e;else{var i=t;$t(t=new yt(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=hn(o,r,!0,t)&&i}if(i=hn(o=t.g=e,r,!0,t)&&i,i=hn(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=hn(o=t.g=n[s],r,!1,t)&&i}function hn(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Gt(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}dt(ln,ft),ln.prototype[jt]=!0,ln.prototype.removeEventListener=function(e,t,n,r){tn(this,e,t,n,r)},ln.prototype.N=function(){if(ln.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Bt(n[r]);delete t.g[e],t.h--}}this.J=null},ln.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ln.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var dn=rt.JSON.stringify;function fn(){var e=wn;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var pn=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new gn),(e=>e.reset()));class gn{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function mn(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function yn(e){rt.setTimeout((()=>{throw e}),0)}let vn,_n=!1,wn=new class{constructor(){this.h=this.g=null}add(e,t){const n=pn.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},bn=()=>{const e=rt.Promise.resolve(void 0);vn=()=>{e.then(Tn)}};var Tn=()=>{for(var e;e=fn();){try{e.h.call(e.g)}catch(e){yn(e)}var t=pn;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}_n=!1};function Cn(e,t){ln.call(this),this.h=e||1,this.g=t||rt,this.j=ut(this.qb,this),this.l=Date.now()}function En(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function In(e,t,n){if("function"==typeof e)n&&(e=ut(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=ut(e.handleEvent,e)}return 2147483647<Number(t)?-1:rt.setTimeout(e,t||0)}function Sn(e){e.g=In((()=>{e.g=null,e.i&&(e.i=!1,Sn(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}dt(Cn,ln),(Ze=Cn.prototype).ga=!1,Ze.T=null,Ze.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),un(this,"tick"),this.ga&&(En(this),this.start()))}},Ze.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ze.N=function(){Cn.$.N.call(this),En(this),delete this.g};class kn extends ft{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Sn(this)}N(){super.N(),this.g&&(rt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nn(e){ft.call(this),this.h=e,this.g={}}dt(Nn,ft);var xn=[];function An(e,t,n,r){Array.isArray(n)||(n&&(xn[0]=n.toString()),n=xn);for(var i=0;i<n.length;i++){var s=Jt(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Rn(e){Ht(e.g,(function(e,t){this.g.hasOwnProperty(t)&&nn(e)}),e),e.g={}}function Pn(){this.g=!0}function Dn(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return dn(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Nn.prototype.N=function(){Nn.$.N.call(this),Rn(this)},Nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Pn.prototype.Ea=function(){this.g=!1},Pn.prototype.info=function(){};var On={},Ln=null;function Mn(){return Ln=Ln||new ln}function Fn(e){yt.call(this,On.Ta,e)}function Un(e){const t=Mn();un(t,new Fn(t))}function jn(e,t){yt.call(this,On.STAT_EVENT,e),this.stat=t}function Vn(e){const t=Mn();un(t,new jn(t,e))}function qn(e,t){yt.call(this,On.Ua,e),this.size=t}function Bn(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return rt.setTimeout((function(){e()}),t)}On.Ta="serverreachability",dt(Fn,yt),On.STAT_EVENT="statevent",dt(jn,yt),On.Ua="timingevent",dt(qn,yt);var Hn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},zn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Wn(){}function $n(e){return e.h||(e.h=e.i())}function Kn(){}Wn.prototype.h=null;var Gn,Qn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Yn(){yt.call(this,"d")}function Xn(){yt.call(this,"c")}function Jn(){}function Zn(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Nn(this),this.P=tr,e=xt?125:void 0,this.V=new Cn(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new er}function er(){this.i=null,this.g="",this.h=!1}dt(Yn,yt),dt(Xn,yt),dt(Jn,Wn),Jn.prototype.g=function(){return new XMLHttpRequest},Jn.prototype.i=function(){return{}},Gn=new Jn;var tr=45e3,nr={},rr={};function ir(e,t,n){e.L=1,e.v=Cr(vr(t)),e.s=n,e.S=!0,sr(e,null)}function sr(e,t){e.G=Date.now(),lr(e),e.A=vr(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Mr(n.i,"t",r),e.C=0,n=e.l.J,e.h=new er,e.g=Mi(e.l,n?t:null,!e.s),0<e.O&&(e.M=new kn(ut(e.Pa,e,e.g),e.O)),An(e.U,e.g,"readystatechange",e.nb),t=e.I?zt(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Un(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function or(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function ar(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=cr(e,n),r==rr){4==t&&(e.o=4,Vn(14),i=!1),Dn(e.j,e.m,null,"[Incomplete Response]");break}if(r==nr){e.o=4,Vn(15),Dn(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Dn(e.j,e.m,r,null),pr(e,r)}or(e)&&r!=rr&&r!=nr&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Vn(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ni(t),t.M=!0,Vn(11))):(Dn(e.j,e.m,n,"[Invalid Chunked Response]"),fr(e),dr(e))}function cr(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?rr:(n=Number(t.substring(n,r)),isNaN(n)?nr:(r+=1)+n>t.length?rr:(t=t.slice(r,r+n),e.C=r+n,t))}function lr(e){e.Y=Date.now()+e.P,ur(e,e.P)}function ur(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Bn(ut(e.lb,e),t)}function hr(e){e.B&&(rt.clearTimeout(e.B),e.B=null)}function dr(e){0==e.l.H||e.J||Ri(e.l,e)}function fr(e){hr(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,En(e.V),Rn(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function pr(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Hr(n.i,e)))if(!e.K&&Hr(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Ai(n),wi(n)}ki(n),Vn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Bn(ut(n.ib,n),6e3));if(1>=Br(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Di(n,11)}else if((e.K||n.g==e)&&Ai(n),!_t(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const t=l[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=l[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(zr(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Tr(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=Li(r,r.J?r.pa:null,r.Y),o.K){Wr(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(hr(a),lr(a)),r.g=o}else Si(r);0<n.j.length&&Ti(n)}else"stop"!=l[0]&&"close"!=l[0]||Di(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Di(n,7):_i(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Un()}catch(e){}}function gr(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(it(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(it(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(it(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(Ze=Zn.prototype).setTimeout=function(e){this.P=e},Ze.nb=function(e){e=e.target;const t=this.M;t&&3==fi(e)?t.l():this.Pa(e)},Ze.Pa=function(e){try{if(e==this.g)e:{const u=fi(this.g);var t=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||xt||this.g&&(this.h.h||this.g.ja()||pi(this.g)))){this.J||4!=u||7==t||Un(),hr(this);var n=this.g.da();this.ca=n;t:if(or(this)){var r=pi(this.g);e="";var i=r.length,s=4==fi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){fr(this),dr(this);var o="";break t}this.h.i=new rt.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_t(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,Vn(12),fr(this),dr(this);break e}Dn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pr(this,n)}this.S?(ar(this,u,o),xt&&this.i&&3==u&&(An(this.U,this.V,"tick",this.mb),this.V.start())):(Dn(this.j,this.m,o,null),pr(this,o)),4==u&&fr(this),this.i&&!this.J&&(4==u?Ri(this.l,this):(this.i=!1,lr(this)))}else(function(e){const t={};e=(e.g&&2<=fi(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(_t(e[r]))continue;var n=mn(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Vn(12)):(this.o=0,Vn(13)),fr(this),dr(this)}}}catch(e){}},Ze.mb=function(){if(this.g){var e=fi(this.g),t=this.g.ja();this.C<t.length&&(hr(this),ar(this,e,t),this.i&&4!=e&&lr(this))}},Ze.cancel=function(){this.J=!0,fr(this)},Ze.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Un(),Vn(17)),fr(this),this.o=2,dr(this)):ur(this,this.Y-e)};var mr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yr(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof yr){this.h=e.h,_r(this,e.j),this.s=e.s,this.g=e.g,wr(this,e.m),this.l=e.l;var t=e.i,n=new Pr;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),br(this,n),this.o=e.o}else e&&(t=String(e).match(mr))?(this.h=!1,_r(this,t[1]||"",!0),this.s=Er(t[2]||""),this.g=Er(t[3]||"",!0),wr(this,t[4]),this.l=Er(t[5]||"",!0),br(this,t[6]||"",!0),this.o=Er(t[7]||"")):(this.h=!1,this.i=new Pr(null,this.h))}function vr(e){return new yr(e)}function _r(e,t,n){e.j=n?Er(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function wr(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function br(e,t,n){t instanceof Pr?(e.i=t,function(e,t){t&&!e.j&&(Dr(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Or(this,t),Mr(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Ir(t,Ar)),e.i=new Pr(t,e.h))}function Tr(e,t,n){e.i.set(t,n)}function Cr(e){return Tr(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Er(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ir(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Sr),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Sr(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}yr.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ir(t,kr,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ir(t,kr,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ir(n,"/"==n.charAt(0)?xr:Nr,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ir(n,Rr)),e.join("")};var kr=/[#\/\?@]/g,Nr=/[#\?:]/g,xr=/[#\?]/g,Ar=/[#\?@]/g,Rr=/#/g;function Pr(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dr(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Or(e,t){Dr(e),t=Fr(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lr(e,t){return Dr(e),t=Fr(e,t),e.g.has(t)}function Mr(e,t,n){Or(e,t),0<n.length&&(e.i=null,e.g.set(Fr(e,t),gt(n)),e.h+=n.length)}function Fr(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Ze=Pr.prototype).add=function(e,t){Dr(this),this.i=null,e=Fr(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Ze.forEach=function(e,t){Dr(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Ze.ta=function(){Dr(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},Ze.Z=function(e){Dr(this);let t=[];if("string"==typeof e)Lr(this,e)&&(t=t.concat(this.g.get(Fr(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Ze.set=function(e,t){return Dr(this),this.i=null,Lr(this,e=Fr(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Ze.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Ze.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var Ur=class{constructor(e,t){this.g=e,this.map=t}};function jr(e){this.l=e||Vr,e=rt.PerformanceNavigationTiming?0<(e=rt.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(rt.g&&rt.g.Ka&&rt.g.Ka()&&rt.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Vr=10;function qr(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Br(e){return e.h?1:e.g?e.g.size:0}function Hr(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function zr(e,t){e.g?e.g.add(t):e.h=t}function Wr(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function $r(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return gt(e.i)}jr.prototype.cancel=function(){if(this.i=$r(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Kr=class{stringify(e){return rt.JSON.stringify(e,void 0)}parse(e){return rt.JSON.parse(e,void 0)}};function Gr(){this.g=new Kr}function Qr(e,t,n){const r=n||"";try{gr(e,(function(e,n){let i=e;st(e)&&(i=dn(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Yr(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function Xr(e){this.l=e.ec||null,this.j=e.ob||!1}function Jr(e,t){ln.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Zr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}dt(Xr,Wn),Xr.prototype.g=function(){return new Jr(this.l,this.j)},Xr.prototype.i=function(e){return function(){return e}}({}),dt(Jr,ln);var Zr=0;function ei(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function ti(e){e.readyState=4,e.l=null,e.j=null,e.A=null,ni(e)}function ni(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Ze=Jr.prototype).open=function(e,t){if(this.readyState!=Zr)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,ni(this)},Ze.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||rt).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Ze.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ti(this)),this.readyState=Zr},Ze.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,ni(this)),this.g&&(this.readyState=3,ni(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==rt.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ei(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Ze.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ti(this):ni(this),3==this.readyState&&ei(this)}},Ze.Za=function(e){this.g&&(this.response=this.responseText=e,ti(this))},Ze.Ya=function(e){this.g&&(this.response=e,ti(this))},Ze.ka=function(){this.g&&ti(this)},Ze.setRequestHeader=function(e,t){this.v.append(e,t)},Ze.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Ze.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Jr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var ri=rt.JSON.parse;function ii(e){ln.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=si,this.L=this.M=!1}dt(ii,ln);var si="",oi=/^https?$/i,ai=["POST","PUT"];function ci(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,li(e),hi(e)}function li(e){e.F||(e.F=!0,un(e,"complete"),un(e,"error"))}function ui(e){if(e.h&&void 0!==nt&&(!e.C[1]||4!=fi(e)||2!=e.da()))if(e.v&&4==fi(e))In(e.La,0,e);else if(un(e,"readystatechange"),4==fi(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var i=String(e.I).match(mr)[1]||null;!i&&rt.self&&rt.self.location&&(i=rt.self.location.protocol.slice(0,-1)),r=!oi.test(i?i.toLowerCase():"")}n=r}if(n)un(e,"complete"),un(e,"success");else{e.m=6;try{var s=2<fi(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",li(e)}}finally{hi(e)}}}function hi(e,t){if(e.g){di(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||un(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function di(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(rt.clearTimeout(e.A),e.A=null)}function fi(e){return e.g?e.g.readyState:0}function pi(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case si:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function gi(e){let t="";return Ht(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function mi(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=gi(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Tr(e,t,n))}function yi(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function vi(e){this.Ga=0,this.j=[],this.l=new Pn,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=yi("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=yi("baseRetryDelayMs",5e3,e),this.hb=yi("retryDelaySeedMs",1e4,e),this.eb=yi("forwardChannelMaxRetries",2,e),this.xa=yi("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new jr(e&&e.concurrentRequestLimit),this.Ja=new Gr,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function _i(e){if(bi(e),3==e.H){var t=e.W++,n=vr(e.I);if(Tr(n,"SID",e.K),Tr(n,"RID",t),Tr(n,"TYPE","terminate"),Ei(e,n),(t=new Zn(e,e.l,t)).L=2,t.v=Cr(vr(n)),n=!1,rt.navigator&&rt.navigator.sendBeacon)try{n=rt.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&rt.Image&&((new Image).src=t.v,n=!0),n||(t.g=Mi(t.l,null),t.g.ha(t.v)),t.G=Date.now(),lr(t)}Oi(e)}function wi(e){e.g&&(Ni(e),e.g.cancel(),e.g=null)}function bi(e){wi(e),e.u&&(rt.clearTimeout(e.u),e.u=null),Ai(e),e.i.cancel(),e.m&&("number"==typeof e.m&&rt.clearTimeout(e.m),e.m=null)}function Ti(e){if(!qr(e.i)&&!e.m){e.m=!0;var t=e.Na;vn||bn(),_n||(vn(),_n=!0),wn.add(t,e),e.C=0}}function Ci(e,t){var n;n=t?t.m:e.W++;const r=vr(e.I);Tr(r,"SID",e.K),Tr(r,"RID",n),Tr(r,"AID",e.V),Ei(e,r),e.o&&e.s&&mi(r,e.o,e.s),n=new Zn(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Ii(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),zr(e.i,n),ir(n,r,t)}function Ei(e,t){e.na&&Ht(e.na,(function(e,n){Tr(t,n,e)})),e.h&&gr({},(function(e,n){Tr(t,n,e)}))}function Ii(e,t,n){n=Math.min(e.j.length,n);var r=e.h?ut(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Qr(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Si(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;vn||bn(),_n||(vn(),_n=!0),wn.add(t,e),e.A=0}}function ki(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=Bn(ut(e.Ma,e),Pi(e,e.A)),e.A++,0))}function Ni(e){null!=e.B&&(rt.clearTimeout(e.B),e.B=null)}function xi(e){e.g=new Zn(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=vr(e.wa);Tr(t,"RID","rpc"),Tr(t,"SID",e.K),Tr(t,"AID",e.V),Tr(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Tr(t,"TO",e.qa),Tr(t,"TYPE","xmlhttp"),Ei(e,t),e.o&&e.s&&mi(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Cr(vr(t)),n.s=null,n.S=!0,sr(n,e)}function Ai(e){null!=e.v&&(rt.clearTimeout(e.v),e.v=null)}function Ri(e,t){var n=null;if(e.g==t){Ai(e),Ni(e),e.g=null;var r=2}else{if(!Hr(e.i,t))return;n=t.F,Wr(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;un(r=Mn(),new qn(r,n)),Ti(e)}else Si(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(Br(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=Bn(ut(e.Na,e,t),Pi(e,e.C)),e.C++,0)))}(e,t)||2==r&&ki(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Di(e,5);break;case 4:Di(e,10);break;case 3:Di(e,6);break;default:Di(e,2)}}function Pi(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Di(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=ut(e.pb,e);n||(n=new yr("//www.google.com/images/cleardot.gif"),rt.location&&"http"==rt.location.protocol||_r(n,"https"),Cr(n)),function(e,t){const n=new Pn;if(rt.Image){const r=new Image;r.onload=ht(Yr,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ht(Yr,n,r,"TestLoadImage: error",!1,t),r.onabort=ht(Yr,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ht(Yr,n,r,"TestLoadImage: timeout",!1,t),rt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Vn(2);e.H=0,e.h&&e.h.za(t),Oi(e),bi(e)}function Oi(e){if(e.H=0,e.ma=[],e.h){const t=$r(e.i);0==t.length&&0==e.j.length||(mt(e.ma,t),mt(e.ma,e.j),e.i.i.length=0,gt(e.j),e.j.length=0),e.h.ya()}}function Li(e,t,n){var r=n instanceof yr?vr(n):new yr(n);if(""!=r.g)t&&(r.g=t+"."+r.g),wr(r,r.m);else{var i=rt.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new yr(null);r&&_r(s,r),t&&(s.g=t),i&&wr(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&Tr(r,n,t),Tr(r,"VER",e.ra),Ei(e,r),r}function Mi(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new ii(new Xr({ob:!0})):new ii(e.va)).Oa(e.J),t}function Fi(){}function Ui(){if(kt&&!(10<=Number(Mt)))throw Error("Environmental error: no available transport.")}function ji(e,t){ln.call(this),this.g=new vi(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!_t(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!_t(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Bi(this)}function Vi(e){Yn.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function qi(){Xn.call(this),this.status=1}function Bi(e){this.g=e}function Hi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function zi(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function Wi(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(Ze=ii.prototype).Oa=function(e){this.M=e},Ze.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Gn.g(),this.C=this.u?$n(this.u):$n(Gn),this.g.onreadystatechange=ut(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void ci(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=rt.FormData&&e instanceof rt.FormData,!(0<=pt(ai,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{di(this),0<this.B&&((this.L=function(e){return kt&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ut(this.ua,this)):this.A=In(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){ci(this,e)}},Ze.ua=function(){void 0!==nt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,un(this,"timeout"),this.abort(8))},Ze.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,un(this,"complete"),un(this,"abort"),hi(this))},Ze.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hi(this,!0)),ii.$.N.call(this)},Ze.La=function(){this.s||(this.G||this.v||this.l?ui(this):this.kb())},Ze.kb=function(){ui(this)},Ze.isActive=function(){return!!this.g},Ze.da=function(){try{return 2<fi(this)?this.g.status:-1}catch(e){return-1}},Ze.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Ze.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ri(t)}},Ze.Ia=function(){return this.m},Ze.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ze=vi.prototype).ra=8,Ze.H=1,Ze.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Zn(this,this.l,e);let s=this.s;if(this.U&&(s?(s=zt(s),$t(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Ii(this,i,t),Tr(n=vr(this.I),"RID",e),Tr(n,"CVER",22),this.F&&Tr(n,"X-HTTP-Session-Id",this.F),Ei(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(gi(s)))+"&"+t:this.o&&mi(n,this.o,s)),zr(this.i,i),this.bb&&Tr(n,"TYPE","init"),this.P?(Tr(n,"$req",t),Tr(n,"SID","null"),i.aa=!0,ir(i,n,null)):ir(i,n,t),this.H=2}}else 3==this.H&&(e?Ci(this,e):0==this.j.length||qr(this.i)||Ci(this))},Ze.Ma=function(){if(this.u=null,xi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Bn(ut(this.jb,this),e)}},Ze.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Vn(10),wi(this),xi(this))},Ze.ib=function(){null!=this.v&&(this.v=null,wi(this),ki(this),Vn(19))},Ze.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Vn(2)):(this.l.info("Failed to ping google.com"),Vn(1))},Ze.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ze=Fi.prototype).Ba=function(){},Ze.Aa=function(){},Ze.za=function(){},Ze.ya=function(){},Ze.isActive=function(){return!0},Ze.Va=function(){},Ui.prototype.g=function(e,t){return new ji(e,t)},dt(ji,ln),ji.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Vn(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Li(e,null,e.Y),Ti(e)},ji.prototype.close=function(){_i(this.g)},ji.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=dn(e),e=n);t.j.push(new Ur(t.fb++,e)),3==t.H&&Ti(t)},ji.prototype.N=function(){this.g.h=null,delete this.j,_i(this.g),delete this.g,ji.$.N.call(this)},dt(Vi,Yn),dt(qi,Xn),dt(Bi,Fi),Bi.prototype.Ba=function(){un(this.g,"a")},Bi.prototype.Aa=function(e){un(this.g,new Vi(e))},Bi.prototype.za=function(e){un(this.g,new qi)},Bi.prototype.ya=function(){un(this.g,"b")},dt(Hi,(function(){this.blockSize=-1})),Hi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Hi.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)zi(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){zi(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){zi(this,r),i=0;break}}this.h=i,this.i+=t},Hi.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var $i={};function Ki(e){return-128<=e&&128>e?function(e,t){var n=$i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new Wi([0|e],0>e?-1:0)}(e)}(e):new Wi([0|e],0>e?-1:0)}function Gi(e){if(isNaN(e)||!isFinite(e))return Yi;if(0>e)return ts(Gi(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Qi;return new Wi(t,0)}var Qi=4294967296,Yi=Ki(0),Xi=Ki(1),Ji=Ki(16777216);function Zi(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function es(e){return-1==e.h}function ts(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Wi(n,~e.h).add(Xi)}function ns(e,t){return e.add(ts(t))}function rs(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function is(e,t){this.g=e,this.h=t}function ss(e,t){if(Zi(t))throw Error("division by zero");if(Zi(e))return new is(Yi,Yi);if(es(e))return t=ss(ts(e),t),new is(ts(t.g),ts(t.h));if(es(t))return t=ss(e,ts(t)),new is(ts(t.g),t.h);if(30<e.g.length){if(es(e)||es(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Xi,r=t;0>=r.X(e);)n=os(n),r=os(r);var i=as(n,1),s=as(r,1);for(r=as(r,2),n=as(n,2);!Zi(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=as(r,1),n=as(n,1)}return t=ns(e,i.R(t)),new is(i,t)}for(i=Yi;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Gi(n)).R(t);es(o)||0<o.X(e);)o=(s=Gi(n-=r)).R(t);Zi(s)&&(s=Xi),i=i.add(s),e=ns(e,o)}return new is(i,e)}function os(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Wi(n,e.h)}function as(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Wi(i,e.h)}(Ze=Wi.prototype).ea=function(){if(es(this))return-ts(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Qi+r)*t,t*=Qi}return e},Ze.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Zi(this))return"0";if(es(this))return"-"+ts(this).toString(e);for(var t=Gi(Math.pow(e,6)),n=this,r="";;){var i=ss(n,t).g,s=((0<(n=ns(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Zi(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Ze.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Ze.X=function(e){return es(e=ns(this,e))?-1:Zi(e)?0:1},Ze.abs=function(){return es(this)?ts(this):this},Ze.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Wi(n,-2147483648&n[n.length-1]?-1:0)},Ze.R=function(e){if(Zi(this)||Zi(e))return Yi;if(es(this))return es(e)?ts(this).R(ts(e)):ts(ts(this).R(e));if(es(e))return ts(this.R(ts(e)));if(0>this.X(Ji)&&0>e.X(Ji))return Gi(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,c=65535&e.D(i);n[2*r+2*i]+=o*c,rs(n,2*r+2*i),n[2*r+2*i+1]+=s*c,rs(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,rs(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,rs(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Wi(n,0)},Ze.gb=function(e){return ss(this,e).h},Ze.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Wi(n,this.h&e.h)},Ze.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Wi(n,this.h|e.h)},Ze.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Wi(n,this.h^e.h)},Ui.prototype.createWebChannel=Ui.prototype.g,ji.prototype.send=ji.prototype.u,ji.prototype.open=ji.prototype.m,ji.prototype.close=ji.prototype.close,Hn.NO_ERROR=0,Hn.TIMEOUT=8,Hn.HTTP_ERROR=6,zn.COMPLETE="complete",Kn.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",ln.prototype.listen=ln.prototype.O,ii.prototype.listenOnce=ii.prototype.P,ii.prototype.getLastError=ii.prototype.Sa,ii.prototype.getLastErrorCode=ii.prototype.Ia,ii.prototype.getStatus=ii.prototype.da,ii.prototype.getResponseJson=ii.prototype.Wa,ii.prototype.getResponseText=ii.prototype.ja,ii.prototype.send=ii.prototype.ha,ii.prototype.setWithCredentials=ii.prototype.Oa,Hi.prototype.digest=Hi.prototype.l,Hi.prototype.reset=Hi.prototype.reset,Hi.prototype.update=Hi.prototype.j,Wi.prototype.add=Wi.prototype.add,Wi.prototype.multiply=Wi.prototype.R,Wi.prototype.modulo=Wi.prototype.gb,Wi.prototype.compare=Wi.prototype.X,Wi.prototype.toNumber=Wi.prototype.ea,Wi.prototype.toString=Wi.prototype.toString,Wi.prototype.getBits=Wi.prototype.D,Wi.fromNumber=Gi,Wi.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return ts(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Gi(Math.pow(n,8)),i=Yi,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Gi(Math.pow(n,o)),i=i.R(o).add(Gi(a))):i=(i=i.R(r)).add(Gi(a))}return i};var cs=tt.createWebChannelTransport=function(){return new Ui},ls=tt.getStatEventTarget=function(){return Mn()},us=tt.ErrorCode=Hn,hs=tt.EventType=zn,ds=tt.Event=On,fs=tt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ps=(tt.FetchXmlHttpFactory=Xr,tt.WebChannel=Kn),gs=tt.XhrIo=ii,ms=tt.Md5=Hi,ys=tt.Integer=Wi;const vs="@firebase/firestore";class _s{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_s.UNAUTHENTICATED=new _s(null),_s.GOOGLE_CREDENTIALS=new _s("google-credentials-uid"),_s.FIRST_PARTY=new _s("first-party-uid"),_s.MOCK_USER=new _s("mock-user");let ws="10.4.0";const bs=new ae("@firebase/firestore");function Ts(){return bs.logLevel}function Cs(e,...t){if(bs.logLevel<=te.DEBUG){const n=t.map(Ss);bs.debug(`Firestore (${ws}): ${e}`,...n)}}function Es(e,...t){if(bs.logLevel<=te.ERROR){const n=t.map(Ss);bs.error(`Firestore (${ws}): ${e}`,...n)}}function Is(e,...t){if(bs.logLevel<=te.WARN){const n=t.map(Ss);bs.warn(`Firestore (${ws}): ${e}`,...n)}}function Ss(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function ks(e="Unexpected state"){const t=`FIRESTORE (${ws}) INTERNAL ASSERTION FAILED: `+e;throw Es(t),new Error(t)}function Ns(e,t){e||ks()}function xs(e,t){return e}const As={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Rs extends A{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ps{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ds{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Os{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_s.UNAUTHENTICATED)))}shutdown(){}}class Ls{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ms{constructor(e){this.t=e,this.currentUser=_s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Ps;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ps,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Cs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Cs("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ps)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Cs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ns("string"==typeof t.accessToken),new Ds(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ns(null===e||"string"==typeof e),new _s(e)}}class Fs{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=_s.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Us{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Fs(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(_s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class js{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vs{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&Cs("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Cs("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Cs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Cs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Ns("string"==typeof e.token),this.R=e.token,new js(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function qs(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Bs{static V(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=qs(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Hs(e,t){return e<t?-1:e>t?1:0}function zs(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Ws{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Rs(As.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Rs(As.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Rs(As.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Rs(As.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ws.fromMillis(Date.now())}static fromDate(e){return Ws.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ws(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Hs(this.nanoseconds,e.nanoseconds):Hs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class $s{constructor(e){this.timestamp=e}static fromTimestamp(e){return new $s(e)}static min(){return new $s(new Ws(0,0))}static max(){return new $s(new Ws(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ks{constructor(e,t,n){void 0===t?t=0:t>e.length&&ks(),void 0===n?n=e.length-t:n>e.length-t&&ks(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Ks.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ks?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Gs extends Ks{construct(e,t,n){return new Gs(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Rs(As.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Gs(t)}static emptyPath(){return new Gs([])}}const Qs=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ys extends Ks{construct(e,t,n){return new Ys(e,t,n)}static isValidIdentifier(e){return Qs.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ys.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ys(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Rs(As.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Rs(As.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Rs(As.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Rs(As.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ys(t)}static emptyPath(){return new Ys([])}}class Xs{constructor(e){this.path=e}static fromPath(e){return new Xs(Gs.fromString(e))}static fromName(e){return new Xs(Gs.fromString(e).popFirst(5))}static empty(){return new Xs(Gs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Gs.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Gs.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xs(new Gs(e.slice()))}}function Js(e){return new Zs(e.readTime,e.key,-1)}class Zs{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Zs($s.min(),Xs.empty(),-1)}static max(){return new Zs($s.max(),Xs.empty(),-1)}}function eo(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Xs.comparator(e.documentKey,t.documentKey),0!==n?n:Hs(e.largestBatchId,t.largestBatchId))}const to="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class no{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ro(e){if(e.code!==As.FAILED_PRECONDITION||e.message!==to)throw e;Cs("LocalStore","Unexpectedly lost primary lease")}class io{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ks(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new io(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof io?t:io.resolve(t)}catch(e){return io.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):io.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):io.reject(t)}static resolve(e){return new io(((t,n)=>{t(e)}))}static reject(e){return new io(((t,n)=>{n(e)}))}static waitFor(e){return new io(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=io.resolve(!1);for(const n of e)t=t.next((e=>e?io.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new io(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new io(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function so(e){return"IndexedDbTransactionError"===e.name}class oo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}function ao(e){return null==e}function co(e){return 0===e&&1/e==-1/0}oo.ae=-1;function lo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function uo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}class ho{constructor(e,t){this.comparator=e,this.root=t||po.EMPTY}insert(e,t){return new ho(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,po.BLACK,null,null))}remove(e){return new ho(this.comparator,this.root.remove(e,this.comparator).copy(null,null,po.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fo(this.root,e,this.comparator,!1)}getReverseIterator(){return new fo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fo(this.root,e,this.comparator,!0)}}class fo{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class po{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:po.RED,this.left=null!=r?r:po.EMPTY,this.right=null!=i?i:po.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new po(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return po.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return po.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,po.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,po.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ks();if(this.right.isRed())throw ks();const e=this.left.check();if(e!==this.right.check())throw ks();return e+(this.isRed()?0:1)}}po.EMPTY=null,po.RED=!0,po.BLACK=!1,po.EMPTY=new class{constructor(){this.size=0}get key(){throw ks()}get value(){throw ks()}get color(){throw ks()}get left(){throw ks()}get right(){throw ks()}copy(e,t,n,r,i){return this}insert(e,t,n){return new po(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class go{constructor(e){this.comparator=e,this.data=new ho(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mo(this.data.getIterator())}getIteratorFrom(e){return new mo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof go))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new go(this.comparator);return t.data=e,t}}class mo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class yo{constructor(e){this.fields=e,e.sort(Ys.comparator)}static empty(){return new yo([])}unionWith(e){let t=new go(Ys.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new yo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zs(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class vo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _o{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new vo("Invalid base64 string: "+e):e}}(e);return new _o(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new _o(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Hs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_o.EMPTY_BYTE_STRING=new _o("");const wo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(e){if(Ns(!!e),"string"==typeof e){let t=0;const n=wo.exec(e);if(Ns(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:To(e.seconds),nanos:To(e.nanos)}}function To(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Co(e){return"string"==typeof e?_o.fromBase64String(e):_o.fromUint8Array(e)}function Eo(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Io(e){const t=e.mapValue.fields.__previous_value__;return Eo(t)?Io(t):t}function So(e){const t=bo(e.mapValue.fields.__local_write_time__.timestampValue);return new Ws(t.seconds,t.nanos)}class ko{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class No{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new No("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof No&&e.projectId===this.projectId&&e.database===this.database}}const xo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ao(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Eo(e)?4:Ho(e)?9007199254740991:10:ks()}function Ro(e,t){if(e===t)return!0;const n=Ao(e);if(n!==Ao(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return So(e).isEqual(So(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=bo(e.timestampValue),r=bo(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Co(e.bytesValue).isEqual(Co(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return To(e.geoPointValue.latitude)===To(t.geoPointValue.latitude)&&To(e.geoPointValue.longitude)===To(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return To(e.integerValue)===To(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=To(e.doubleValue),r=To(t.doubleValue);return n===r?co(n)===co(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return zs(e.arrayValue.values||[],t.arrayValue.values||[],Ro);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(lo(n)!==lo(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!Ro(n[e],r[e])))return!1;return!0}(e,t);default:return ks()}}function Po(e,t){return void 0!==(e.values||[]).find((e=>Ro(e,t)))}function Do(e,t){if(e===t)return 0;const n=Ao(e),r=Ao(t);if(n!==r)return Hs(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Hs(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=To(e.integerValue||e.doubleValue),r=To(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Oo(e.timestampValue,t.timestampValue);case 4:return Oo(So(e),So(t));case 5:return Hs(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Co(e),r=Co(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=Hs(n[e],r[e]);if(0!==t)return t}return Hs(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Hs(To(e.latitude),To(t.latitude));return 0!==n?n:Hs(To(e.longitude),To(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=Do(n[e],r[e]);if(t)return t}return Hs(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===xo.mapValue&&t===xo.mapValue)return 0;if(e===xo.mapValue)return 1;if(t===xo.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=Hs(r[e],s[e]);if(0!==t)return t;const o=Do(n[r[e]],i[s[e]]);if(0!==o)return o}return Hs(r.length,s.length)}(e.mapValue,t.mapValue);default:throw ks()}}function Oo(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Hs(e,t);const n=bo(e),r=bo(t),i=Hs(n.seconds,r.seconds);return 0!==i?i:Hs(n.nanos,r.nanos)}function Lo(e){return Mo(e)}function Mo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=bo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Co(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Xs.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Mo(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Mo(e.fields[i])}`;return n+"}"}(e.mapValue):ks()}function Fo(e){return!!e&&"integerValue"in e}function Uo(e){return!!e&&"arrayValue"in e}function jo(e){return!!e&&"nullValue"in e}function Vo(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function qo(e){return!!e&&"mapValue"in e}function Bo(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return uo(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Bo(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Bo(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ho(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class zo{constructor(e){this.value=e}static empty(){return new zo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!qo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bo(t)}setAll(e){let t=Ys.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Bo(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());qo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ro(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];qo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){uo(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new zo(Bo(this.value))}}class Wo{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Wo(e,0,$s.min(),$s.min(),$s.min(),zo.empty(),0)}static newFoundDocument(e,t,n,r){return new Wo(e,1,t,$s.min(),n,r,0)}static newNoDocument(e,t){return new Wo(e,2,t,$s.min(),$s.min(),zo.empty(),0)}static newUnknownDocument(e,t){return new Wo(e,3,t,$s.min(),$s.min(),zo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($s.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$s.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Wo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $o{constructor(e,t){this.position=e,this.inclusive=t}}function Ko(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Xs.comparator(Xs.fromName(o.referenceValue),n.key):Do(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Go(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ro(e.position[n],t.position[n]))return!1;return!0}class Qo{constructor(e,t="asc"){this.field=e,this.dir=t}}function Yo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Xo{}class Jo extends Xo{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new sa(e,t,n):"array-contains"===t?new la(e,n):"in"===t?new ua(e,n):"not-in"===t?new ha(e,n):"array-contains-any"===t?new da(e,n):new Jo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new oa(e,n):new aa(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Do(t,this.value)):null!==t&&Ao(this.value)===Ao(t)&&this.matchesComparison(Do(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ks()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Zo extends Xo{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new Zo(e,t)}matches(e){return ea(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le((e=>e.isInequality()));return null!==e?e.field:null}le(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function ea(e){return"and"===e.op}function ta(e){return function(e){for(const t of e.filters)if(t instanceof Zo)return!1;return!0}(e)&&ea(e)}function na(e){if(e instanceof Jo)return e.field.canonicalString()+e.op.toString()+Lo(e.value);if(ta(e))return e.filters.map((e=>na(e))).join(",");{const t=e.filters.map((e=>na(e))).join(",");return`${e.op}(${t})`}}function ra(e,t){return e instanceof Jo?function(e,t){return t instanceof Jo&&e.op===t.op&&e.field.isEqual(t.field)&&Ro(e.value,t.value)}(e,t):e instanceof Zo?function(e,t){return t instanceof Zo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&ra(n,t.filters[r])),!0)}(e,t):void ks()}function ia(e){return e instanceof Jo?function(e){return`${e.field.canonicalString()} ${e.op} ${Lo(e.value)}`}(e):e instanceof Zo?function(e){return e.op.toString()+" {"+e.getFilters().map(ia).join(" ,")+"}"}(e):"Filter"}class sa extends Jo{constructor(e,t,n){super(e,t,n),this.key=Xs.fromName(n.referenceValue)}matches(e){const t=Xs.comparator(e.key,this.key);return this.matchesComparison(t)}}class oa extends Jo{constructor(e,t){super(e,"in",t),this.keys=ca(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class aa extends Jo{constructor(e,t){super(e,"not-in",t),this.keys=ca(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ca(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Xs.fromName(e.referenceValue)))}class la extends Jo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Uo(t)&&Po(t.arrayValue,this.value)}}class ua extends Jo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Po(this.value.arrayValue,t)}}class ha extends Jo{constructor(e,t){super(e,"not-in",t)}matches(e){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Po(this.value.arrayValue,t)}}class da extends Jo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Uo(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Po(this.value.arrayValue,e)))}}class fa{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.he=null}}function pa(e,t=null,n=[],r=[],i=null,s=null,o=null){return new fa(e,t,n,r,i,s,o)}function ga(e){const t=xs(e);if(null===t.he){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>na(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ao(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Lo(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Lo(e))).join(",")),t.he=e}return t.he}function ma(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Yo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ra(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Go(e.startAt,t.startAt)&&Go(e.endAt,t.endAt)}function ya(e){return Xs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class va{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Pe=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function _a(e){return new va(e)}function wa(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ba(e){const t=xs(e);if(null===t.Pe){t.Pe=[];const e=function(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}(t),n=function(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}(t);if(null!==e&&null===n)e.isKeyField()||t.Pe.push(new Qo(e)),t.Pe.push(new Qo(Ys.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.Pe.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.Pe.push(new Qo(Ys.keyField(),e))}}}return t.Pe}function Ta(e){const t=xs(e);return t.Ie||(t.Ie=function(e,t){if("F"===e.limitType)return pa(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Qo(e.field,t)}));const n=e.endAt?new $o(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new $o(e.startAt.position,e.startAt.inclusive):null;return pa(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,ba(e))),t.Ie}function Ca(e,t,n){return new va(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ea(e,t){return ma(Ta(e),Ta(t))&&e.limitType===t.limitType}function Ia(e){return`${ga(Ta(e))}|lt:${e.limitType}`}function Sa(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>ia(e))).join(", ")}]`),ao(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Lo(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Lo(e))).join(",")),`Target(${t})`}(Ta(e))}; limitType=${e.limitType})`}function ka(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Xs.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ba(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ko(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ba(e),t)||e.endAt&&!function(e,t,n){const r=Ko(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ba(e),t))}(e,t)}function Na(e){return(t,n)=>{let r=!1;for(const i of ba(e)){const e=xa(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function xa(e,t,n){const r=e.field.isKeyField()?Xs.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Do(r,i):ks()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ks()}}class Aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){uo(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const Ra=new ho(Xs.comparator);function Pa(){return Ra}const Da=new ho(Xs.comparator);function Oa(...e){let t=Da;for(const n of e)t=t.insert(n.key,n);return t}function La(e){let t=Da;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Ma(){return Ua()}function Fa(){return Ua()}function Ua(){return new Aa((e=>e.toString()),((e,t)=>e.isEqual(t)))}new ho(Xs.comparator);const ja=new go(Xs.comparator);function Va(...e){let t=ja;for(const n of e)t=t.add(n);return t}const qa=new go(Hs);class Ba{constructor(){this._=void 0}}function Ha(e,t,n){return e instanceof Wa?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Eo(t)&&(t=Io(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof $a?Ka(e,t):e instanceof Ga?Qa(e,t):function(e,t){const n=function(e,t){return e instanceof Ya?function(e){return Fo(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}(e,t),r=Xa(n)+Xa(e.Te);return Fo(n)&&Fo(e.Te)?function(e){return{integerValue:""+e}}(r):function(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:co(t)?"-0":t}}(e.serializer,r)}(e,t)}function za(e,t,n){return e instanceof $a?Ka(e,t):e instanceof Ga?Qa(e,t):n}class Wa extends Ba{}class $a extends Ba{constructor(e){super(),this.elements=e}}function Ka(e,t){const n=Ja(t);for(const t of e.elements)n.some((e=>Ro(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Ga extends Ba{constructor(e){super(),this.elements=e}}function Qa(e,t){let n=Ja(t);for(const t of e.elements)n=n.filter((e=>!Ro(e,t)));return{arrayValue:{values:n}}}class Ya extends Ba{constructor(e,t){super(),this.serializer=e,this.Te=t}}function Xa(e){return To(e.integerValue||e.doubleValue)}function Ja(e){return Uo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Za{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Za}static exists(e){return new Za(void 0,e)}static updateTime(e){return new Za(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ec(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class tc{}function nc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new hc(e.key,Za.none()):new oc(e.key,e.data,Za.none());{const n=e.data,r=zo.empty();let i=new go(Ys.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new ac(e.key,r,new yo(i.toArray()),Za.none())}}function rc(e,t,n){e instanceof oc?function(e,t,n){const r=e.value.clone(),i=lc(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ac?function(e,t,n){if(!ec(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=lc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(cc(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ic(e,t,n,r){return e instanceof oc?function(e,t,n,r){if(!ec(e.precondition,t))return n;const i=e.value.clone(),s=uc(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ac?function(e,t,n,r){if(!ec(e.precondition,t))return n;const i=uc(e.fieldTransforms,r,t),s=t.data;return s.setAll(cc(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return ec(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function sc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&zs(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof $a&&t instanceof $a||e instanceof Ga&&t instanceof Ga?zs(e.elements,t.elements,Ro):e instanceof Ya&&t instanceof Ya?Ro(e.Te,t.Te):e instanceof Wa&&t instanceof Wa}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class oc extends tc{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ac extends tc{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function cc(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function lc(e,t,n){const r=new Map;Ns(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,za(o,a,n[i]))}return r}function uc(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ha(e,s,t))}return r}class hc extends tc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&rc(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ic(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ic(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Fa();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=nc(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument($s.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Va())}isEqual(e){return this.batchId===e.batchId&&zs(this.mutations,e.mutations,((e,t)=>sc(e,t)))&&zs(this.baseMutations,e.baseMutations,((e,t)=>sc(e,t)))}}class fc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pc{constructor(e,t){this.count=e,this.unchangedNames=t}}var gc,mc;function yc(e){if(void 0===e)return Es("GRPC error has no .code"),As.UNKNOWN;switch(e){case gc.OK:return As.OK;case gc.CANCELLED:return As.CANCELLED;case gc.UNKNOWN:return As.UNKNOWN;case gc.DEADLINE_EXCEEDED:return As.DEADLINE_EXCEEDED;case gc.RESOURCE_EXHAUSTED:return As.RESOURCE_EXHAUSTED;case gc.INTERNAL:return As.INTERNAL;case gc.UNAVAILABLE:return As.UNAVAILABLE;case gc.UNAUTHENTICATED:return As.UNAUTHENTICATED;case gc.INVALID_ARGUMENT:return As.INVALID_ARGUMENT;case gc.NOT_FOUND:return As.NOT_FOUND;case gc.ALREADY_EXISTS:return As.ALREADY_EXISTS;case gc.PERMISSION_DENIED:return As.PERMISSION_DENIED;case gc.FAILED_PRECONDITION:return As.FAILED_PRECONDITION;case gc.ABORTED:return As.ABORTED;case gc.OUT_OF_RANGE:return As.OUT_OF_RANGE;case gc.UNIMPLEMENTED:return As.UNIMPLEMENTED;case gc.DATA_LOSS:return As.DATA_LOSS;default:return ks()}}(mc=gc||(gc={}))[mc.OK=0]="OK",mc[mc.CANCELLED=1]="CANCELLED",mc[mc.UNKNOWN=2]="UNKNOWN",mc[mc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mc[mc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mc[mc.NOT_FOUND=5]="NOT_FOUND",mc[mc.ALREADY_EXISTS=6]="ALREADY_EXISTS",mc[mc.PERMISSION_DENIED=7]="PERMISSION_DENIED",mc[mc.UNAUTHENTICATED=16]="UNAUTHENTICATED",mc[mc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mc[mc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mc[mc.ABORTED=10]="ABORTED",mc[mc.OUT_OF_RANGE=11]="OUT_OF_RANGE",mc[mc.UNIMPLEMENTED=12]="UNIMPLEMENTED",mc[mc.INTERNAL=13]="INTERNAL",mc[mc.UNAVAILABLE=14]="UNAVAILABLE",mc[mc.DATA_LOSS=15]="DATA_LOSS";const vc=new ys([4294967295,4294967295],0);function _c(e){const t=(new TextEncoder).encode(e),n=new ms;return n.update(t),new Uint8Array(n.digest())}function wc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new ys([n,r],0),new ys([i,s],0)]}class bc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Tc(`Invalid padding: ${t}`);if(n<0)throw new Tc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Tc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Tc(`Invalid padding when bitmap length is 0: ${t}`);this.Ae=8*e.length-t,this.Re=ys.fromNumber(this.Ae)}Ve(e,t,n){let r=e.add(t.multiply(ys.fromNumber(n)));return 1===r.compare(vc)&&(r=new ys([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Re).toNumber()}me(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ae)return!1;const t=_c(e),[n,r]=wc(t);for(let e=0;e<this.hashCount;e++){const t=this.Ve(n,r,e);if(!this.me(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new bc(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ae)return;const t=_c(e),[n,r]=wc(t);for(let e=0;e<this.hashCount;e++){const t=this.Ve(n,r,e);this.fe(t)}}fe(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Tc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Cc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Ec.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Cc($s.min(),r,new ho(Hs),Pa(),Va())}}class Ec{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ec(n,t,Va(),Va(),Va())}}class Ic{constructor(e,t,n,r){this.ge=e,this.removedTargetIds=t,this.key=n,this.pe=r}}class Sc{constructor(e,t){this.targetId=e,this.ye=t}}class kc{constructor(e,t,n=_o.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Nc{constructor(){this.we=0,this.Se=Rc(),this.be=_o.EMPTY_BYTE_STRING,this.De=!1,this.Ce=!0}get current(){return this.De}get resumeToken(){return this.be}get ve(){return 0!==this.we}get Fe(){return this.Ce}Me(e){e.approximateByteSize()>0&&(this.Ce=!0,this.be=e)}xe(){let e=Va(),t=Va(),n=Va();return this.Se.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ks()}})),new Ec(this.be,this.De,e,t,n)}Oe(){this.Ce=!1,this.Se=Rc()}Ne(e,t){this.Ce=!0,this.Se=this.Se.insert(e,t)}Be(e){this.Ce=!0,this.Se=this.Se.remove(e)}Le(){this.we+=1}ke(){this.we-=1}qe(){this.Ce=!0,this.De=!0}}class xc{constructor(e){this.Qe=e,this.Ke=new Map,this.$e=Pa(),this.Ue=Ac(),this.We=new ho(Hs)}Ge(e){for(const t of e.ge)e.pe&&e.pe.isFoundDocument()?this.ze(t,e.pe):this.je(t,e.key,e.pe);for(const t of e.removedTargetIds)this.je(t,e.key,e.pe)}He(e){this.forEachTarget(e,(t=>{const n=this.Je(t);switch(e.state){case 0:this.Ye(t)&&n.Me(e.resumeToken);break;case 1:n.ke(),n.ve||n.Oe(),n.Me(e.resumeToken);break;case 2:n.ke(),n.ve||this.removeTarget(t);break;case 3:this.Ye(t)&&(n.qe(),n.Me(e.resumeToken));break;case 4:this.Ye(t)&&(this.Ze(t),n.Me(e.resumeToken));break;default:ks()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ke.forEach(((e,n)=>{this.Ye(n)&&t(n)}))}Xe(e){const t=e.targetId,n=e.ye.count,r=this.et(t);if(r){const i=r.target;if(ya(i))if(0===n){const e=new Xs(i.path);this.je(t,e,Wo.newNoDocument(e,$s.min()))}else Ns(1===n);else{const r=this.tt(t);if(r!==n){const n=this.nt(e),i=n?this.rt(n,e,r):1;if(0!==i){this.Ze(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(t,e)}}}}}nt(e){const t=e.ye.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Co(n).toUint8Array()}catch(e){if(e instanceof vo)return Is("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new bc(s,r,i)}catch(e){return Is(e instanceof Tc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ae?null:o}rt(e,t,n){return t.ye.count===n-this.ot(e,t.targetId)?0:2}ot(e,t){const n=this.Qe.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Qe.st(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.je(t,n,null),r++)})),r}_t(e){const t=new Map;this.Ke.forEach(((n,r)=>{const i=this.et(r);if(i){if(n.current&&ya(i.target)){const t=new Xs(i.target.path);null!==this.$e.get(t)||this.ut(r,t)||this.je(r,t,Wo.newNoDocument(t,e))}n.Fe&&(t.set(r,n.xe()),n.Oe())}}));let n=Va();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.et(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.$e.forEach(((t,n)=>n.setReadTime(e)));const r=new Cc(e,t,this.We,this.$e,n);return this.$e=Pa(),this.Ue=Ac(),this.We=new ho(Hs),r}ze(e,t){if(!this.Ye(e))return;const n=this.ut(e,t.key)?2:0;this.Je(e).Ne(t.key,n),this.$e=this.$e.insert(t.key,t),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}je(e,t,n){if(!this.Ye(e))return;const r=this.Je(e);this.ut(e,t)?r.Ne(t,1):r.Be(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),n&&(this.$e=this.$e.insert(t,n))}removeTarget(e){this.Ke.delete(e)}tt(e){const t=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Le(e){this.Je(e).Le()}Je(e){let t=this.Ke.get(e);return t||(t=new Nc,this.Ke.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new go(Hs),this.Ue=this.Ue.insert(e,t)),t}Ye(e){const t=null!==this.et(e);return t||Cs("WatchChangeAggregator","Detected inactive target",e),t}et(e){const t=this.Ke.get(e);return t&&t.ve?null:this.Qe.lt(e)}Ze(e){this.Ke.set(e,new Nc),this.Qe.getRemoteKeysForTarget(e).forEach((t=>{this.je(e,t,null)}))}ut(e,t){return this.Qe.getRemoteKeysForTarget(e).has(t)}}function Ac(){return new ho(Xs.comparator)}function Rc(){return new ho(Xs.comparator)}const Pc={asc:"ASCENDING",desc:"DESCENDING"},Dc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oc={and:"AND",or:"OR"};class Lc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mc(e,t){return e.useProto3Json||ao(t)?t:{value:t}}function Fc(e){return Ns(!!e),$s.fromTimestamp(function(e){const t=bo(e);return new Ws(t.seconds,t.nanos)}(e))}function Uc(e){const t=Gs.fromString(e);return Ns(Zc(t)),t}function jc(e,t){const n=Uc(t);if(n.get(1)!==e.databaseId.projectId)throw new Rs(As.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Rs(As.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Xs(Bc(n))}function Vc(e,t){return function(e,t){return function(e){return new Gs(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}(e.databaseId,t)}function qc(e){return new Gs(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Bc(e){return Ns(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Hc(e,t){return{documents:[Vc(e,t.path)]}}function zc(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Vc(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Vc(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return Jc(Zo.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Yc(e.field),direction:Kc(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Mc(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Wc(e){let t=function(e){const t=Uc(e);return 4===t.length?Gs.emptyPath():Bc(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ns(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=$c(e);return t instanceof Zo&&ta(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Qo(Xc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ao(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new $o(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new $o(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new va(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",c,l)}function $c(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Xc(e.unaryFilter.field);return Jo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Xc(e.unaryFilter.field);return Jo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Xc(e.unaryFilter.field);return Jo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Xc(e.unaryFilter.field);return Jo.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ks()}}(e):void 0!==e.fieldFilter?function(e){return Jo.create(Xc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ks()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Zo.create(e.compositeFilter.filters.map((e=>$c(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ks()}}(e.compositeFilter.op))}(e):ks()}function Kc(e){return Pc[e]}function Gc(e){return Dc[e]}function Qc(e){return Oc[e]}function Yc(e){return{fieldPath:e.canonicalString()}}function Xc(e){return Ys.fromServerFormat(e.fieldPath)}function Jc(e){return e instanceof Jo?function(e){if("=="===e.op){if(Vo(e.value))return{unaryFilter:{field:Yc(e.field),op:"IS_NAN"}};if(jo(e.value))return{unaryFilter:{field:Yc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Vo(e.value))return{unaryFilter:{field:Yc(e.field),op:"IS_NOT_NAN"}};if(jo(e.value))return{unaryFilter:{field:Yc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yc(e.field),op:Gc(e.op),value:e.value}}}(e):e instanceof Zo?function(e){const t=e.getFilters().map((e=>Jc(e)));return 1===t.length?t[0]:{compositeFilter:{op:Qc(e.op),filters:t}}}(e):ks()}function Zc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class el{constructor(e,t,n,r,i=$s.min(),s=$s.min(),o=_o.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new el(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new el(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new el(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new el(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class tl{constructor(e){this.ht=e}}function nl(e){const t=Wc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ca(t,t.limit,"L"):t}class rl{constructor(){}dt(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.At(t,5);else if("booleanValue"in e)this.At(t,10),t.Rt(e.booleanValue?1:0);else if("integerValue"in e)this.At(t,15),t.Rt(To(e.integerValue));else if("doubleValue"in e){const n=To(e.doubleValue);isNaN(n)?this.At(t,13):(this.At(t,15),co(n)?t.Rt(0):t.Rt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.At(t,20),"string"==typeof n?t.Vt(n):(t.Vt(`${n.seconds||""}`),t.Rt(n.nanos||0))}else if("stringValue"in e)this.ft(e.stringValue,t),this.gt(t);else if("bytesValue"in e)this.At(t,30),t.yt(Co(e.bytesValue)),this.gt(t);else if("referenceValue"in e)this.wt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.At(t,45),t.Rt(n.latitude||0),t.Rt(n.longitude||0)}else"mapValue"in e?Ho(e)?this.At(t,Number.MAX_SAFE_INTEGER):(this.St(e.mapValue,t),this.gt(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.gt(t)):ks()}ft(e,t){this.At(t,25),this.Dt(e,t)}Dt(e,t){t.Vt(e)}St(e,t){const n=e.fields||{};this.At(t,55);for(const e of Object.keys(n))this.ft(e,t),this.Tt(n[e],t)}bt(e,t){const n=e.values||[];this.At(t,50);for(const e of n)this.Tt(e,t)}wt(e,t){this.At(t,37),Xs.fromName(e).path.forEach((e=>{this.At(t,60),this.Dt(e,t)}))}At(e,t){e.Rt(t)}gt(e){e.Rt(2)}}rl.Ct=new rl;class il{constructor(){this.an=new sl}addToCollectionParentIndex(e,t){return this.an.add(t),io.resolve()}getCollectionParents(e,t){return io.resolve(this.an.getEntries(t))}addFieldIndex(e,t){return io.resolve()}deleteFieldIndex(e,t){return io.resolve()}deleteAllFieldIndexes(e){return io.resolve()}createTargetIndexes(e,t){return io.resolve()}getDocumentsMatchingTarget(e,t){return io.resolve(null)}getIndexType(e,t){return io.resolve(0)}getFieldIndexes(e,t){return io.resolve([])}getNextCollectionGroupToUpdate(e){return io.resolve(null)}getMinOffset(e,t){return io.resolve(Zs.min())}getMinOffsetFromCollectionGroup(e,t){return io.resolve(Zs.min())}updateCollectionGroup(e,t,n){return io.resolve()}updateIndexEntries(e,t){return io.resolve()}}class sl{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new go(Gs.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new go(Gs.comparator)).toArray()}}new Uint8Array(0);class ol{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ol(e,ol.DEFAULT_COLLECTION_PERCENTILE,ol.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ol.DEFAULT_COLLECTION_PERCENTILE=10,ol.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ol.DEFAULT=new ol(41943040,ol.DEFAULT_COLLECTION_PERCENTILE,ol.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ol.DISABLED=new ol(-1,0,0);class al{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Bn(){return new al(0)}static Ln(){return new al(-1)}}class cl{constructor(){this.changes=new Aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?io.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ll{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ul{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&ic(n.mutation,e,yo.empty(),Ws.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Va()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Va()){const r=Ma();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Oa();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Ma();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Va())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Pa();const s=Ua(),o=Ua();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof ac)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),ic(o.mutation,t,o.mutation.getFieldMask(),Ws.now())):s.set(t.key,yo.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new ll(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Ua();let r=new ho(((e,t)=>e-t)),i=Va();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||yo.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Va()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=Fa();c.forEach((e=>{if(!i.has(e)){const r=nc(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,l))}return io.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Xs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):io.resolve(Ma());let o=-1,a=i;return s.next((t=>io.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?io.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Va()))).next((e=>({batchId:o,changes:La(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xs(t)).next((e=>{let t=Oa();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Oa();return this.indexManager.getCollectionParents(e,i).next((o=>io.forEach(o,(o=>{const a=function(e,t){return new va(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Wo.newInvalidDocument(r)))}));let n=Oa();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&ic(s.mutation,r,yo.empty(),Ws.now()),ka(t,r)&&(n=n.insert(e,r))})),n}))}}class hl{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,t){return io.resolve(this.lr.get(t))}saveBundleMetadata(e,t){return this.lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Fc(e.createTime)}}(t)),io.resolve()}getNamedQuery(e,t){return io.resolve(this.hr.get(t))}saveNamedQuery(e,t){return this.hr.set(t.name,function(e){return{name:e.name,query:nl(e.bundledQuery),readTime:Fc(e.readTime)}}(t)),io.resolve()}}class dl{constructor(){this.overlays=new ho(Xs.comparator),this.Pr=new Map}getOverlay(e,t){return io.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ma();return io.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.It(e,t,r)})),io.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Pr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Pr.delete(n)),io.resolve()}getOverlaysForCollection(e,t,n){const r=Ma(),i=t.length+1,s=new Xs(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return io.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new ho(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ma(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ma(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return io.resolve(o)}It(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Pr.get(r.largestBatchId).delete(n.key);this.Pr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new fc(t,n));let i=this.Pr.get(t);void 0===i&&(i=Va(),this.Pr.set(t,i)),this.Pr.set(t,i.add(n.key))}}class fl{constructor(){this.Ir=new go(pl.dr),this.Tr=new go(pl.Er)}isEmpty(){return this.Ir.isEmpty()}addReference(e,t){const n=new pl(e,t);this.Ir=this.Ir.add(n),this.Tr=this.Tr.add(n)}Ar(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Rr(new pl(e,t))}Vr(e,t){e.forEach((e=>this.removeReference(e,t)))}mr(e){const t=new Xs(new Gs([])),n=new pl(t,e),r=new pl(t,e+1),i=[];return this.Tr.forEachInRange([n,r],(e=>{this.Rr(e),i.push(e.key)})),i}gr(){this.Ir.forEach((e=>this.Rr(e)))}Rr(e){this.Ir=this.Ir.delete(e),this.Tr=this.Tr.delete(e)}pr(e){const t=new Xs(new Gs([])),n=new pl(t,e),r=new pl(t,e+1);let i=Va();return this.Tr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new pl(e,0),n=this.Ir.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class pl{constructor(e,t){this.key=e,this.yr=t}static dr(e,t){return Xs.comparator(e.key,t.key)||Hs(e.yr,t.yr)}static Er(e,t){return Hs(e.yr,t.yr)||Xs.comparator(e.key,t.key)}}class gl{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.wr=1,this.Sr=new go(pl.dr)}checkEmpty(e){return io.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new dc(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.Sr=this.Sr.add(new pl(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return io.resolve(s)}lookupMutationBatch(e,t){return io.resolve(this.br(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Dr(n),i=r<0?0:r;return io.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return io.resolve(0===this.mutationQueue.length?-1:this.wr-1)}getAllMutationBatches(e){return io.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new pl(t,0),r=new pl(t,Number.POSITIVE_INFINITY),i=[];return this.Sr.forEachInRange([n,r],(e=>{const t=this.br(e.yr);i.push(t)})),io.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new go(Hs);return t.forEach((e=>{const t=new pl(e,0),r=new pl(e,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([t,r],(e=>{n=n.add(e.yr)}))})),io.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Xs.isDocumentKey(i)||(i=i.child(""));const s=new pl(new Xs(i),0);let o=new go(Hs);return this.Sr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.yr)),!0)}),s),io.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach((e=>{const n=this.br(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Ns(0===this.vr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Sr;return io.forEach(t.mutations,(r=>{const i=new pl(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Sr=n}))}xn(e){}containsKey(e,t){const n=new pl(t,0),r=this.Sr.firstAfterOrEqual(n);return io.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,io.resolve()}vr(e,t){return this.Dr(e)}Dr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}br(e){const t=this.Dr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ml{constructor(e){this.Fr=e,this.docs=new ho(Xs.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Fr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return io.resolve(n?n.document.mutableCopy():Wo.newInvalidDocument(t))}getEntries(e,t){let n=Pa();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Wo.newInvalidDocument(e))})),io.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Pa();const s=t.path,o=new Xs(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||eo(Js(o),n)<=0||(r.has(o.key)||ka(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return io.resolve(i)}getAllFromCollectionGroup(e,t,n,r){ks()}Mr(e,t){return io.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new yl(this)}getSize(e){return io.resolve(this.size)}}class yl extends cl{constructor(e){super(),this.ur=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ur.addEntry(e,r)):this.ur.removeEntry(n)})),io.waitFor(t)}getFromCache(e,t){return this.ur.getEntry(e,t)}getAllFromCache(e,t){return this.ur.getEntries(e,t)}}class vl{constructor(e){this.persistence=e,this.Or=new Aa((e=>ga(e)),ma),this.lastRemoteSnapshotVersion=$s.min(),this.highestTargetId=0,this.Nr=0,this.Br=new fl,this.targetCount=0,this.Lr=al.Bn()}forEachTarget(e,t){return this.Or.forEach(((e,n)=>t(n))),io.resolve()}getLastRemoteSnapshotVersion(e){return io.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return io.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),io.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Nr&&(this.Nr=t),io.resolve()}Qn(e){this.Or.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new al(t),this.highestTargetId=t),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,t){return this.Qn(t),this.targetCount+=1,io.resolve()}updateTargetData(e,t){return this.Qn(t),io.resolve()}removeTargetData(e,t){return this.Or.delete(t.target),this.Br.mr(t.targetId),this.targetCount-=1,io.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Or.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Or.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),io.waitFor(i).next((()=>r))}getTargetCount(e){return io.resolve(this.targetCount)}getTargetData(e,t){const n=this.Or.get(t)||null;return io.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Ar(t,n),io.resolve()}removeMatchingKeys(e,t,n){this.Br.Vr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),io.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.mr(t),io.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.pr(t);return io.resolve(n)}containsKey(e,t){return io.resolve(this.Br.containsKey(t))}}class _l{constructor(e,t){this.kr={},this.overlays={},this.qr=new oo(0),this.Qr=!1,this.Qr=!0,this.referenceDelegate=e(this),this.Kr=new vl(this),this.indexManager=new il,this.remoteDocumentCache=function(e){return new ml(e)}((e=>this.referenceDelegate.$r(e))),this.serializer=new tl(t),this.Ur=new hl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.kr[e.toKey()];return n||(n=new gl(t,this.referenceDelegate),this.kr[e.toKey()]=n),n}getTargetCache(){return this.Kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ur}runTransaction(e,t,n){Cs("MemoryPersistence","Starting transaction:",e);const r=new wl(this.qr.next());return this.referenceDelegate.Wr(),n(r).next((e=>this.referenceDelegate.Gr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}zr(e,t){return io.or(Object.values(this.kr).map((n=>()=>n.containsKey(e,t))))}}class wl extends no{constructor(e){super(),this.currentSequenceNumber=e}}class bl{constructor(e){this.persistence=e,this.jr=new fl,this.Hr=null}static Jr(e){return new bl(e)}get Yr(){if(this.Hr)return this.Hr;throw ks()}addReference(e,t,n){return this.jr.addReference(n,t),this.Yr.delete(n.toString()),io.resolve()}removeReference(e,t,n){return this.jr.removeReference(n,t),this.Yr.add(n.toString()),io.resolve()}markPotentiallyOrphaned(e,t){return this.Yr.add(t.toString()),io.resolve()}removeTarget(e,t){this.jr.mr(t.targetId).forEach((e=>this.Yr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Yr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Wr(){this.Hr=new Set}Gr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return io.forEach(this.Yr,(n=>{const r=Xs.fromPath(n);return this.Zr(e,r).next((e=>{e||t.removeEntry(r,$s.min())}))})).next((()=>(this.Hr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Zr(e,t).next((e=>{e?this.Yr.delete(t.toString()):this.Yr.add(t.toString())}))}$r(e){return 0}Zr(e,t){return io.or([()=>io.resolve(this.jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.zr(e,t)])}}class Tl{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Qi=n,this.Ki=r}static $i(e,t){let n=Va(),r=Va();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Tl(e,t.fromCache,n,r)}}class Cl{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class El{constructor(){this.Ui=!1,this.Wi=!1,this.Gi=100,this.zi=8}initialize(e,t){this.ji=e,this.indexManager=t,this.Ui=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Hi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Ji(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Cl;return this.Yi(e,t,n).next((r=>{if(i.result=r,this.Wi)return this.Zi(e,t,n,r.size)}))})).next((()=>i.result))}Zi(e,t,n,r){return n.documentReadCount<this.Gi?(Ts()<=te.DEBUG&&Cs("QueryEngine","SDK will not create cache indexes for query:",Sa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Gi,"documents"),io.resolve()):(Ts()<=te.DEBUG&&Cs("QueryEngine","Query:",Sa(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.zi*r?(Ts()<=te.DEBUG&&Cs("QueryEngine","The SDK decides to create cache indexes for query:",Sa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ta(t))):io.resolve())}Hi(e,t){if(wa(t))return io.resolve(null);let n=Ta(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Ca(t,null,"F"),n=Ta(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Va(...r);return this.ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Xi(t,r);return this.es(t,s,i,n.readTime)?this.Hi(e,Ca(t,null,"F")):this.ts(e,s,t,n)}))))})))))}Ji(e,t,n,r){return wa(t)||r.isEqual($s.min())?io.resolve(null):this.ji.getDocuments(e,n).next((i=>{const s=this.Xi(t,i);return this.es(t,s,n,r)?io.resolve(null):(Ts()<=te.DEBUG&&Cs("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Sa(t)),this.ts(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=$s.fromTimestamp(1e9===r?new Ws(n+1,0):new Ws(n,r));return new Zs(i,Xs.empty(),t)}(r,-1)).next((e=>e)))}))}Xi(e,t){let n=new go(Na(e));return t.forEach(((t,r)=>{ka(e,r)&&(n=n.add(r))})),n}es(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Yi(e,t,n){return Ts()<=te.DEBUG&&Cs("QueryEngine","Using full collection scan to execute query:",Sa(t)),this.ji.getDocumentsMatchingQuery(e,t,Zs.min(),n)}ts(e,t,n,r){return this.ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Il{constructor(e,t,n,r){this.persistence=e,this.ns=t,this.serializer=r,this.rs=new ho(Hs),this.ss=new Aa((e=>ga(e)),ma),this.os=new Map,this._s=e.getRemoteDocumentCache(),this.Kr=e.getTargetCache(),this.Ur=e.getBundleCache(),this.us(n)}us(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ul(this._s,this.mutationQueue,this.documentOverlayCache,this.indexManager),this._s.setIndexManager(this.indexManager),this.ns.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.rs)))}}async function Sl(e,t){const n=xs(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.us(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Va();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({cs:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function kl(e){const t=xs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Kr.getLastRemoteSnapshotVersion(e)))}async function Nl(e,t,n){const r=xs(e),i=r.rs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!so(e))throw e;Cs("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.rs=r.rs.remove(t),r.ss.delete(i.target)}function xl(e,t,n){const r=xs(e);let i=$s.min(),s=Va();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=xs(e),i=r.ss.get(n);return void 0!==i?io.resolve(r.rs.get(i)):r.Kr.getTargetData(t,n)}(r,e,Ta(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Kr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ns.getDocumentsMatchingQuery(e,t,n?i:$s.min(),n?s:Va()))).next((e=>(function(e,t,n){let r=e.os.get(t)||$s.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.os.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Ps:s})))))}class Al{constructor(){this.activeTargetIds=qa}Rs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}As(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rl{constructor(){this.ro=new Al,this.io={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.ro.Rs(e),this.io[e]||"not-current"}updateQueryState(e,t,n){this.io[e]=t}removeLocalQueryTarget(e){this.ro.Vs(e)}isLocalQueryTarget(e){return this.ro.activeTargetIds.has(e)}clearQueryState(e){delete this.io[e]}getAllActiveQueryTargets(){return this.ro.activeTargetIds}isActiveQueryTarget(e){return this.ro.activeTargetIds.has(e)}start(){return this.ro=new Al,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Pl{so(e){}shutdown(){}}class Dl{constructor(){this.oo=()=>this._o(),this.ao=()=>this.uo(),this.co=[],this.lo()}so(e){this.co.push(e)}shutdown(){window.removeEventListener("online",this.oo),window.removeEventListener("offline",this.ao)}lo(){window.addEventListener("online",this.oo),window.addEventListener("offline",this.ao)}_o(){Cs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.co)e(0)}uo(){Cs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.co)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ol=null;function Ll(){return null===Ol?Ol=268435456+Math.round(2147483648*Math.random()):Ol++,"0x"+Ol.toString(16)}const Ml={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fl{constructor(e){this.ho=e.ho,this.Po=e.Po}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.Po()}send(e){this.ho(e)}Vo(){this.To()}mo(e){this.Ao(e)}fo(e){this.Ro(e)}}const Ul="WebChannelConnection";class jl extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get So(){return!1}bo(e,t,n,r,i){const s=Ll(),o=this.Do(e,t);Cs("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Co(a,r,i),this.vo(e,o,a,n).then((t=>(Cs("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw Is("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Fo(e,t,n,r,i,s){return this.bo(e,t,n,r,i)}Co(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ws,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}Do(e,t){const n=Ml[e];return`${this.po}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const i=Ll();return new Promise(((s,o)=>{const a=new gs;a.setWithCredentials(!0),a.listenOnce(hs.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case us.NO_ERROR:const t=a.getResponseJson();Cs(Ul,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case us.TIMEOUT:Cs(Ul,`RPC '${e}' ${i} timed out`),o(new Rs(As.DEADLINE_EXCEEDED,"Request time out"));break;case us.HTTP_ERROR:const n=a.getStatus();if(Cs(Ul,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(As).indexOf(t)>=0?t:As.UNKNOWN}(t.status);o(new Rs(e,t.message))}else o(new Rs(As.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Rs(As.UNAVAILABLE,"Connection failed."));break;default:ks()}}finally{Cs(Ul,`RPC '${e}' ${i} completed.`)}}));const c=JSON.stringify(r);Cs(Ul,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",c,n,15)}))}Mo(e,t,n){const r=Ll(),i=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=cs(),o=ls(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Co(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=i.join("");Cs(Ul,`Creating RPC '${e}' stream ${r}: ${l}`,a);const u=s.createWebChannel(l,a);let h=!1,d=!1;const f=new Fl({ho:t=>{d?Cs(Ul,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(Cs(Ul,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),Cs(Ul,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Po:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,ps.EventType.OPEN,(()=>{d||Cs(Ul,`RPC '${e}' stream ${r} transport opened.`)})),p(u,ps.EventType.CLOSE,(()=>{d||(d=!0,Cs(Ul,`RPC '${e}' stream ${r} transport closed`),f.mo())})),p(u,ps.EventType.ERROR,(t=>{d||(d=!0,Is(Ul,`RPC '${e}' stream ${r} transport errored:`,t),f.mo(new Rs(As.UNAVAILABLE,"The operation could not be completed")))})),p(u,ps.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];Ns(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Cs(Ul,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=gc[e];if(void 0!==t)return yc(t)}(t),i=o.message;void 0===n&&(n=As.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.mo(new Rs(n,i)),u.close()}else Cs(Ul,`RPC '${e}' stream ${r} received:`,i),f.fo(i)}})),p(o,ds.STAT_EVENT,(t=>{t.stat===fs.PROXY?Cs(Ul,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===fs.NOPROXY&&Cs(Ul,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Vo()}),0),f}}function Vl(){return"undefined"!=typeof document?document:null}function ql(e){return new Lc(e,!0)}class Bl{constructor(e,t,n=1e3,r=1.5,i=6e4){this._i=e,this.timerId=t,this.xo=n,this.Oo=r,this.No=i,this.Bo=0,this.Lo=null,this.ko=Date.now(),this.reset()}reset(){this.Bo=0}qo(){this.Bo=this.No}Qo(e){this.cancel();const t=Math.floor(this.Bo+this.Ko()),n=Math.max(0,Date.now()-this.ko),r=Math.max(0,t-n);r>0&&Cs("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Bo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Lo=this._i.enqueueAfterDelay(this.timerId,r,(()=>(this.ko=Date.now(),e()))),this.Bo*=this.Oo,this.Bo<this.xo&&(this.Bo=this.xo),this.Bo>this.No&&(this.Bo=this.No)}$o(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Ko(){return(Math.random()-.5)*this.Bo}}class Hl{constructor(e,t,n,r,i,s,o,a){this._i=e,this.Uo=n,this.Wo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Go=0,this.zo=null,this.jo=null,this.stream=null,this.Ho=new Bl(e,t)}Jo(){return 1===this.state||5===this.state||this.Yo()}Yo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Zo()}async stop(){this.Jo()&&await this.close(0)}Xo(){this.state=0,this.Ho.reset()}e_(){this.Yo()&&null===this.zo&&(this.zo=this._i.enqueueAfterDelay(this.Uo,6e4,(()=>this.t_())))}n_(e){this.r_(),this.stream.send(e)}async t_(){if(this.Yo())return this.close(0)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}async close(e,t){this.r_(),this.i_(),this.Ho.cancel(),this.Go++,4!==e?this.Ho.reset():t&&t.code===As.RESOURCE_EXHAUSTED?(Es(t.toString()),Es("Using maximum backoff delay to prevent overloading the backend."),this.Ho.qo()):t&&t.code===As.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.s_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Eo(t)}s_(){}auth(){this.state=1;const e=this.o_(this.Go),t=this.Go;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Go===t&&this.__(e,n)}),(t=>{e((()=>{const e=new Rs(As.UNKNOWN,"Fetching auth token failed: "+t.message);return this.a_(e)}))}))}__(e,t){const n=this.o_(this.Go);this.stream=this.u_(e,t),this.stream.Io((()=>{n((()=>(this.state=2,this.jo=this._i.enqueueAfterDelay(this.Wo,1e4,(()=>(this.Yo()&&(this.state=3),Promise.resolve()))),this.listener.Io())))})),this.stream.Eo((e=>{n((()=>this.a_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Zo(){this.state=5,this.Ho.Qo((async()=>{this.state=0,this.start()}))}a_(e){return Cs("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}o_(e){return t=>{this._i.enqueueAndForget((()=>this.Go===e?t():(Cs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class zl extends Hl{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}u_(e,t){return this.connection.Mo("Listen",e,t)}onMessage(e){this.Ho.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ks()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Ns(void 0===t||"string"==typeof t),_o.fromBase64String(t||"")):(Ns(void 0===t||t instanceof Uint8Array),_o.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?As.UNKNOWN:yc(e.code);return new Rs(t,e.message||"")}(o);n=new kc(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=jc(e,r.document.name),s=Fc(r.document.updateTime),o=r.document.createTime?Fc(r.document.createTime):$s.min(),a=new zo({mapValue:{fields:r.document.fields}}),c=Wo.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Ic(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=jc(e,r.document),s=r.readTime?Fc(r.readTime):$s.min(),o=Wo.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ic([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=jc(e,r.document),s=r.removedTargetIds||[];n=new Ic([],s,i,null)}else{if(!("filter"in t))return ks();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new pc(r,i),o=e.targetId;n=new Sc(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return $s.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?$s.min():t.readTime?Fc(t.readTime):$s.min()}(e);return this.listener.c_(t,n)}l_(e){const t={};t.database=qc(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ya(r)?{documents:Hc(e,r)}:{query:zc(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=function(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}(e,t.resumeToken);const r=Mc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo($s.min())>0){n.readTime=function(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}(e,t.snapshotVersion.toTimestamp());const r=Mc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ks()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.n_(t)}h_(e){const t={};t.database=qc(this.serializer),t.removeTarget=e,this.n_(t)}}class Wl extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.R_=!1}V_(){if(this.R_)throw new Rs(As.FAILED_PRECONDITION,"The client has already been terminated.")}bo(e,t,n){return this.V_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.bo(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===As.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Rs(As.UNKNOWN,e.toString())}))}Fo(e,t,n,r){return this.V_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Fo(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===As.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Rs(As.UNKNOWN,e.toString())}))}terminate(){this.R_=!0}}class $l{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.f_=0,this.g_=null,this.p_=!0}y_(){0===this.f_&&(this.w_("Unknown"),this.g_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.g_=null,this.S_("Backend didn't respond within 10 seconds."),this.w_("Offline"),Promise.resolve()))))}b_(e){"Online"===this.state?this.w_("Unknown"):(this.f_++,this.f_>=1&&(this.D_(),this.S_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.w_("Offline")))}set(e){this.D_(),this.f_=0,"Online"===e&&(this.p_=!1),this.w_(e)}w_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}S_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.p_?(Es(t),this.p_=!1):Cs("OnlineStateTracker",t)}D_(){null!==this.g_&&(this.g_.cancel(),this.g_=null)}}class Kl{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.C_=[],this.v_=new Map,this.F_=new Set,this.M_=[],this.x_=i,this.x_.so((e=>{n.enqueueAndForget((async()=>{nu(this)&&(Cs("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=xs(e);t.F_.add(4),await Ql(t),t.O_.set("Unknown"),t.F_.delete(4),await Gl(t)}(this))}))})),this.O_=new $l(n,r)}}async function Gl(e){if(nu(e))for(const t of e.M_)await t(!0)}async function Ql(e){for(const t of e.M_)await t(!1)}function Yl(e,t){const n=xs(e);n.v_.has(t.targetId)||(n.v_.set(t.targetId,t),tu(n)?eu(n):lu(n).Yo()&&Jl(n,t))}function Xl(e,t){const n=xs(e),r=lu(n);n.v_.delete(t),r.Yo()&&Zl(n,t),0===n.v_.size&&(r.Yo()?r.e_():nu(n)&&n.O_.set("Unknown"))}function Jl(e,t){if(e.N_.Le(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo($s.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}lu(e).l_(t)}function Zl(e,t){e.N_.Le(t),lu(e).h_(t)}function eu(e){e.N_=new xc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.v_.get(t)||null,st:()=>e.datastore.serializer.databaseId}),lu(e).start(),e.O_.y_()}function tu(e){return nu(e)&&!lu(e).Jo()&&e.v_.size>0}function nu(e){return 0===xs(e).F_.size}function ru(e){e.N_=void 0}async function iu(e){e.v_.forEach(((t,n)=>{Jl(e,t)}))}async function su(e,t){ru(e),tu(e)?(e.O_.b_(t),eu(e)):e.O_.set("Unknown")}async function ou(e,t,n){if(e.O_.set("Online"),t instanceof kc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.v_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.v_.delete(r),e.N_.removeTarget(r))}(e,t)}catch(n){Cs("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await au(e,n)}else if(t instanceof Ic?e.N_.Ge(t):t instanceof Sc?e.N_.Xe(t):e.N_.He(t),!n.isEqual($s.min()))try{const t=await kl(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.N_._t(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.v_.get(r);i&&e.v_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.v_.get(t);if(!r)return;e.v_.set(t,r.withResumeToken(_o.EMPTY_BYTE_STRING,r.snapshotVersion)),Zl(e,t);const i=new el(r.target,t,n,r.sequenceNumber);Jl(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Cs("RemoteStore","Failed to raise snapshot:",t),await au(e,t)}}async function au(e,t,n){if(!so(t))throw t;e.F_.add(1),await Ql(e),e.O_.set("Offline"),n||(n=()=>kl(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Cs("RemoteStore","Retrying IndexedDB access"),await n(),e.F_.delete(1),await Gl(e)}))}async function cu(e,t){const n=xs(e);n.asyncQueue.verifyOperationInProgress(),Cs("RemoteStore","RemoteStore received new credentials");const r=nu(n);n.F_.add(3),await Ql(n),r&&n.O_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.F_.delete(3),await Gl(n)}function lu(e){return e.B_||(e.B_=function(e,t,n){const r=xs(e);return r.V_(),new zl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Io:iu.bind(null,e),Eo:su.bind(null,e),c_:ou.bind(null,e)}),e.M_.push((async t=>{t?(e.B_.Xo(),tu(e)?eu(e):e.O_.set("Unknown")):(await e.B_.stop(),ru(e))}))),e.B_}class uu{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ps,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new uu(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Rs(As.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hu(e,t){if(Es("AsyncQueue",`${t}: ${e}`),so(e))return new Rs(As.UNAVAILABLE,`${t}: ${e}`);throw e}class du{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xs.comparator(t.key,n.key):(e,t)=>Xs.comparator(e.key,t.key),this.keyedMap=Oa(),this.sortedSet=new ho(this.comparator)}static emptySet(e){return new du(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof du))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new du;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class fu{constructor(){this.k_=new ho(Xs.comparator)}track(e){const t=e.doc.key,n=this.k_.get(t);n?0!==e.type&&3===n.type?this.k_=this.k_.insert(t,e):3===e.type&&1!==n.type?this.k_=this.k_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.k_=this.k_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.k_=this.k_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.k_=this.k_.remove(t):1===e.type&&2===n.type?this.k_=this.k_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.k_=this.k_.insert(t,{type:2,doc:e.doc}):ks():this.k_=this.k_.insert(t,e)}q_(){const e=[];return this.k_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class pu{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new pu(e,t,du.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ea(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class gu{constructor(){this.Q_=void 0,this.listeners=[]}}class mu{constructor(){this.queries=new Aa((e=>Ia(e)),Ea),this.onlineState="Unknown",this.K_=new Set}}function yu(e,t){const n=xs(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.W_(e)&&(r=!0);i.Q_=e}}r&&_u(n)}function vu(e,t,n){const r=xs(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function _u(e){e.K_.forEach((e=>{e.next()}))}class wu{constructor(e,t,n){this.query=e,this.G_=t,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new pu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.z_?this.H_(e)&&(this.G_.next(e),t=!0):this.J_(e,this.onlineState)&&(this.Y_(e),t=!0),this.j_=e,t}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let t=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),t=!0),t}J_(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Z_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}H_(e){if(e.docChanges.length>0)return!0;const t=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Y_(e){e=pu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}}class bu{constructor(e){this.key=e}}class Tu{constructor(e){this.key=e}}class Cu{constructor(e,t){this.query=e,this.oa=t,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Va(),this.mutatedKeys=Va(),this.ua=Na(e),this.ca=new du(this.ua)}get la(){return this.oa}ha(e,t){const n=t?t.Pa:new fu,r=t?t.ca:this.ca;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=ka(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Ia(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ua(u,a)>0||c&&this.ua(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ca:s,Pa:n,es:o,mutatedKeys:i}}Ia(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;const i=e.Pa.q_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ks()}};return n(e)-n(t)}(e.type,t.type)||this.ua(e.doc,t.doc))),this.da(n);const s=t?this.Ta():[],o=0===this.aa.size&&this.current?1:0,a=o!==this._a;return this._a=o,0!==i.length||a?{snapshot:new pu(this.query,e.ca,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ea:s}:{Ea:s}}U_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new fu,mutatedKeys:this.mutatedKeys,es:!1},!1)):{Ea:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}da(e){e&&(e.addedDocuments.forEach((e=>this.oa=this.oa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.oa=this.oa.delete(e))),this.current=e.current)}Ta(){if(!this.current)return[];const e=this.aa;this.aa=Va(),this.ca.forEach((e=>{this.Aa(e.key)&&(this.aa=this.aa.add(e.key))}));const t=[];return e.forEach((e=>{this.aa.has(e)||t.push(new Tu(e))})),this.aa.forEach((n=>{e.has(n)||t.push(new bu(n))})),t}Ra(e){this.oa=e.Ps,this.aa=Va();const t=this.ha(e.documents);return this.applyChanges(t,!0)}Va(){return pu.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class Eu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Iu{constructor(e){this.key=e,this.ma=!1}}class Su{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new Aa((e=>Ia(e)),Ea),this.pa=new Map,this.ya=new Set,this.wa=new ho(Xs.comparator),this.Sa=new Map,this.ba=new fl,this.Da={},this.Ca=new Map,this.va=al.Ln(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function ku(e,t){const n=function(e){const t=xs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=xu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ju.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ru.bind(null,t),t.fa.c_=yu.bind(null,t.eventManager),t.fa.xa=vu.bind(null,t.eventManager),t}(e);let r,i;const s=n.ga.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{const e=await function(e,t){const n=xs(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Kr.getTargetData(e,t).next((i=>i?(r=i,io.resolve(r)):n.Kr.allocateTargetId(e).next((i=>(r=new el(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Kr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.rs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.rs=n.rs.insert(e.targetId,e),n.ss.set(t,e.targetId)),e}))}(n.localStore,Ta(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await async function(e,t,n,r,i){e.Ma=(t,n,r)=>async function(e,t,n,r){let i=t.view.ha(n);i.es&&(i=await xl(e.localStore,t.query,!1).then((({documents:e})=>t.view.ha(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return Ou(e,t.targetId,o.Ea),o.snapshot}(e,t,n,r);const s=await xl(e.localStore,t,!0),o=new Cu(t,s.Ps),a=o.ha(s.documents),c=Ec.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=o.applyChanges(a,e.isPrimaryClient,c);Ou(e,n,l.Ea);const u=new Eu(t,n,o);return e.ga.set(t,u),e.pa.has(n)?e.pa.get(n).push(t):e.pa.set(n,[t]),l.snapshot}(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&Yl(n.remoteStore,e)}return i}async function Nu(e,t){const n=xs(e),r=n.ga.get(t),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter((e=>!Ea(e,t)))),void n.ga.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Nl(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),Xl(n.remoteStore,r.targetId),Pu(n,r.targetId)})).catch(ro)):(Pu(n,r.targetId),await Nl(n.localStore,r.targetId,!0))}async function xu(e,t){const n=xs(e);try{const e=await function(e,t){const n=xs(e),r=t.snapshotVersion;let i=n.rs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n._s.newChangeBuffer({trackRemovals:!0});i=n.rs;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Kr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Kr.addMatchingKeys(e,s.addedDocuments,a))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(_o.EMPTY_BYTE_STRING,$s.min()).withLastLimboFreeSnapshotVersion($s.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,r)),i=i.insert(a,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,s)&&o.push(n.Kr.updateTargetData(e,l))}));let a=Pa(),c=Va();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(function(e,t,n){let r=Va(),i=Va();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Pa();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual($s.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Cs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{ls:r,hs:i}}))}(e,s,t.documentUpdates).next((e=>{a=e.ls,c=e.hs}))),!r.isEqual($s.min())){const t=n.Kr.getLastRemoteSnapshotVersion(e).next((t=>n.Kr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return io.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.rs=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Sa.get(t);r&&(Ns(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.ma=!0:e.modifiedDocuments.size>0?Ns(r.ma):e.removedDocuments.size>0&&(Ns(r.ma),r.ma=!1))})),await Fu(n,e,t)}catch(e){await ro(e)}}function Au(e,t,n){const r=xs(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ga.forEach(((n,r)=>{const i=r.view.U_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=xs(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.U_(t)&&(r=!0)})),r&&_u(n)}(r.eventManager,t),e.length&&r.fa.c_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ru(e,t,n){const r=xs(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Sa.get(t),s=i&&i.key;if(s){let e=new ho(Xs.comparator);e=e.insert(s,Wo.newNoDocument(s,$s.min()));const n=Va().add(s),i=new Cc($s.min(),new Map,new ho(Hs),e,n);await xu(r,i),r.wa=r.wa.remove(s),r.Sa.delete(t),Mu(r)}else await Nl(r.localStore,t,!1).then((()=>Pu(r,t,n))).catch(ro)}function Pu(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.pa.get(t))e.ga.delete(r),n&&e.fa.xa(r,n);e.pa.delete(t),e.isPrimaryClient&&e.ba.mr(t).forEach((t=>{e.ba.containsKey(t)||Du(e,t)}))}function Du(e,t){e.ya.delete(t.path.canonicalString());const n=e.wa.get(t);null!==n&&(Xl(e.remoteStore,n),e.wa=e.wa.remove(t),e.Sa.delete(n),Mu(e))}function Ou(e,t,n){for(const r of n)r instanceof bu?(e.ba.addReference(r.key,t),Lu(e,r)):r instanceof Tu?(Cs("SyncEngine","Document no longer in limbo: "+r.key),e.ba.removeReference(r.key,t),e.ba.containsKey(r.key)||Du(e,r.key)):ks()}function Lu(e,t){const n=t.key,r=n.path.canonicalString();e.wa.get(n)||e.ya.has(r)||(Cs("SyncEngine","New document in limbo: "+n),e.ya.add(r),Mu(e))}function Mu(e){for(;e.ya.size>0&&e.wa.size<e.maxConcurrentLimboResolutions;){const t=e.ya.values().next().value;e.ya.delete(t);const n=new Xs(Gs.fromString(t)),r=e.va.next();e.Sa.set(r,new Iu(n)),e.wa=e.wa.insert(n,r),Yl(e.remoteStore,new el(Ta(_a(n.path)),r,"TargetPurposeLimboResolution",oo.ae))}}async function Fu(e,t,n){const r=xs(e),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach(((e,a)=>{o.push(r.Ma(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Tl.$i(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.fa.c_(i),await async function(e,t){const n=xs(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>io.forEach(t,(t=>io.forEach(t.Qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>io.forEach(t.Ki,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!so(e))throw e;Cs("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.rs.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.rs=n.rs.insert(t,i)}}}(r.localStore,s))}async function Uu(e,t){const n=xs(e);if(!n.currentUser.isEqual(t)){Cs("SyncEngine","User change. New user:",t.toKey());const e=await Sl(n.localStore,t);n.currentUser=t,function(e,t){e.Ca.forEach((e=>{e.forEach((e=>{e.reject(new Rs(As.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ca.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Fu(n,e.cs)}}function ju(e,t){const n=xs(e),r=n.Sa.get(t);if(r&&r.ma)return Va().add(r.key);{let e=Va();const r=n.pa.get(t);if(!r)return e;for(const t of r){const r=n.ga.get(t);e=e.unionWith(r.view.la)}return e}}class Vu{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ql(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,r){return new Il(e,t,n,r)}(this.persistence,new El,e.initialUser,this.serializer)}createPersistence(e){return new _l(bl.Jr,this.serializer)}createSharedClientState(e){return new Rl}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class qu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Au(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Uu.bind(null,this.syncEngine),await async function(e,t){const n=xs(e);t?(n.F_.delete(2),await Gl(n)):t||(n.F_.add(2),await Ql(n),n.O_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new mu}createDatastore(e){const t=ql(e.databaseInfo.databaseId),n=function(e){return new jl(e)}(e.databaseInfo);return function(e,t,n,r){return new Wl(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Kl(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Au(this.syncEngine,e,0)),Dl.C()?new Dl:new Pl)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Su(e,t,n,r,i,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=xs(e);Cs("RemoteStore","RemoteStore shutting down."),t.F_.add(5),await Ql(t),t.x_.shutdown(),t.O_.set("Unknown")}(this.remoteStore)}}class Bu{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):Es("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Hu{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=_s.UNAUTHENTICATED,this.clientId=Bs.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Cs("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Cs("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Rs(As.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ps;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=hu(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function zu(e,t){e.asyncQueue.verifyOperationInProgress(),Cs("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Sl(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Wu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Cs("FirestoreClient","Using user provided OfflineComponentProvider");try{await zu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===As.FAILED_PRECONDITION||e.code===As.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Is("Error using user provided cache. Falling back to memory cache: "+n),await zu(e,new Vu)}}else Cs("FirestoreClient","Using default OfflineComponentProvider"),await zu(e,new Vu);return e._offlineComponents}(e);Cs("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>cu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>cu(t.remoteStore,n))),e._onlineComponents=t}async function $u(e){const t=await async function(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Cs("FirestoreClient","Using user provided OnlineComponentProvider"),await Wu(e,e._uninitializedComponentsProvider._online)):(Cs("FirestoreClient","Using default OnlineComponentProvider"),await Wu(e,new qu))),e._onlineComponents}(e),n=t.eventManager;return n.onListen=ku.bind(null,t.syncEngine),n.onUnlisten=Nu.bind(null,t.syncEngine),n}function Ku(e,t,n={}){const r=new Ps;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Bu({next:n=>{t.enqueueAndForget((()=>async function(e,t){const n=xs(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}(e,o))),n.fromCache&&"server"===r.source?i.reject(new Rs(As.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new wu(n,s,{includeMetadataChanges:!0,Z_:!0});return async function(e,t){const n=xs(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new gu),i)try{s.Q_=await n.onListen(r)}catch(e){const n=hu(e,`Initialization of query '${Sa(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.U_(n.onlineState),s.Q_&&t.W_(s.Q_)&&_u(n)}(e,o)}(await $u(e),e.asyncQueue,t,n,r))),r.promise}function Gu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Qu=new Map;function Yu(e){if(Xs.isDocumentKey(e))throw new Rs(As.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Xu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Rs(As.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":ks()}(e);throw new Rs(As.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Ju{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Rs(As.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Rs(As.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Rs(As.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Gu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Rs(As.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Rs(As.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Rs(As.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ju({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Rs(As.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Rs(As.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ju(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Os;switch(e.type){case"firstParty":return new Us(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Rs(As.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Qu.get(e);t&&(Cs("ComponentProvider","Removing Datastore"),Qu.delete(e),t.terminate())}(this),Promise.resolve()}}class eh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eh(this.firestore,e,this._query)}}class th{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new th(this.firestore,e,this._key)}}class nh extends eh{constructor(e,t,n){super(e,t,_a(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new th(this.firestore,null,new Xs(e))}withConverter(e){return new nh(this.firestore,e,this._path)}}function rh(e,t,...n){if(e=Q(e),function(e,t,n){if(!n)throw new Rs(As.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}("collection","path",t),e instanceof Zu){const r=Gs.fromString(t,...n);return Yu(r),new nh(e,null,r)}{if(!(e instanceof th||e instanceof nh))throw new Rs(As.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Gs.fromString(t,...n));return Yu(r),new nh(e.firestore,null,r)}}class ih{constructor(){this.Za=Promise.resolve(),this.Xa=[],this.eu=!1,this.tu=[],this.nu=null,this.ru=!1,this.iu=!1,this.su=[],this.Ho=new Bl(this,"async_queue_retry"),this.ou=()=>{const e=Vl();e&&Cs("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Ho.$o()};const e=Vl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ou)}get isShuttingDown(){return this.eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this._u(),this.au(e)}enterRestrictedMode(e){if(!this.eu){this.eu=!0,this.iu=e||!1;const t=Vl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ou)}}enqueue(e){if(this._u(),this.eu)return new Promise((()=>{}));const t=new Ps;return this.au((()=>this.eu&&this.iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xa.push(e),this.uu())))}async uu(){if(0!==this.Xa.length){try{await this.Xa[0](),this.Xa.shift(),this.Ho.reset()}catch(e){if(!so(e))throw e;Cs("AsyncQueue","Operation failed with retryable error: "+e)}this.Xa.length>0&&this.Ho.Qo((()=>this.uu()))}}au(e){const t=this.Za.then((()=>(this.ru=!0,e().catch((e=>{this.nu=e,this.ru=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Es("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.ru=!1,e))))));return this.Za=t,t}enqueueAfterDelay(e,t,n){this._u(),this.su.indexOf(e)>-1&&(t=0);const r=uu.createAndSchedule(this,e,t,n,(e=>this.cu(e)));return this.tu.push(r),r}_u(){this.nu&&ks()}verifyOperationInProgress(){}async lu(){let e;do{e=this.Za,await e}while(e!==this.Za)}hu(e){for(const t of this.tu)if(t.timerId===e)return!0;return!1}Pu(e){return this.lu().then((()=>{this.tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.lu()}))}Iu(e){this.su.push(e)}cu(e){const t=this.tu.indexOf(e);this.tu.splice(t,1)}}class sh extends Zu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ih,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||oh(this),this._firestoreClient.terminate()}}function oh(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new ko(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Gu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Hu(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class ah{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ah(_o.fromBase64String(e))}catch(e){throw new Rs(As.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new ah(_o.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ch{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Rs(As.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ys(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Rs(As.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Rs(As.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Hs(this._lat,e._lat)||Hs(this._long,e._long)}}const uh=new RegExp("[~\\*/\\[\\]]");function hh(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Rs(As.INVALID_ARGUMENT,a+e+c)}class dh{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new th(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new fh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ph("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class fh extends dh{data(){return super.data()}}function ph(e,t){return"string"==typeof t?function(e,t,n){if(t.search(uh)>=0)throw hh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ch(...t.split("."))._internalPath}catch(r){throw hh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t):t instanceof ch?t._internalPath:t._delegate._internalPath}class gh{convertValue(e,t="none"){switch(Ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return To(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ks()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return uo(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new lh(To(e.latitude),To(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Io(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(So(e));default:return null}}convertTimestamp(e){const t=bo(e);return new Ws(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Gs.fromString(e);Ns(Zc(n));const r=new No(n.get(1),n.get(3)),i=new Xs(n.popFirst(5));return r.isEqual(t)||Es(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class mh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yh extends dh{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ph("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class vh extends yh{data(e={}){return super.data(e)}}class _h{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mh(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new vh(this._firestore,this._userDataWriter,n.key,n,new mh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Rs(As.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new vh(e._firestore,e._userDataWriter,n.doc.key,n.doc,new mh(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new vh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new mh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:wh(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function wh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ks()}}class bh extends gh{constructor(e){super(),this.firestore=e}convertBytes(e){return new ah(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new th(this.firestore,null,t)}}function Th(e){e=Xu(e,eh);const t=Xu(e.firestore,sh),n=function(e){return e._firestoreClient||oh(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(t),r=new bh(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Rs(As.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),Ku(n,e._query).then((n=>new _h(t,r,e,n)))}function Ch(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Eh(e){return void 0!==e&&void 0!==e.enterprise}new WeakMap,function(e,t=!0){!function(e){ws=e}(Ue),Oe(new Y("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new sh(new Ms(e.getProvider("auth-internal")),new Vs(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Rs(As.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new No(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),qe(vs,"4.2.0",e),qe(vs,"4.2.0","esm2017")}(),qe("firebase","10.4.0","app"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class Ih{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}const Sh=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},kh=new R("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Nh=new ae("@firebase/auth");function xh(e,...t){Nh.logLevel<=te.ERROR&&Nh.error(`Auth (${Ue}): ${e}`,...t)}function Ah(e,...t){throw Ph(e,...t)}function Rh(e,...t){return Ph(e,...t)}function Ph(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return kh.create(e,...t)}function Dh(e,t,...n){if(!e)throw Ph(t,...n)}function Oh(e){const t="INTERNAL ASSERTION FAILED: "+e;throw xh(t),new Error(t)}function Lh(e,t){e||Oh(t)}function Mh(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Fh(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Uh(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Fh()||"https:"===Fh()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class jh{constructor(e,t){this.shortDelay=e,this.longDelay=t,Lh(t>e,"Short delay should be less than long delay!"),this.isMobile=N()||x()}get(){return Uh()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Vh(e,t){Lh(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class qh{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Oh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Oh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Oh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Bh={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Hh=new jh(3e4,6e4);function zh(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Wh(e,t,n,r,i={}){return $h(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=B(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),qh.fetch()(Gh(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function $h(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Bh),t);try{const t=new Qh(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Yh(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Yh(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Yh(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Yh(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const r=Object.assign(Object.assign({},Sh()),{[t]:n});return new R("auth","Firebase",r).create(t,{appName:e.name})}(e,a,o);Ah(e,a)}}catch(t){if(t instanceof A)throw t;Ah(e,"network-request-failed",{message:String(t)})}}async function Kh(e,t,n,r,i={}){const s=await Wh(e,t,n,r,i);return"mfaPendingCredential"in s&&Ah(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Gh(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Vh(e.config,i):`${e.config.apiScheme}://${i}`}class Qh{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Rh(this.auth,"network-request-failed"))),Hh.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yh(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Rh(e,t,r);return i.customData._tokenResponse=n,i}function Xh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Jh(e){return 1e3*Number(e)}function Zh(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const e=y(n);return e?JSON.parse(e):(xh("Failed to decode base64 JWT payload"),null)}catch(e){return xh("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function ed(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof A&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class td{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class nd{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xh(this.lastLoginAt),this.creationTime=Xh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function rd(e){var t;const n=e.auth,r=await e.getIdToken(),i=await ed(e,async function(e,t){return Wh(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Dh(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Ch(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new nd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class id{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Dh(e.idToken,"internal-error"),Dh(void 0!==e.idToken,"internal-error"),Dh(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Zh(e);return Dh(t,"internal-error"),Dh(void 0!==t.exp,"internal-error"),Dh(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Dh(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await $h(e,{},(async()=>{const n=B({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Gh(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",qh.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new id;return n&&(Dh("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Dh("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Dh("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new id,this.toJSON())}_performRefresh(){return Oh("not implemented")}}function sd(e,t){Dh("string"==typeof e||void 0===e,"internal-error",{appName:t})}class od{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Ch(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new td(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ed(this,this.stsTokenManager.getToken(this.auth,e));return Dh(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Q(e),r=await n.getIdToken(t),i=Zh(r);Dh(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Xh(Jh(i.auth_time)),issuedAtTime:Xh(Jh(i.iat)),expirationTime:Xh(Jh(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Q(e);await rd(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Dh(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new od(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Dh(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await rd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ed(this,async function(e,t){return Wh(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:T}=t;Dh(v&&T,e,"internal-error");const C=id.fromJSON(this.name,T);Dh("string"==typeof v,e,"internal-error"),sd(u,e.name),sd(h,e.name),Dh("boolean"==typeof _,e,"internal-error"),Dh("boolean"==typeof w,e,"internal-error"),sd(d,e.name),sd(f,e.name),sd(p,e.name),sd(g,e.name),sd(m,e.name),sd(y,e.name);const E=new od({uid:v,auth:e,email:h,emailVerified:_,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:C,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new id;r.updateFromServerResponse(t);const i=new od({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await rd(i),i}}const ad=new Map;function cd(e){Lh(e instanceof Function,"Expected a class definition");let t=ad.get(e);return t?(Lh(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ad.set(e,t),t)}class ld{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ld.type="NONE";const ud=ld;function hd(e,t,n){return`firebase:${e}:${t}:${n}`}class dd{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=hd(this.userKey,r.apiKey,i),this.fullPersistenceKey=hd("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?od._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new dd(cd(ud),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||cd(ud);const s=hd(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=od._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new dd(i,e,n)):new dd(i,e,n)}}function fd(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(yd(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(pd(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(_d(t))return"Blackberry";if(wd(t))return"Webos";if(gd(t))return"Safari";if((t.includes("chrome/")||md(t))&&!t.includes("edge/"))return"Chrome";if(vd(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function pd(e=k()){return/firefox\//i.test(e)}function gd(e=k()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function md(e=k()){return/crios\//i.test(e)}function yd(e=k()){return/iemobile/i.test(e)}function vd(e=k()){return/android/i.test(e)}function _d(e=k()){return/blackberry/i.test(e)}function wd(e=k()){return/webos/i.test(e)}function bd(e=k()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Td(e=k()){return bd(e)||vd(e)||wd(e)||_d(e)||/windows phone/i.test(e)||yd(e)}function Cd(e,t=[]){let n;switch(e){case"Browser":n=fd(k());break;case"Worker":n=`${fd(k())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ue}/${r}`}class Ed{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Id{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Sd{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Nd(this),this.idTokenSubscription=new Nd(this),this.beforeStateQueue=new Ed(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=cd(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await dd.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Dh(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await rd(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Q(e):null;return t&&Dh(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Dh(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(cd(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Wh(e,"GET","/v2/passwordPolicy",zh(e,t))}(this),t=new Id(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new R("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&cd(e)||this._popupRedirectResolver;Dh(t,this,"argument-error"),this.redirectPersistenceManager=await dd.create(this,[cd(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Dh(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Dh(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Nh.logLevel<=te.WARN&&Nh.warn(`Auth (${Ue}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function kd(e){return Q(e)}class Nd{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new $(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Dh(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function xd(e){return new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Rh("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}))}function Ad(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Rd{constructor(e){this.type="recaptcha-enterprise",this.auth=kd(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;Eh(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return Wh(e,"GET","/v2/recaptchaConfig",zh(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Ih(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Eh(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));xd("https://www.google.com/recaptcha/enterprise.js?render="+i).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Pd(e,t,n,r=!1){const i=new Rd(e);let s;try{s=await i.verify(n)}catch(e){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}function Dd(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Od(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ld{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Oh("not implemented")}_getIdTokenResponse(e){return Oh("not implemented")}_linkToIdToken(e,t){return Oh("not implemented")}_getReauthenticationResolver(e){return Oh("not implemented")}}async function Md(e,t){return Kh(e,"POST","/v1/accounts:signInWithPassword",zh(e,t))}class Fd extends Ld{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Fd(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Fd(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Pd(e,n,"signInWithPassword");return Md(e,t)}return Md(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Pd(e,n,"signInWithPassword");return Md(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return Kh(e,"POST","/v1/accounts:signInWithEmailLink",zh(e,t))}(e,{email:this._email,oobCode:this._password});default:Ah(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Wh(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Kh(e,"POST","/v1/accounts:signInWithEmailLink",zh(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ah(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ud(e,t){return Kh(e,"POST","/v1/accounts:signInWithIdp",zh(e,t))}class jd extends Ld{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new jd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ah("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Ch(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new jd(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ud(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ud(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ud(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=B(t)}return e}}const Vd={USER_NOT_FOUND:"user-not-found"};class qd extends Ld{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new qd({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new qd({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Kh(e,"POST","/v1/accounts:signInWithPhoneNumber",zh(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Kh(e,"POST","/v1/accounts:signInWithPhoneNumber",zh(e,t));if(n.temporaryProof)throw Yh(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Kh(e,"POST","/v1/accounts:signInWithPhoneNumber",zh(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Vd)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new qd({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Bd{constructor(e){var t,n,r,i,s,o;const a=H(z(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Dh(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=H(z(e)).link,n=t?H(z(t)).deep_link_id:null,r=H(z(e)).deep_link_id;return(r?H(z(r)).link:null)||r||n||t||e}(e);try{return new Bd(t)}catch(e){return null}}}class Hd{constructor(){this.providerId=Hd.PROVIDER_ID}static credential(e,t){return Fd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Bd.parseLink(t);return Dh(n,"argument-error"),Fd._fromEmailAndCode(e,n.code,n.tenantId)}}Hd.PROVIDER_ID="password",Hd.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Hd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class zd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Wd extends zd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $d extends Wd{constructor(){super("facebook.com")}static credential(e){return jd._fromParams({providerId:$d.PROVIDER_ID,signInMethod:$d.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $d.credentialFromTaggedObject(e)}static credentialFromError(e){return $d.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return $d.credential(e.oauthAccessToken)}catch(e){return null}}}$d.FACEBOOK_SIGN_IN_METHOD="facebook.com",$d.PROVIDER_ID="facebook.com";class Kd extends Wd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return jd._fromParams({providerId:Kd.PROVIDER_ID,signInMethod:Kd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Kd.credentialFromTaggedObject(e)}static credentialFromError(e){return Kd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Kd.credential(t,n)}catch(e){return null}}}Kd.GOOGLE_SIGN_IN_METHOD="google.com",Kd.PROVIDER_ID="google.com";class Gd extends Wd{constructor(){super("github.com")}static credential(e){return jd._fromParams({providerId:Gd.PROVIDER_ID,signInMethod:Gd.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gd.credentialFromTaggedObject(e)}static credentialFromError(e){return Gd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Gd.credential(e.oauthAccessToken)}catch(e){return null}}}Gd.GITHUB_SIGN_IN_METHOD="github.com",Gd.PROVIDER_ID="github.com";class Qd extends Wd{constructor(){super("twitter.com")}static credential(e,t){return jd._fromParams({providerId:Qd.PROVIDER_ID,signInMethod:Qd.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qd.credentialFromTaggedObject(e)}static credentialFromError(e){return Qd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Qd.credential(t,n)}catch(e){return null}}}Qd.TWITTER_SIGN_IN_METHOD="twitter.com",Qd.PROVIDER_ID="twitter.com";class Yd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await od._fromIdTokenResponse(e,n,r),s=Xd(n);return new Yd({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Xd(n);return new Yd({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Xd(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Jd extends A{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Jd.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Jd(e,t,n,r)}}function Zd(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Jd._fromErrorAndOperation(e,n,t,r);throw n}))}new WeakMap;const ef="__sak";class tf{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ef,"1"),this.storage.removeItem(ef),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class nf extends tf{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=k();return gd(e)||bd(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Td(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=k();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}nf.type="LOCAL";const rf=nf;class sf extends tf{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sf.type="SESSION";const of=sf;class af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new af(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function cf(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}af.receivers=[];class lf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=cf("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function uf(){return window}function hf(){return void 0!==uf().WorkerGlobalScope&&"function"==typeof uf().importScripts}const df="firebaseLocalStorageDb",ff="firebaseLocalStorage",pf="fbase_key";class gf{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function mf(e,t){return e.transaction([ff],t?"readwrite":"readonly").objectStore(ff)}function yf(){const e=indexedDB.open(df,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ff,{keyPath:pf})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ff)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(df);return new gf(e).toPromise()}(),t(await yf()))}))}))}async function vf(e,t,n){const r=mf(e,!0).put({[pf]:t,value:n});return new gf(r).toPromise()}function _f(e,t){const n=mf(e,!0).delete(t);return new gf(n).toPromise()}class wf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await yf()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=af._getInstance(hf()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new lf(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yf();return await vf(e,ef,"1"),await _f(e,ef),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>vf(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=mf(e,!1).get(t),r=await new gf(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>_f(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=mf(e,!1).getAll();return new gf(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}wf.type="LOCAL";const bf=wf;Ad("rcb"),new jh(3e4,6e4);class Tf{constructor(e){this.providerId=Tf.PROVIDER_ID,this.auth=kd(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var r;const i=await n.verify();try{let s;if(Dh("string"==typeof i,e,"argument-error"),Dh("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Dh("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Wh(e,"POST","/v2/accounts/mfaEnrollment:start",zh(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Dh("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Dh(n,e,"missing-multi-factor-info");const o=await function(e,t){return Wh(e,"POST","/v2/accounts/mfaSignIn:start",zh(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Wh(e,"POST","/v1/accounts:sendVerificationCode",zh(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}(this.auth,e,Q(t))}static credential(e,t){return qd._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Tf.credentialFromTaggedObject(t)}static credentialFromError(e){return Tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?qd._fromTokenResponse(t,n):null}}Tf.PROVIDER_ID="phone",Tf.PHONE_SIGN_IN_METHOD="phone";class Cf extends Ld{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ud(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ud(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ud(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ef(e){return async function(e,t,n=!1){const r="signIn",i=await Zd(e,r,t),s=await Yd._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Cf(e),e.bypassAuthState)}function If(e){const{auth:t,user:n}=e;return Dh(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await ed(e,Zd(r,i,t,e),n);Dh(s.idToken,r,"internal-error");const o=Zh(s.idToken);Dh(o,r,"internal-error");const{sub:a}=o;return Dh(e.uid===a,r,"user-mismatch"),Yd._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Ah(r,"user-mismatch"),e}}(n,new Cf(e),e.bypassAuthState)}async function Sf(e){const{auth:t,user:n}=e;return Dh(n,t,"internal-error"),async function(e,t,n=!1){const r=await ed(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Yd._forOperation(e,"link",r)}(n,new Cf(e),e.bypassAuthState)}class kf{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ef;case"linkViaPopup":case"linkViaRedirect":return Sf;case"reauthViaPopup":case"reauthViaRedirect":return If;default:Ah(this.auth,"internal-error")}}resolve(e){Lh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Nf=new jh(2e3,1e4);class xf extends kf{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,xf.currentPopupAction&&xf.currentPopupAction.cancel(),xf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Dh(e,this.auth,"internal-error"),e}async onExecution(){Lh(1===this.filter.length,"Popup operations only handle one event");const e=cf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Rh(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Rh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Rh(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Nf.get())};e()}}xf.currentPopupAction=null;const Af="pendingRedirect",Rf=new Map;class Pf extends kf{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Rf.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return hd(Af,e.config.apiKey,e.name)}(t),r=function(e){return cd(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Rf.set(this.auth._key(),e)}return this.bypassAuthState||Rf.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Df(e,t){Rf.set(e._key(),t)}async function Of(e,t,n=!1){const r=kd(e),i=function(e,t){return t?cd(t):(Dh(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new Pf(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Lf{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ff(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ff(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Rh(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mf(e))}saveEventToCache(e){this.cachedEventUids.add(Mf(e)),this.lastProcessedEventTime=Date.now()}}function Mf(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ff({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Uf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jf=/^https?/;function Vf(e){const t=Mh(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!jf.test(n))return!1;if(Uf.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const qf=new jh(3e4,6e4);function Bf(){const e=uf().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Hf=null;function zf(e){return Hf=Hf||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){Bf(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Bf(),n(Rh(e,"network-request-failed"))},timeout:qf.get()})}if(null===(i=null===(r=uf().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=uf().gapi)||void 0===s?void 0:s.load)){const t=Ad("iframefcb");return uf()[t]=()=>{gapi.load?o():n(Rh(e,"network-request-failed"))},xd(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Hf=null,e}))}(e),Hf}const Wf=new jh(5e3,15e3),$f={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Kf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gf(e){const t=e.config;Dh(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Vh(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ue},i=Kf.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${B(r).slice(1)}`}const Qf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Yf{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const Xf=encodeURIComponent("fac");async function Jf(e,t,n,r,i,s){Dh(e.config.authDomain,e,"auth-domain-config-required"),Dh(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ue,eventId:i};if(t instanceof zd){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",U(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Wd){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),l=c?`#${Xf}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?Vh(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${B(a).slice(1)}${l}`}const Zf="webStorageSupport",ep=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=of,this._completeRedirectFn=Of,this._overrideRedirectResult=Df}async _openPopup(e,t,n,r){var i;return Lh(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Qf),{width:r.toString(),height:i.toString(),top:s,left:o}),l=k().toLowerCase();n&&(a=md(l)?"_blank":n),pd(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=k()){var t;return bd(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Yf(null);const h=window.open(t||"",a,u);Dh(h,e,"popup-blocked");try{h.focus()}catch(e){}return new Yf(h)}(e,await Jf(e,t,n,Mh(),r),cf())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await Jf(e,t,n,Mh(),r),uf().location.href=i,new Promise((()=>{}));var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Lh(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await zf(e),n=uf().gapi;return Dh(n,e,"internal-error"),t.open({where:document.body,url:Gf(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$f,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Rh(e,"network-request-failed"),s=uf().setTimeout((()=>{r(i)}),Wf.get());function o(){uf().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new Lf(e);return t.register("authEvent",(t=>(Dh(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zf,{type:Zf},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Zf];void 0!==i&&t(!!i),Ah(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Wh(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Vf(e))return}catch(e){}Ah(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Td()||gd()||bd()}};var tp="@firebase/auth",np="1.3.0";class rp{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Dh(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ip=E("authIdTokenMaxAge")||300;let sp=null;function op(e=Ve()){const t=Le(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Le(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(V(n.getOptions(),null!=t?t:{}))return e;Ah(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ep,persistence:[bf,rf,of]}),r=E("authTokenSyncURL");if(r){const e=(i=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ip)return;const r=null==t?void 0:t.token;sp!==r&&(sp=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Q(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,r,i){Q(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var i;const s=b("auth");return s&&function(e,t,n){const r=kd(e);Dh(r._canInitEmulator,r,"emulator-config-failed"),Dh(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Dd(t),{host:o,port:a}=function(e){const t=Dd(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Od(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Od(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}var ap;ap="Browser",Oe(new Y("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Dh(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:ap,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cd(ap)},c=new Sd(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(cd);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Oe(new Y("auth-internal",(e=>{return t=kd(e.getProvider("auth").getImmediate()),new rp(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),qe(tp,np,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ap)),qe(tp,np,"esm2017");const cp="@firebase/database",lp="1.0.1";let up="";class hp{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),O(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:D(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class dp{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return M(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const fp=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new hp(t)}}catch(e){}return new dp},pp=fp("localStorage"),gp=fp("sessionStorage"),mp=new ae("@firebase/database"),yp=function(){let e=1;return function(){return e++}}(),vp=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,u(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new W;n.update(t);const r=n.digest();return f.encodeByteArray(r)},_p=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=_p.apply(null,r):t+="object"==typeof r?O(r):r,t+=" "}return t};let wp=null,bp=!0;const Tp=function(...e){if(!0===bp&&(bp=!1,null===wp&&!0===gp.get("logging_enabled")&&(t=!0,u(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(mp.logLevel=te.VERBOSE,wp=mp.log.bind(mp),n&&gp.set("logging_enabled",!0)):"function"==typeof t?wp=t:(wp=null,gp.remove("logging_enabled")))),wp){const t=_p.apply(null,e);wp(t)}var t,n},Cp=function(e){return function(...t){Tp(e,...t)}},Ep=function(...e){const t="FIREBASE INTERNAL ERROR: "+_p(...e);mp.error(t)},Ip=function(...e){const t=`FIREBASE FATAL ERROR: ${_p(...e)}`;throw mp.error(t),new Error(t)},Sp=function(...e){const t="FIREBASE WARNING: "+_p(...e);mp.warn(t)},kp=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Np="[MIN_NAME]",xp="[MAX_NAME]",Ap=function(e,t){if(e===t)return 0;if(e===Np||t===xp)return-1;if(t===Np||e===xp)return 1;{const n=Up(e),r=Up(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Rp=function(e,t){return e===t?0:e<t?-1:1},Pp=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+O(t))},Dp=function(e){if("object"!=typeof e||null===e)return O(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=O(t[r]),n+=":",n+=Dp(e[t[r]]);return n+="}",n},Op=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Lp(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Mp=function(e){u(!kp(e),"Invalid JSON number");let t,n,r,i,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const o=[];for(s=52;s;s-=1)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();const a=o.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},Fp=new RegExp("^-?(0*)\\d{1,10}$"),Up=function(e){if(Fp.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},jp=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Sp("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Vp=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class qp{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Sp(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Bp{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Tp("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Sp(e)}}class Hp{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Hp.OWNER="owner";const zp="5",Wp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,$p="ac",Kp="websocket",Gp="long_polling";class Qp{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pp.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pp.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Yp(e,t,n){let r;if(u("string"==typeof t,"typeof type must == string"),u("object"==typeof n,"typeof params must == object"),t===Kp)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Gp)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Lp(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class Xp{constructor(){this.counters_={}}incrementCounter(e,t=1){M(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return v(this.counters_)}}const Jp={},Zp={};function eg(e){const t=e.toString();return Jp[t]||(Jp[t]=new Xp),Jp[t]}class tg{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&jp((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ng="start";class rg{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Cp(e),this.stats_=eg(t),this.urlFn=e=>(this.appCheckToken&&(e[$p]=this.appCheckToken),Yp(t,Gp,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new tg(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ig(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ng)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ng]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=zp,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[$p]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Wp.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){rg.forceAllow_=!0}static forceDisallow(){rg.forceDisallow_=!0}static isAvailable(){return!(!rg.forceAllow_&&(rg.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=O(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=g(t),r=Op(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=O(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ig{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=yp(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ig.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Tp("frame writing exception"),e.stack&&Tp(e.stack),Tp(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Tp("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Tp("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let sg=null;"undefined"!=typeof MozWebSocket?sg=MozWebSocket:"undefined"!=typeof WebSocket&&(sg=WebSocket);class og{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Cp(this.connId),this.stats_=eg(t),this.connURL=og.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=zp,"undefined"!=typeof location&&location.hostname&&Wp.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[$p]=r),i&&(s.p=i),Yp(e,Kp,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pp.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new sg(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){og.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==sg&&!og.forceDisallow_}static previouslyFailed(){return pp.isInMemoryStorage||!0===pp.get("previous_websocket_failure")}markConnectionHealthy(){pp.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=D(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(u(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=O(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Op(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}og.responsesRequiredToBeHealthy=2,og.healthyTimeout=3e4;class ag{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[rg,og]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=og&&og.isAvailable();let n=t&&!og.previouslyFailed();if(e.webSocketOnly&&(t||Sp("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[og];else{const e=this.transports_=[];for(const t of ag.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ag.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ag.globalTransportInitialized_=!1;class cg{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Cp("c:"+this.id+":"),this.transportManager_=new ag(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Vp((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Pp("t",e),n=Pp("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Pp("t",e),n=Pp("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Pp("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Ep("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ep("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),zp!==n&&Sp("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Vp((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vp((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pp.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class lg{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class ug{constructor(e){this.allowedEvents_=e,this.listeners_={},u(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){u(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class hg extends ug{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||N()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new hg}getInitialEvent(e){return u("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class dg{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function fg(){return new dg("")}function pg(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function gg(e){return e.pieces_.length-e.pieceNum_}function mg(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new dg(e.pieces_,t)}function yg(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function vg(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function _g(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new dg(t,0)}function wg(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof dg)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new dg(n,0)}function bg(e){return e.pieceNum_>=e.pieces_.length}function Tg(e,t){const n=pg(e),r=pg(t);if(null===n)return t;if(n===r)return Tg(mg(e),mg(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Cg(e,t){if(gg(e)!==gg(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Eg(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(gg(e)>gg(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Ig{constructor(e,t){this.errorPrefix_=t,this.parts_=vg(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=G(this.parts_[e]);Sg(this)}}function Sg(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+kg(e))}function kg(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Ng extends ug{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Ng}getInitialEvent(e){return u("visible"===e,"Unknown event type: "+e),[this.visible_]}}const xg=1e3;class Ag extends lg{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Ag.nextPersistentConnectionId_++,this.log_=Cp("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xg,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ng.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&hg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(O(i)),u(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new I,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),u(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),u(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Ag.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&M(e,"w")){const n=F(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Sp(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=L(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=L(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),u(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+O(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Ep("Unrecognized action received from server: "+O(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){u(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xg,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xg,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=xg),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Ag.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){u(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?Tp("getToken() completed but was canceled"):(Tp("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new cg(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Sp(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&Sp(e),a())}}}interrupt(e){Tp("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Tp("Resuming connection for reason: "+e),delete this.interruptReasons_[e],U(this.interruptReasons_)&&(this.reconnectDelay_=xg,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Dp(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new dg(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Tp("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Tp("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+up.replace(/\./g,"-")]=1,N()?e["framework.cordova"]=1:x()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=hg.getInstance().currentlyOnline();return U(this.interruptReasons_)&&e}}Ag.nextPersistentConnectionId_=0,Ag.nextConnectionId_=0;class Rg{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Rg(e,t)}}class Pg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Rg(Np,e),r=new Rg(Np,t);return 0!==this.compare(n,r)}minPost(){return Rg.MIN}}let Dg;class Og extends Pg{static get __EMPTY_NODE(){return Dg}static set __EMPTY_NODE(e){Dg=e}compare(e,t){return Ap(e.name,t.name)}isDefinedOn(e){throw h("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Rg.MIN}maxPost(){return new Rg(xp,Dg)}makePost(e,t){return u("string"==typeof e,"KeyIndex indexValue must always be a string."),new Rg(e,Dg)}toString(){return".key"}}const Lg=new Og;class Mg{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Fg{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Fg.RED,this.left=null!=r?r:Ug.EMPTY_NODE,this.right=null!=i?i:Ug.EMPTY_NODE}copy(e,t,n,r,i){return new Fg(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ug.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Ug.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Fg.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Fg.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Fg.RED=!0,Fg.BLACK=!1;class Ug{constructor(e,t=Ug.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ug(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Fg.BLACK,null,null))}remove(e){return new Ug(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fg.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Mg(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Mg(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Mg(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Mg(this.root_,null,this.comparator_,!0,e)}}function jg(e,t){return Ap(e.name,t.name)}function Vg(e,t){return Ap(e,t)}let qg;Ug.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Fg(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Bg=function(e){return"number"==typeof e?"number:"+Mp(e):"string:"+e},Hg=function(e){if(e.isLeafNode()){const t=e.val();u("string"==typeof t||"number"==typeof t||"object"==typeof t&&M(t,".sv"),"Priority must be a string or number.")}else u(e===qg||e.isEmpty(),"priority of unexpected type.");u(e===qg||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let zg,Wg,$g;class Kg{constructor(e,t=Kg.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,u(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Hg(this.priorityNode_)}static set __childrenNodeConstructor(e){zg=e}static get __childrenNodeConstructor(){return zg}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Kg(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Kg.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return bg(e)?this:".priority"===pg(e)?this.priorityNode_:Kg.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Kg.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=pg(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(u(".priority"!==n||1===gg(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Kg.__childrenNodeConstructor.EMPTY_NODE.updateChild(mg(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Bg(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Mp(this.value_):this.value_,this.lazyHash_=vp(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Kg.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Kg.__childrenNodeConstructor?-1:(u(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Kg.VALUE_TYPE_ORDER.indexOf(t),i=Kg.VALUE_TYPE_ORDER.indexOf(n);return u(r>=0,"Unknown leaf type: "+t),u(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Kg.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Gg=new class extends Pg{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Ap(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Rg.MIN}maxPost(){return new Rg(xp,new Kg("[PRIORITY-POST]",$g))}makePost(e,t){const n=Wg(e);return new Rg(t,new Kg("[PRIORITY-POST]",n))}toString(){return".priority"}},Qg=Math.log(2);class Yg{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Qg,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Xg=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Fg(a,o.node,Fg.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],a=n?n(o):o,new Fg(a,o.node,Fg.BLACK,l,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const l=i(s+1,a),u=e[s],h=n?n(u):u;c(new Fg(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Fg.BLACK):(a(r,Fg.BLACK),a(r,Fg.RED))}return s}(new Yg(e.length));return new Ug(r||t,s)};let Jg;const Zg={};class em{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return u(Zg&&Gg,"ChildrenNode.ts has not been loaded"),Jg=Jg||new em({".priority":Zg},{".priority":Gg}),Jg}get(e){const t=F(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ug?t:null}hasIndex(e){return M(this.indexSet_,e.toString())}addIndex(e,t){u(e!==Lg,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Rg.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?Xg(n,e.getCompare()):Zg;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const l=Object.assign({},this.indexes_);return l[a]=s,new em(l,c)}addToIndexes(e,t){const n=j(this.indexes_,((n,r)=>{const i=F(this.indexSet_,r);if(u(i,"Missing index implementation for "+r),n===Zg){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Rg.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Xg(n,i.getCompare())}return Zg}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Rg(e.name,r))),i.insert(e,e.node)}}));return new em(n,this.indexSet_)}removeFromIndexes(e,t){const n=j(this.indexes_,(n=>{if(n===Zg)return n;{const r=t.get(e.name);return r?n.remove(new Rg(e.name,r)):n}}));return new em(n,this.indexSet_)}}let tm;class nm{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Hg(this.priorityNode_),this.children_.isEmpty()&&u(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return tm||(tm=new nm(new Ug(Vg),null,em.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||tm}updatePriority(e){return this.children_.isEmpty()?this:new nm(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?tm:t}}getChild(e){const t=pg(e);return null===t?this:this.getImmediateChild(t).getChild(mg(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(u(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Rg(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?tm:this.priorityNode_;return new nm(r,s,i)}}updateChild(e,t){const n=pg(e);if(null===n)return t;{u(".priority"!==pg(e)||1===gg(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(mg(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Gg,((s,o)=>{t[s]=o.val(e),n++,i&&nm.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Bg(this.getPriority().val())+":"),this.forEachChild(Gg,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":vp(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Rg(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Rg(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Rg(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Rg.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Rg.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rm?-1:0}withIndex(e){if(e===Lg||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new nm(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Lg||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Gg),n=t.getIterator(Gg);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Lg?null:this.indexMap_.get(e.toString())}}nm.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const rm=new class extends nm{constructor(){super(new Ug(Vg),nm.EMPTY_NODE,em.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return nm.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Rg,{MIN:{value:new Rg(Np,nm.EMPTY_NODE)},MAX:{value:new Rg(xp,rm)}}),Og.__EMPTY_NODE=nm.EMPTY_NODE,Kg.__childrenNodeConstructor=nm,qg=rm,$g=rm;const im=!0;function sm(e,t=null){if(null===e)return nm.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),u(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Kg(e,sm(t));if(e instanceof Array||!im){let n=nm.EMPTY_NODE;return Lp(e,((t,r)=>{if(M(e,t)&&"."!==t.substring(0,1)){const e=sm(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(sm(t))}{const n=[];let r=!1;if(Lp(e,((e,t)=>{if("."!==e.substring(0,1)){const i=sm(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Rg(e,i)))}})),0===n.length)return nm.EMPTY_NODE;const i=Xg(n,jg,(e=>e.name),Vg);if(r){const e=Xg(n,Gg.getCompare());return new nm(i,sm(t),new em({".priority":e},{".priority":Gg}))}return new nm(i,sm(t),em.Default)}}!function(e){Wg=e}(sm);class om extends Pg{constructor(e){super(),this.indexPath_=e,u(!bg(e)&&".priority"!==pg(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Ap(e.name,t.name):i}makePost(e,t){const n=sm(e),r=nm.EMPTY_NODE.updateChild(this.indexPath_,n);return new Rg(t,r)}maxPost(){const e=nm.EMPTY_NODE.updateChild(this.indexPath_,rm);return new Rg(xp,e)}toString(){return vg(this.indexPath_,0).join("/")}}const am=new class extends Pg{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Ap(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Rg.MIN}maxPost(){return Rg.MAX}makePost(e,t){const n=sm(e);return new Rg(t,n)}toString(){return".value"}};function cm(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class lm{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Gg}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return u(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return u(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Np}hasEnd(){return this.endSet_}getIndexEndValue(){return u(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return u(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xp}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return u(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Gg}copy(){const e=new lm;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function um(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Gg?n="$priority":e.index_===am?n="$value":e.index_===Lg?n="$key":(u(e.index_ instanceof om,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=O(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=O(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+O(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=O(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+O(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function hm(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Gg&&(t.i=e.index_.toString()),t}class dm extends lg{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Cp("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(u(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=dm.getListenId_(e,n),o={};this.listens_[s]=o;const a=um(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),F(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=dm.getListenId_(e,t);delete this.listens_[n]}get(e){const t=um(e._queryParams),n=e._path.toString(),r=new I;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+B(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=D(o.responseText)}catch(e){Sp("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&Sp("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class fm{constructor(){this.rootNode_=nm.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function pm(){return{value:null,children:new Map}}function gm(e,t,n){if(bg(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=pg(t);e.children.has(r)||e.children.set(r,pm()),gm(e.children.get(r),t=mg(t),n)}}function mm(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{mm(r,new dg(t.toString()+"/"+e),n)}))}class ym{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Lp(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class vm{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ym(e);const n=1e4+2e4*Math.random();Vp(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Lp(e,((e,r)=>{r>0&&M(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Vp(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var _m,wm;function bm(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(wm=_m||(_m={}))[wm.OVERWRITE=0]="OVERWRITE",wm[wm.MERGE=1]="MERGE",wm[wm.ACK_USER_WRITE=2]="ACK_USER_WRITE",wm[wm.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Tm{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=_m.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(bg(this.path)){if(null!=this.affectedTree.value)return u(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new dg(e));return new Tm(fg(),t,this.revert)}}return u(pg(this.path)===e,"operationForChild called for unrelated child."),new Tm(mg(this.path),this.affectedTree,this.revert)}}class Cm{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=_m.OVERWRITE}operationForChild(e){return bg(this.path)?new Cm(this.source,fg(),this.snap.getImmediateChild(e)):new Cm(this.source,mg(this.path),this.snap)}}class Em{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=_m.MERGE}operationForChild(e){if(bg(this.path)){const t=this.children.subtree(new dg(e));return t.isEmpty()?null:t.value?new Cm(this.source,fg(),t.value):new Em(this.source,fg(),t)}return u(pg(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Em(this.source,mg(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Im{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(bg(e))return this.isFullyInitialized()&&!this.filtered_;const t=pg(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Sm(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw h("Should only compare child_ events.");const r=new Rg(t.childName,t.snapshotNode),i=new Rg(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function km(e,t){return{eventCache:e,serverCache:t}}function Nm(e,t,n,r){return km(new Im(t,n,r),e.serverCache)}function xm(e,t,n,r){return km(e.eventCache,new Im(t,n,r))}function Am(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Rm(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Pm;class Dm{constructor(e,t=(()=>(Pm||(Pm=new Ug(Rp)),Pm))()){this.value=e,this.children=t}static fromObject(e){let t=new Dm(null);return Lp(e,((e,n)=>{t=t.set(new dg(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:fg(),value:this.value};if(bg(e))return null;{const n=pg(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(mg(e),t);return null!=i?{path:wg(new dg(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(bg(e))return this;{const t=pg(e),n=this.children.get(t);return null!==n?n.subtree(mg(e)):new Dm(null)}}set(e,t){if(bg(e))return new Dm(t,this.children);{const n=pg(e),r=(this.children.get(n)||new Dm(null)).set(mg(e),t),i=this.children.insert(n,r);return new Dm(this.value,i)}}remove(e){if(bg(e))return this.children.isEmpty()?new Dm(null):new Dm(null,this.children);{const t=pg(e),n=this.children.get(t);if(n){const r=n.remove(mg(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Dm(null):new Dm(this.value,i)}return this}}get(e){if(bg(e))return this.value;{const t=pg(e),n=this.children.get(t);return n?n.get(mg(e)):null}}setTree(e,t){if(bg(e))return t;{const n=pg(e),r=(this.children.get(n)||new Dm(null)).setTree(mg(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Dm(this.value,i)}}fold(e){return this.fold_(fg(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(wg(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,fg(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(bg(e))return null;{const r=pg(e),i=this.children.get(r);return i?i.findOnPath_(mg(e),wg(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,fg(),t)}foreachOnPath_(e,t,n){if(bg(e))return this;{this.value&&n(t,this.value);const r=pg(e),i=this.children.get(r);return i?i.foreachOnPath_(mg(e),wg(t,r),n):new Dm(null)}}foreach(e){this.foreach_(fg(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(wg(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Om{constructor(e){this.writeTree_=e}static empty(){return new Om(new Dm(null))}}function Lm(e,t,n){if(bg(t))return new Om(new Dm(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Tg(i,t);return s=s.updateChild(o,n),new Om(e.writeTree_.set(i,s))}{const r=new Dm(n),i=e.writeTree_.setTree(t,r);return new Om(i)}}}function Mm(e,t,n){let r=e;return Lp(n,((e,n)=>{r=Lm(r,wg(t,e),n)})),r}function Fm(e,t){if(bg(t))return Om.empty();{const n=e.writeTree_.setTree(t,new Dm(null));return new Om(n)}}function Um(e,t){return null!=jm(e,t)}function jm(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Tg(n.path,t)):null}function Vm(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Gg,((e,n)=>{t.push(new Rg(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Rg(e,n.value))})),t}function qm(e,t){if(bg(t))return e;{const n=jm(e,t);return new Om(null!=n?new Dm(n):e.writeTree_.subtree(t))}}function Bm(e){return e.writeTree_.isEmpty()}function Hm(e,t){return zm(fg(),e.writeTree_,t)}function zm(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(u(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=zm(wg(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(wg(e,".priority"),r)),n}}function Wm(e,t){return ny(t,e)}function $m(e,t){if(e.snap)return Eg(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Eg(wg(e.path,n),t))return!0;return!1}function Km(e){return e.visible}function Gm(e,t,n){let r=Om.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Eg(n,e)?(t=Tg(n,e),r=Lm(r,t,s.snap)):Eg(e,n)&&(t=Tg(e,n),r=Lm(r,fg(),s.snap.getChild(t)));else{if(!s.children)throw h("WriteRecord should have .snap or .children");if(Eg(n,e))t=Tg(n,e),r=Mm(r,t,s.children);else if(Eg(e,n))if(t=Tg(e,n),bg(t))r=Mm(r,fg(),s.children);else{const e=F(s.children,pg(t));if(e){const n=e.getChild(mg(t));r=Lm(r,fg(),n)}}}}}return r}function Qm(e,t,n,r,i){if(r||i){const s=qm(e.visibleWrites,t);if(!i&&Bm(s))return n;if(i||null!=n||Um(s,fg())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Eg(e.path,t)||Eg(t,e.path))};return Hm(Gm(e.allWrites,s,t),n||nm.EMPTY_NODE)}return null}{const r=jm(e.visibleWrites,t);if(null!=r)return r;{const r=qm(e.visibleWrites,t);return Bm(r)?n:null!=n||Um(r,fg())?Hm(r,n||nm.EMPTY_NODE):null}}}function Ym(e,t,n,r){return Qm(e.writeTree,e.treePath,t,n,r)}function Xm(e,t){return function(e,t,n){let r=nm.EMPTY_NODE;const i=jm(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Gg,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=qm(e.visibleWrites,t);return n.forEachChild(Gg,((e,t)=>{const n=Hm(qm(i,new dg(e)),t);r=r.updateImmediateChild(e,n)})),Vm(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Vm(qm(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Jm(e,t,n,r){return function(e,t,n,r,i){u(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=wg(t,n);if(Um(e.visibleWrites,s))return null;{const t=qm(e.visibleWrites,s);return Bm(t)?i.getChild(n):Hm(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Zm(e,t){return function(e,t){return jm(e.visibleWrites,t)}(e.writeTree,wg(e.treePath,t))}function ey(e,t,n){return function(e,t,n,r){const i=wg(t,n),s=jm(e.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?Hm(qm(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function ty(e,t){return ny(wg(e.treePath,t),e.writeTree)}function ny(e,t){return{treePath:e,writeTree:t}}class ry{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;u("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),u(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(n,cm(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(n,(i=n,{type:"child_removed",snapshotNode:r.oldSnap,childName:i}));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw h("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,cm(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e);var i}getChanges(){return Array.from(this.changeMap.values())}}const iy=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class sy{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Im(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ey(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Rm(this.viewCache_),i=function(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=qm(e.visibleWrites,t),l=jm(c,fg());if(null!=l)a=l;else{if(null==n)return[];a=Hm(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function oy(e,t,n,r,i,s){const o=t.eventCache;if(null!=Zm(r,n))return t;{let a,c;if(bg(n))if(u(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Rm(t),i=Xm(r,n instanceof nm?n:nm.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=Ym(r,Rm(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const l=pg(n);if(".priority"===l){u(1===gg(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=Jm(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=mg(n);let h;if(o.isCompleteForChild(l)){c=t.serverCache.getNode();const e=Jm(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(l).updateChild(u,e):o.getNode().getImmediateChild(l)}else h=ey(r,l,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),l,h,u,i,s):o.getNode()}}return Nm(t,a,o.isFullyInitialized()||bg(n),e.filter.filtersNodes())}}function ay(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(bg(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=pg(n);if(!c.isCompleteForPath(n)&&gg(n)>1)return t;const i=mg(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,i,iy,null)}const h=xm(t,l,c.isFullyInitialized()||bg(n),u.filtersNodes());return oy(e,h,n,i,new sy(i,h,s),a)}function cy(e,t,n,r,i,s,o){const a=t.eventCache;let c,l;const u=new sy(i,t,s);if(bg(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=Nm(t,l,!0,e.filter.filtersNodes());else{const i=pg(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=Nm(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=mg(n),l=a.getNode().getImmediateChild(i);let h;if(bg(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===yg(s)&&e.getChild(_g(s)).isEmpty()?e:e.updateChild(s,r):nm.EMPTY_NODE}c=l.equals(h)?t:Nm(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return c}function ly(e,t){return e.eventCache.isCompleteForChild(t)}function uy(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function hy(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=bg(n)?r:new Dm(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=uy(0,t.serverCache.getNode().getImmediateChild(n),r);l=ay(e,l,new dg(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!c){const c=uy(0,t.serverCache.getNode().getImmediateChild(n),r);l=ay(e,l,new dg(n),c,i,s,o,a)}})),l}function dy(e,t){const n=Rm(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!bg(t)&&!n.getImmediateChild(pg(t)).isEmpty())?n.getChild(t):null}function fy(e,t,n,r){t.type===_m.MERGE&&null!==t.source.queryId&&(u(Rm(e.viewCache_),"We should always have a full cache before handling merges"),u(Am(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=function(e,t,n,r,i){const s=new ry;let o,a;if(n.type===_m.OVERWRITE){const c=n;c.source.fromUser?o=cy(e,t,c.path,c.snap,r,i,s):(u(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!bg(c.path),o=ay(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===_m.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const l=wg(n,r);ly(t,pg(l))&&(a=cy(e,a,l,c,i,s,o))})),r.foreach(((r,c)=>{const l=wg(n,r);ly(t,pg(l))||(a=cy(e,a,l,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(u(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=hy(e,t,c.path,c.children,r,i,a,s))}else if(n.type===_m.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=Zm(r,n))return t;{const a=new sy(r,t,i),c=t.eventCache.getNode();let l;if(bg(n)||".priority"===pg(n)){let n;if(t.serverCache.isFullyInitialized())n=Ym(r,Rm(t));else{const e=t.serverCache.getNode();u(e instanceof nm,"serverChildren would be complete if leaf node"),n=Xm(r,e)}l=e.filter.updateFullNode(c,n,s)}else{const i=pg(n);let u=ey(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=c.getImmediateChild(i)),l=null!=u?e.filter.updateChild(c,i,u,mg(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,nm.EMPTY_NODE,mg(n),a,s):c,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Ym(r,Rm(t)),o.isLeafNode()&&(l=e.filter.updateFullNode(l,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=Zm(r,fg()),Nm(t,l,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=Zm(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(bg(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return ay(e,t,n,c.getNode().getChild(n),i,s,a,o);if(bg(n)){let r=new Dm(null);return c.getNode().forEachChild(Lg,((e,t)=>{r=r.set(new dg(e),t)})),hy(e,t,n,r,i,s,a,o)}return t}{let l=new Dm(null);return r.foreach(((e,t)=>{const r=wg(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),hy(e,t,n,l,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==_m.LISTEN_COMPLETE)throw h("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache;return oy(e,xm(t,s.getNode(),s.isFullyInitialized()||bg(n),s.isFiltered()),n,r,iy,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Am(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push({type:"value",snapshotNode:Am(t)})}}(t,o,c),{viewCache:o,changes:c}}(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,u(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),u(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),u(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,function(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Sm(e,i,"child_removed",t,r,n),Sm(e,i,"child_added",t,r,n),Sm(e,i,"child_moved",s,r,n),Sm(e,i,"child_changed",t,r,n),Sm(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}(e,s.changes,s.viewCache.eventCache.getNode(),null)}let py,gy;function my(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return u(null!=s,"SyncTree gave us an op for an invalid query."),fy(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(fy(s,t,n,r));return i}}function yy(e,t){let n=null;for(const r of e.views.values())n=n||dy(r,t);return n}class vy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Dm(null),this.pendingWriteTree_={visibleWrites:Om.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function _y(e,t,n,r,i){return function(e,t,n,r,i){u(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Lm(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Cy(e,new Cm({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function wy(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));u(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&$m(t,r.path)?i=!1:Eg(r.path,t.path)&&(s=!0)),o--}return!!i&&(s?(function(e){e.visibleWrites=Gm(e.allWrites,Km,fg()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=Fm(e.visibleWrites,r.path):Lp(r.children,(t=>{e.visibleWrites=Fm(e.visibleWrites,wg(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new Dm(null);return null!=r.snap?t=t.set(fg(),!0):Lp(r.children,(e=>{t=t.set(new dg(e),!0)})),Cy(e,new Tm(r.path,t,n))}return[]}function by(e,t,n){return Cy(e,new Cm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Ty(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=yy(n,Tg(e,t));if(r)return r}));return Qm(r,t,i,n,!0)}function Cy(e,t){return Ey(t,e.syncPointTree_,null,Wm(e.pendingWriteTree_,fg()))}function Ey(e,t,n,r){if(bg(e.path))return Iy(e,t,n,r);{const i=t.get(fg());null==n&&null!=i&&(n=yy(i,fg()));let s=[];const o=pg(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=ty(r,o);s=s.concat(Ey(a,c,e,t))}return i&&(s=s.concat(my(i,e,r,n))),s}}function Iy(e,t,n,r){const i=t.get(fg());null==n&&null!=i&&(n=yy(i,fg()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=ty(r,t),c=e.operationForChild(t);c&&(s=s.concat(Iy(c,i,o,a)))})),i&&(s=s.concat(my(i,e,r,n))),s}function Sy(e,t){return e.tagToQueryMap.get(t)}function ky(e){const t=e.indexOf("$");return u(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new dg(e.substr(0,t))}}function Ny(e,t,n){const r=e.syncPointTree_.get(t);return u(r,"Missing sync point for query tag that we're tracking"),my(r,n,Wm(e.pendingWriteTree_,t),null)}class xy{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new xy(t)}node(){return this.node_}}class Ay{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=wg(this.path_,e);return new Ay(this.syncTree_,t)}node(){return Ty(this.syncTree_,this.path_)}}const Ry=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Py=function(e,t,n){return e&&"object"==typeof e?(u(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Dy(e[".sv"],t,n):"object"==typeof e[".sv"]?Oy(e[".sv"],t):void u(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Dy=function(e,t,n){if("timestamp"===e)return n.timestamp;u(!1,"Unexpected server value: "+e)},Oy=function(e,t,n){e.hasOwnProperty("increment")||u(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&u(!1,"Unexpected increment value: "+r);const i=t.node();if(u(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},Ly=function(e,t,n,r){return Fy(t,new Ay(n,e),r)},My=function(e,t,n){return Fy(e,new xy(t),n)};function Fy(e,t,n){const r=e.getPriority().val(),i=Py(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Py(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Kg(s,sm(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Kg(i))),r.forEachChild(Gg,((e,r)=>{const i=Fy(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class Uy{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function jy(e,t){let n=t instanceof dg?t:new dg(t),r=e,i=pg(n);for(;null!==i;){const e=F(r.node.children,i)||{children:{},childCount:0};r=new Uy(i,r,e),n=mg(n),i=pg(n)}return r}function Vy(e){return e.node.value}function qy(e,t){e.node.value=t,$y(e)}function By(e){return e.node.childCount>0}function Hy(e,t){Lp(e.node.children,((n,r)=>{t(new Uy(n,e,r))}))}function zy(e,t,n,r){n&&!r&&t(e),Hy(e,(e=>{zy(e,t,!0,r)})),n&&r&&t(e)}function Wy(e){return new dg(null===e.parent?e.name:Wy(e.parent)+"/"+e.name)}function $y(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Vy(e)&&!By(e)}(n),i=M(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,$y(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,$y(e))}(e.parent,e.name,e)}const Ky=/[\[\].#$\/\u0000-\u001F\u007F]/,Gy=/[\[\].#$\u0000-\u001F\u007F]/,Qy=10485760,Yy=function(e){return"string"==typeof e&&0!==e.length&&!Ky.test(e)},Xy=function(e,t,n){const r=n instanceof dg?new Ig(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+kg(r));if("function"==typeof t)throw new Error(e+"contains a function "+kg(r)+" with contents = "+t.toString());if(kp(t))throw new Error(e+"contains "+t.toString()+" "+kg(r));if("string"==typeof t&&t.length>Qy/3&&G(t)>Qy)throw new Error(e+"contains a string greater than "+Qy+" utf8 bytes "+kg(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Lp(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Yy(t)))throw new Error(e+" contains an invalid key ("+t+") "+kg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var o,a;a=t,(o=r).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(a),o.byteLength_+=G(a),Sg(o),Xy(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=G(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+kg(r)+" in addition to actual children.")}},Jy=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Yy(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),function(e){return"string"==typeof e&&0!==e.length&&!Gy.test(e)}(e)}(n))throw new Error(function(e,t){return`${e} failed: ${t} argument `}(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Zy{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ev(e,t,n){(function(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Cg(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)})(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(tv(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>Eg(e,t)||Eg(t,e)))}function tv(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();wp&&Tp("event: "+n.toString()),jp(r)}}}const nv=25;class rv{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Zy,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pm(),this.transactionQueueTree_=new Uy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function iv(e,t,n){if(e.stats_=eg(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new dm(e.repoInfo_,((t,n,r,i)=>{av(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>cv(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{O(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Ag(e.repoInfo_,t,((t,n,r,i)=>{av(e,t,n,r,i)}),(t=>{cv(e,t)}),(t=>{!function(e,t){Lp(t,((t,n)=>{lv(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return Zp[r]||(Zp[r]=new vm(e.stats_,e.server_)),Zp[r]}(e.repoInfo_),e.infoData_=new fm,e.infoSyncTree_=new vy({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=by(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),lv(e,"connected",!1),e.serverSyncTree_=new vy({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);ev(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function sv(e){const t=e.infoData_.getNode(new dg(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ov(e){return Ry({timestamp:sv(e)})}function av(e,t,n,r,i){e.dataUpdateCount++;const s=new dg(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=j(n,(e=>sm(e)));o=function(e,t,n,r){const i=Sy(e,r);if(i){const r=ky(i),s=r.path,o=r.queryId,a=Tg(s,t),c=Dm.fromObject(n);return Ny(e,s,new Em(bm(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=sm(n);o=function(e,t,n,r){const i=Sy(e,r);if(null!=i){const r=ky(i),s=r.path,o=r.queryId,a=Tg(s,t);return Ny(e,s,new Cm(bm(o),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=j(n,(e=>sm(e)));o=function(e,t,n){const r=Dm.fromObject(n);return Cy(e,new Em({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=sm(n);o=by(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=pv(e,s)),ev(e.eventQueue_,a,o)}function cv(e,t){lv(e,"connected",t),!1===t&&function(e){hv(e,"onDisconnectEvents");const t=ov(e),n=pm();mm(e.onDisconnect_,fg(),((r,i)=>{const s=Ly(r,i,e.serverSyncTree_,t);gm(n,r,s)}));let r=[];mm(n,fg(),((t,n)=>{r=r.concat(by(e.serverSyncTree_,t,n));const i=function(e,t){const n=Wy(gv(e,t)),r=jy(e.transactionQueueTree_,t);return function(e,t,n){let r=void 0?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{_v(e,t)})),_v(e,r),zy(r,(t=>{_v(e,t)})),n}(e,t);pv(e,i)})),e.onDisconnect_=pm(),ev(e.eventQueue_,fg(),r)}(e)}function lv(e,t,n){const r=new dg("/.info/"+t),i=sm(n);e.infoData_.updateSnapshot(r,i);const s=by(e.infoSyncTree_,r,i);ev(e.eventQueue_,r,s)}function uv(e){return e.nextWriteId_++}function hv(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Tp(n,...t)}function dv(e,t,n){return Ty(e.serverSyncTree_,t,n)||nm.EMPTY_NODE}function fv(e,t=e.transactionQueueTree_){if(t||vv(e,t),Vy(t)){const n=mv(e,t);u(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=dv(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];u(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Tg(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{hv(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(wy(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();vv(e,jy(e.transactionQueueTree_,t)),fv(e,e.transactionQueueTree_),ev(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)jp(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{Sp("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}pv(e,t)}}),o)}(e,Wy(t),n)}else By(t)&&Hy(t,(t=>{fv(e,t)}))}function pv(e,t){const n=gv(e,t),r=Wy(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let s=0;s<t.length;s++){const c=t[s],l=Tg(n,c.path);let h,d=!1;if(u(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)d=!0,h=c.abortReason,i=i.concat(wy(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=nv)d=!0,h="maxretry",i=i.concat(wy(e.serverSyncTree_,c.currentWriteId,!0));else{const n=dv(e,c.path,o);c.currentInputSnapshot=n;const r=t[s].update(n.val());if(void 0!==r){Xy("transaction failed: Data returned ",r,c.path);let t=sm(r);"object"==typeof r&&null!=r&&M(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=c.currentWriteId,a=ov(e),l=My(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=l,c.currentWriteId=uv(e),o.splice(o.indexOf(s),1),i=i.concat(_y(e.serverSyncTree_,c.path,l,c.currentWriteId,c.applyLocally)),i=i.concat(wy(e.serverSyncTree_,s,!0))}else d=!0,h="nodata",i=i.concat(wy(e.serverSyncTree_,c.currentWriteId,!0))}ev(e.eventQueue_,n,i),i=[],d&&(t[s].status=2,a=t[s].unwatcher,setTimeout(a,Math.floor(0)),t[s].onComplete&&("nodata"===h?r.push((()=>t[s].onComplete(null,!1,t[s].currentInputSnapshot))):r.push((()=>t[s].onComplete(new Error(h),!1,null)))))}var a;vv(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)jp(r[e]);fv(e,e.transactionQueueTree_)}(e,mv(e,n),r),r}function gv(e,t){let n,r=e.transactionQueueTree_;for(n=pg(t);null!==n&&void 0===Vy(r);)r=jy(r,n),n=pg(t=mg(t));return r}function mv(e,t){const n=[];return yv(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function yv(e,t,n){const r=Vy(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Hy(t,(t=>{yv(e,t,n)}))}function vv(e,t){const n=Vy(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,qy(t,n.length>0?n:void 0)}Hy(t,(t=>{vv(e,t)}))}function _v(e,t){const n=Vy(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(u(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(u(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(wy(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?qy(t,void 0):n.length=s+1,ev(e.eventQueue_,Wy(t),i);for(let e=0;e<r.length;e++)jp(r[e])}}const wv=function(e,t){const n=bv(e),r=n.namespace;"firebase.com"===n.domain&&Ip(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Ip("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Sp("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Qp(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new dg(n.pathString)}},bv=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Sp(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const f=t.slice(0,l);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class Tv{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return bg(this._path)?null:yg(this._path)}get ref(){return new Cv(this._repo,this._path)}get _queryIdentifier(){const e=hm(this._queryParams),t=Dp(e);return"{}"===t?"default":t}get _queryObject(){return hm(this._queryParams)}isEqual(e){if(!((e=Q(e))instanceof Tv))return!1;const t=this._repo===e._repo,n=Cg(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Cv extends Tv{constructor(e,t){super(e,t,new lm,!1)}get parent(){const e=_g(this._path);return null===e?null:new Cv(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}!function(e){u(!py,"__referenceConstructor has already been defined"),py=e}(Cv),function(e){u(!gy,"__referenceConstructor has already been defined"),gy=e}(Cv);const Ev={};class Iv{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(iv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Cv(this._repo,fg())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Ev[t];n&&n[e.key]===e||Ip(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ip("Cannot call "+e+" on a deleted database.")}}function Sv(e){return Sv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(e)}function kv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Sv(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Sv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Sv(i)?i:String(i)),r)}var i}Ag.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ag.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},up=Ue,Oe(new Y("database",((e,{instanceIdentifier:t})=>function(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Ip("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tp("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=wv(s,i),l=c.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${l.namespace}`,c=wv(s,i),l=c.repoInfo):o=!c.repoInfo.secure;const u=i&&o?new Hp(Hp.OWNER):new Bp(e.name,e.options,t);Jy("Invalid Firebase Database URL",c),bg(c.path)||Ip("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Ev[t.name];i||(i={},Ev[t.name]=i);let s=i[e.toURLString()];return s&&Ip("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rv(e,!1,n,r),i[e.toURLString()]=s,s}(l,e,u,new qp(e.name,n));return new Iv(h,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),qe(cp,lp,void 0),qe(cp,lp,"esm2017");var Nv={apiKey:"AIzaSyCQdQY3D9G60qB3PCBhtCz-W7YynZJQzSU",authDomain:"artistnft.firebaseapp.com",projectId:"artistnft",storageBucket:"artistnft.appspot.com",messagingSenderId:"1090475560828",appId:"1:1090475560828:web:3ff50b4eb39bbcacd45ef9"},xv=new(function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance||(this.app=je(Nv),e.instance=this),e.instance}var t,n;return t=e,(n=[{key:"getAuth",value:function(){return op(this.app)}},{key:"getFirestore",value:function(){return function(e,t){const n="string"==typeof e?e:t||"(default)",r=Le("object"==typeof e?e:Ve(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=T("firestore");e&&function(e,t,n,r={}){var i;const s=(e=Xu(e,Zu))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Is("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=_s.MOCK_USER;else{t=S(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Rs(As.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _s(s)}e._authCredentials=new Ls(new Ds(t,n))}}(r,...e)}return r}(this.app)}},{key:"getDatabase",value:function(){return function(e=Ve(),t){const n=Le(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=T("database");e&&function(e,t,n,r={}){(e=Q(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Ip("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ip('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Hp(Hp.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:S(r.mockUserToken,e.app.options.projectId);s=new Hp(t)}!function(e,t,n,r){e.repoInfo_=new Qp(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}(n,...e)}return n}(this.app)}}])&&kv(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());function Av(e){return Av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Av(e)}function Rv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Av(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Av(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Av(i)?i:String(i)),r)}var i}var Pv=function(){function t(n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.info=n,this.id=r,this.cardBlock=e(".cards"),this.addClass(),this.loaditem()}var n,r;return n=t,(r=[{key:"addClass",value:function(){this.classInfo="one-card_open",this.sizeClass="","premium"===this.info.type&&(this.classInfo="one-card_unlock"),"big"===this.info.size&&(this.sizeClass="one-card_big")}},{key:"loaditem",value:function(){this.cardBlock.append('\n        <div class="one-card '.concat(this.id," ").concat(this.classInfo," ").concat(this.sizeClass,'">\n        <div class="one-card__unlock">\n          <div class="one-card__unlock-main">\n            <div class="one-card__unlock-title">avalaible for premium</div>\n            <div class="one-card__unlock-info">\n              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">\n                <path d="M28.3334 15V11.6667C28.3334 7 24.6667 3.33333 20.0001 3.33333C15.3334 3.33333 11.6667 7 11.6667 11.6667V15C8.83341 15 6.66675 17.1667 6.66675 20V31.6667C6.66675 34.5 8.83341 36.6667 11.6667 36.6667H28.3334C31.1667 36.6667 33.3334 34.5 33.3334 31.6667V20C33.3334 17.1667 31.1667 15 28.3334 15ZM15.0001 11.6667C15.0001 8.83333 17.1667 6.66666 20.0001 6.66666C22.8334 6.66666 25.0001 8.83333 25.0001 11.6667V15H15.0001V11.6667ZM21.8334 25.8333L21.6667 26V28.3333C21.6667 29.3333 21.0001 30 20.0001 30C19.0001 30 18.3334 29.3333 18.3334 28.3333V26C17.3334 25 17.1667 23.5 18.1667 22.5C19.1667 21.5 20.6667 21.3333 21.6667 22.3333C22.6667 23.1667 22.8334 24.8333 21.8334 25.8333Z" fill="#C8D2DC"/>\n              </svg>\n              <span>CONTENT LOCKED</span>\n            </div>\n            <a href="#?id=').concat(this.id,'" class="btn btn_arrow one-card__btn one-card__unlock-btn"><span>Unlock</span></a>\n          </div>\n        </div>\n        <div class="one-card__open ">\n            <div class="one-card__open-main">\n              <div class="one-card__open-title">').concat(this.info.title,'</div>\n              <div class="one-card__open-info">').concat(this.info.info,'</div>\n              <div class="one-card__open-price">$').concat(this.info.price,'</div>\n              <div class="one-card__btn-row">\n                <a href="#?id=').concat(this.id,'" class="btn btn_black one-card__btn one-card__open-btn"><span>Buy</span></a>\n                <a href="#?id=').concat(this.id,'" class="btn btn_arrow one-card__btn one-card__open-btn"><span>View</span></a>\n              </div>\n            </div>\n        </div>\n        <picture class="one-card__bg">\n          <source srcset="').concat(this.info.imageWebP,'" type="image/webp">\n          <img src="').concat(this.info.imagePng,'" alt="">\n        </picture>\n        </div>\n      '))}}])&&Rv(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Dv(e){return Dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dv(e)}function Ov(){Ov=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var s=t&&t.prototype instanceof y?t:y,o=Object.create(s.prototype),a=new A(r||[]);return i(o,"_invoke",{value:S(e,n,a)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function _(){}var w={};l(w,o,(function(){return this}));var b=Object.getPrototypeOf,T=b&&b(b(R([])));T&&T!==n&&r.call(T,o)&&(w=T);var C=_.prototype=y.prototype=Object.create(w);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,s,o,a){var c=h(e[i],e,s);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Dv(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(u).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,a)}))}a(c.arg)}var s;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return s=s?s.then(i,i):i()}})}function S(t,n,r){var i=d;return function(s,o){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===s)throw o;return{value:e,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var l=h(t,n,r);if("normal"===l.type){if(i=r.done?g:f,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=g,r.method="throw",r.arg=l.arg)}}}function k(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var s=h(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function R(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(Dv(t)+" is not iterable")}return v.prototype=_,i(C,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:v,configurable:!0}),v.displayName=l(_,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},E(I.prototype),l(I.prototype,a,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var o=new I(u(e,n,r,i),s);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(C),l(C,c,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function Lv(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function Mv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Dv(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Dv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Dv(i)?i:String(i)),r)}var i}var Fv=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=new l,this.db=xv.getFirestore(),this.prolax(),this.firebase(),this.oneItem()}var n,r,i,s;return n=t,r=[{key:"firebase",value:(i=Ov().mark((function e(){return Ov().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Th(rh(this.db,"arts"));case 2:e.sent.forEach((function(e){new Pv(e.data(),e.id)}));case 4:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var s=i.apply(e,t);function o(e){Lv(s,n,r,o,a,"next",e)}function a(e){Lv(s,n,r,o,a,"throw",e)}o(void 0)}))},function(){return s.apply(this,arguments)})},{key:"oneItem",value:function(){e(".arts__cards").on("click mouseenter",".one-card",(function(t){e(".active").removeClass("active");var n=e(t.currentTarget);n.addClass("active"),n.find(".btn").removeClass("one-card__btn_active"),setTimeout((function(){n.find(".btn").addClass("one-card__btn_active")}),1)})),e(".arts__cards").on("mouseleave",".one-card",(function(){e(".active").removeClass("active")}))}},{key:"prolax",value:function(){e(document).ready((function(){e(".arts").mousemove((function(t){var n=e(this).width(),r=e(this).height(),i=.5-(t.pageX-e(this).offset().left)/n,s=.5-(t.pageY-e(this).offset().top)/r;e(".parallax").css({transform:"translate(-50%,-50%) translate("+40*i+"px,"+40*s+"px)"})}))}))}}],r&&Mv(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();new Fv}()}();